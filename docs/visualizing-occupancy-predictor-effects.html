<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 10 Visualizing Occupancy Predictor Effects | Source code and supplementary material for Using citizen science to parse climatic and landcover influences on bird occupancy within a tropical biodiversity hotspot</title>
  <meta name="description" content="Section 10 Visualizing Occupancy Predictor Effects | Source code and supplementary material for Using citizen science to parse climatic and landcover influences on bird occupancy within a tropical biodiversity hotspot" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 10 Visualizing Occupancy Predictor Effects | Source code and supplementary material for Using citizen science to parse climatic and landcover influences on bird occupancy within a tropical biodiversity hotspot" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="vjjan91/eBirdOccupancy" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 10 Visualizing Occupancy Predictor Effects | Source code and supplementary material for Using citizen science to parse climatic and landcover influences on bird occupancy within a tropical biodiversity hotspot" />
  
  
  



<meta name="date" content="2022-04-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="modelling-species-occupancy.html"/>
<link rel="next" href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#data-processing"><i class="fa fa-check"></i><b>1.1</b> Data processing</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="selecting-species-of-interest.html"><a href="selecting-species-of-interest.html"><i class="fa fa-check"></i><b>2</b> Selecting species of interest</a><ul>
<li class="chapter" data-level="2.1" data-path="selecting-species-of-interest.html"><a href="selecting-species-of-interest.html#prepare-libraries"><i class="fa fa-check"></i><b>2.1</b> Prepare libraries</a></li>
<li class="chapter" data-level="2.2" data-path="selecting-species-of-interest.html"><a href="selecting-species-of-interest.html#subset-species-by-geographical-confines-of-the-study-area"><i class="fa fa-check"></i><b>2.2</b> Subset species by geographical confines of the study area</a></li>
<li class="chapter" data-level="2.3" data-path="selecting-species-of-interest.html"><a href="selecting-species-of-interest.html#subset-an-initial-list-of-terrestrial-birds-based-on-a-minimum-of-1000-detections-between-2013-2021-and-b-remove-species-that-are-often-easily-confused-with-congeners"><i class="fa fa-check"></i><b>2.3</b> Subset an initial list of terrestrial birds based on a) minimum of 1000 detections between 2013-2021 and b) remove species that are often easily confused with congeners</a></li>
<li class="chapter" data-level="2.4" data-path="selecting-species-of-interest.html"><a href="selecting-species-of-interest.html#read-subset-of-species-following-filtering-and-removal-of-waterbirds-raptors-and-other-noctural-species"><i class="fa fa-check"></i><b>2.4</b> Read subset of species following filtering and removal of waterbirds, raptors, and other noctural species</a></li>
<li class="chapter" data-level="2.5" data-path="selecting-species-of-interest.html"><a href="selecting-species-of-interest.html#load-raw-data-for-locations"><i class="fa fa-check"></i><b>2.5</b> Load raw data for locations</a></li>
<li class="chapter" data-level="2.6" data-path="selecting-species-of-interest.html"><a href="selecting-species-of-interest.html#get-proportional-obs-counts-in-25km-cells"><i class="fa fa-check"></i><b>2.6</b> Get proportional obs counts in 25km cells</a></li>
<li class="chapter" data-level="2.7" data-path="selecting-species-of-interest.html"><a href="selecting-species-of-interest.html#which-species-are-reported-sufficiently-in-checklists"><i class="fa fa-check"></i><b>2.7</b> Which species are reported sufficiently in checklists?</a></li>
<li class="chapter" data-level="2.8" data-path="selecting-species-of-interest.html"><a href="selecting-species-of-interest.html#figure-checklist-distribution"><i class="fa fa-check"></i><b>2.8</b> Figure: Checklist distribution</a></li>
<li class="chapter" data-level="2.9" data-path="selecting-species-of-interest.html"><a href="selecting-species-of-interest.html#prepare-the-species-list"><i class="fa fa-check"></i><b>2.9</b> Prepare the species list</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="preparing-ebird-data.html"><a href="preparing-ebird-data.html"><i class="fa fa-check"></i><b>3</b> Preparing eBird Data</a><ul>
<li class="chapter" data-level="3.1" data-path="preparing-ebird-data.html"><a href="preparing-ebird-data.html#prepare-libraries-and-data-sources"><i class="fa fa-check"></i><b>3.1</b> Prepare libraries and data sources</a></li>
<li class="chapter" data-level="3.2" data-path="preparing-ebird-data.html"><a href="preparing-ebird-data.html#filter-data"><i class="fa fa-check"></i><b>3.2</b> Filter data</a></li>
<li class="chapter" data-level="3.3" data-path="preparing-ebird-data.html"><a href="preparing-ebird-data.html#process-filtered-data"><i class="fa fa-check"></i><b>3.3</b> Process filtered data</a></li>
<li class="chapter" data-level="3.4" data-path="preparing-ebird-data.html"><a href="preparing-ebird-data.html#spatial-filter"><i class="fa fa-check"></i><b>3.4</b> Spatial filter</a></li>
<li class="chapter" data-level="3.5" data-path="preparing-ebird-data.html"><a href="preparing-ebird-data.html#handle-presence-data"><i class="fa fa-check"></i><b>3.5</b> Handle presence data</a></li>
<li class="chapter" data-level="3.6" data-path="preparing-ebird-data.html"><a href="preparing-ebird-data.html#add-decimal-time"><i class="fa fa-check"></i><b>3.6</b> Add decimal time</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="preparing-environmental-predictors.html"><a href="preparing-environmental-predictors.html"><i class="fa fa-check"></i><b>4</b> Preparing Environmental Predictors</a><ul>
<li class="chapter" data-level="4.1" data-path="preparing-environmental-predictors.html"><a href="preparing-environmental-predictors.html#prepare-libraries-1"><i class="fa fa-check"></i><b>4.1</b> Prepare libraries</a></li>
<li class="chapter" data-level="4.2" data-path="preparing-environmental-predictors.html"><a href="preparing-environmental-predictors.html#prepare-spatial-extent"><i class="fa fa-check"></i><b>4.2</b> Prepare spatial extent</a></li>
<li class="chapter" data-level="4.3" data-path="preparing-environmental-predictors.html"><a href="preparing-environmental-predictors.html#prepare-terrain-rasters"><i class="fa fa-check"></i><b>4.3</b> Prepare terrain rasters</a></li>
<li class="chapter" data-level="4.4" data-path="preparing-environmental-predictors.html"><a href="preparing-environmental-predictors.html#prepare-chelsa-rasters"><i class="fa fa-check"></i><b>4.4</b> Prepare CHELSA rasters</a><ul>
<li class="chapter" data-level="4.4.1" data-path="preparing-environmental-predictors.html"><a href="preparing-environmental-predictors.html#prepare-bioclim-4a-and-15"><i class="fa fa-check"></i><b>4.4.1</b> Prepare BIOCLIM 4a and 15</a></li>
<li class="chapter" data-level="4.4.2" data-path="preparing-environmental-predictors.html"><a href="preparing-environmental-predictors.html#prepare-bioclim-4a"><i class="fa fa-check"></i><b>4.4.2</b> Prepare BIOCLIM 4a</a></li>
<li class="chapter" data-level="4.4.3" data-path="preparing-environmental-predictors.html"><a href="preparing-environmental-predictors.html#prepare-bioclim-15"><i class="fa fa-check"></i><b>4.4.3</b> Prepare Bioclim 15</a></li>
<li class="chapter" data-level="4.4.4" data-path="preparing-environmental-predictors.html"><a href="preparing-environmental-predictors.html#stack-terrain-and-climate"><i class="fa fa-check"></i><b>4.4.4</b> Stack terrain and climate</a></li>
<li class="chapter" data-level="4.4.5" data-path="preparing-environmental-predictors.html"><a href="preparing-environmental-predictors.html#stack-terrain-and-climate-1"><i class="fa fa-check"></i><b>4.4.5</b> Stack terrain and climate</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="preparing-environmental-predictors.html"><a href="preparing-environmental-predictors.html#resample-landcover-from-10m-to-1km"><i class="fa fa-check"></i><b>4.5</b> Resample landcover from 10m to 1km</a></li>
<li class="chapter" data-level="4.6" data-path="preparing-environmental-predictors.html"><a href="preparing-environmental-predictors.html#resample-other-rasters-to-1km"><i class="fa fa-check"></i><b>4.6</b> Resample other rasters to 1km</a><ul>
<li class="chapter" data-level="4.6.1" data-path="preparing-environmental-predictors.html"><a href="preparing-environmental-predictors.html#read-in-resampled-landcover"><i class="fa fa-check"></i><b>4.6.1</b> Read in resampled landcover</a></li>
<li class="chapter" data-level="4.6.2" data-path="preparing-environmental-predictors.html"><a href="preparing-environmental-predictors.html#reproject-environmental-data-using-landcover-as-a-template"><i class="fa fa-check"></i><b>4.6.2</b> Reproject environmental data using landcover as a template</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="preparing-environmental-predictors.html"><a href="preparing-environmental-predictors.html#climate-variables-in-relation-to-elevation"><i class="fa fa-check"></i><b>4.7</b> Climate variables in relation to elevation</a><ul>
<li class="chapter" data-level="4.7.1" data-path="preparing-environmental-predictors.html"><a href="preparing-environmental-predictors.html#load-resampled-environmental-rasters"><i class="fa fa-check"></i><b>4.7.1</b> Load resampled environmental rasters</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="preparing-environmental-predictors.html"><a href="preparing-environmental-predictors.html#climate-across-land-cover-types"><i class="fa fa-check"></i><b>4.8</b> Climate across land cover types</a></li>
<li class="chapter" data-level="4.9" data-path="preparing-environmental-predictors.html"><a href="preparing-environmental-predictors.html#land-cover-type-in-relation-to-elevation"><i class="fa fa-check"></i><b>4.9</b> Land cover type in relation to elevation</a></li>
<li class="chapter" data-level="4.10" data-path="preparing-environmental-predictors.html"><a href="preparing-environmental-predictors.html#main-text-figure-2"><i class="fa fa-check"></i><b>4.10</b> Main Text Figure 2</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="preparing-checklist-calibration-index.html"><a href="preparing-checklist-calibration-index.html"><i class="fa fa-check"></i><b>5</b> Preparing Checklist Calibration Index</a><ul>
<li class="chapter" data-level="5.1" data-path="preparing-checklist-calibration-index.html"><a href="preparing-checklist-calibration-index.html#prepare-libraries-2"><i class="fa fa-check"></i><b>5.1</b> Prepare libraries</a></li>
<li class="chapter" data-level="5.2" data-path="preparing-checklist-calibration-index.html"><a href="preparing-checklist-calibration-index.html#prepare-data"><i class="fa fa-check"></i><b>5.2</b> Prepare data</a></li>
<li class="chapter" data-level="5.3" data-path="preparing-checklist-calibration-index.html"><a href="preparing-checklist-calibration-index.html#spatially-explicit-filter-on-checklists"><i class="fa fa-check"></i><b>5.3</b> Spatially explicit filter on checklists</a></li>
<li class="chapter" data-level="5.4" data-path="preparing-checklist-calibration-index.html"><a href="preparing-checklist-calibration-index.html#prepare-species-of-interest"><i class="fa fa-check"></i><b>5.4</b> Prepare species of interest</a></li>
<li class="chapter" data-level="5.5" data-path="preparing-checklist-calibration-index.html"><a href="preparing-checklist-calibration-index.html#prepare-checklists-for-observer-score"><i class="fa fa-check"></i><b>5.5</b> Prepare checklists for observer score</a></li>
<li class="chapter" data-level="5.6" data-path="preparing-checklist-calibration-index.html"><a href="preparing-checklist-calibration-index.html#get-landcover"><i class="fa fa-check"></i><b>5.6</b> Get landcover</a></li>
<li class="chapter" data-level="5.7" data-path="preparing-checklist-calibration-index.html"><a href="preparing-checklist-calibration-index.html#filter-checklist-data"><i class="fa fa-check"></i><b>5.7</b> Filter checklist data</a></li>
<li class="chapter" data-level="5.8" data-path="preparing-checklist-calibration-index.html"><a href="preparing-checklist-calibration-index.html#model-observer-expertise"><i class="fa fa-check"></i><b>5.8</b> Model observer expertise</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="examining-spatial-sampling-bias.html"><a href="examining-spatial-sampling-bias.html"><i class="fa fa-check"></i><b>6</b> Examining Spatial Sampling Bias</a><ul>
<li class="chapter" data-level="6.1" data-path="examining-spatial-sampling-bias.html"><a href="examining-spatial-sampling-bias.html#prepare-libraries-3"><i class="fa fa-check"></i><b>6.1</b> Prepare libraries</a></li>
<li class="chapter" data-level="6.2" data-path="examining-spatial-sampling-bias.html"><a href="examining-spatial-sampling-bias.html#read-checklist-data"><i class="fa fa-check"></i><b>6.2</b> Read checklist data</a><ul>
<li class="chapter" data-level="6.2.1" data-path="examining-spatial-sampling-bias.html"><a href="examining-spatial-sampling-bias.html#spatially-explicit-filter-on-checklists-1"><i class="fa fa-check"></i><b>6.2.1</b> Spatially explicit filter on checklists</a></li>
<li class="chapter" data-level="6.2.2" data-path="examining-spatial-sampling-bias.html"><a href="examining-spatial-sampling-bias.html#get-background-land-for-plotting"><i class="fa fa-check"></i><b>6.2.2</b> Get background land for plotting</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="examining-spatial-sampling-bias.html"><a href="examining-spatial-sampling-bias.html#prepare-main-text-figure-3"><i class="fa fa-check"></i><b>6.3</b> Prepare Main Text Figure 3</a><ul>
<li class="chapter" data-level="6.3.1" data-path="examining-spatial-sampling-bias.html"><a href="examining-spatial-sampling-bias.html#prepare-histogram-of-distance-to-roads"><i class="fa fa-check"></i><b>6.3.1</b> Prepare histogram of distance to roads</a></li>
<li class="chapter" data-level="6.3.2" data-path="examining-spatial-sampling-bias.html"><a href="examining-spatial-sampling-bias.html#table-distance-to-roads"><i class="fa fa-check"></i><b>6.3.2</b> Table: Distance to roads</a></li>
<li class="chapter" data-level="6.3.3" data-path="examining-spatial-sampling-bias.html"><a href="examining-spatial-sampling-bias.html#distance-to-nearest-neighbouring-site"><i class="fa fa-check"></i><b>6.3.3</b> Distance to nearest neighbouring site</a></li>
<li class="chapter" data-level="6.3.4" data-path="examining-spatial-sampling-bias.html"><a href="examining-spatial-sampling-bias.html#spatial-distribution-of-distances-to-neighbours"><i class="fa fa-check"></i><b>6.3.4</b> Spatial distribution of distances to neighbours</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="examining-spatial-sampling-bias.html"><a href="examining-spatial-sampling-bias.html#figure-spatial-sampling-bias"><i class="fa fa-check"></i><b>6.4</b> Figure: Spatial sampling bias</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="checking-temporal-sampling-frequency.html"><a href="checking-temporal-sampling-frequency.html"><i class="fa fa-check"></i><b>7</b> Checking Temporal Sampling Frequency</a><ul>
<li class="chapter" data-level="7.1" data-path="checking-temporal-sampling-frequency.html"><a href="checking-temporal-sampling-frequency.html#load-libraries"><i class="fa fa-check"></i><b>7.1</b> Load libraries</a></li>
<li class="chapter" data-level="7.2" data-path="checking-temporal-sampling-frequency.html"><a href="checking-temporal-sampling-frequency.html#load-checklist-data"><i class="fa fa-check"></i><b>7.2</b> Load checklist data</a></li>
<li class="chapter" data-level="7.3" data-path="checking-temporal-sampling-frequency.html"><a href="checking-temporal-sampling-frequency.html#get-time-differences-per-grid-cell"><i class="fa fa-check"></i><b>7.3</b> Get time differences per grid cell</a></li>
<li class="chapter" data-level="7.4" data-path="checking-temporal-sampling-frequency.html"><a href="checking-temporal-sampling-frequency.html#time-since-previous-checklist"><i class="fa fa-check"></i><b>7.4</b> Time Since Previous Checklist</a><ul>
<li class="chapter" data-level="7.4.1" data-path="checking-temporal-sampling-frequency.html"><a href="checking-temporal-sampling-frequency.html#get-aux-data"><i class="fa fa-check"></i><b>7.4.1</b> Get aux data</a></li>
<li class="chapter" data-level="7.4.2" data-path="checking-temporal-sampling-frequency.html"><a href="checking-temporal-sampling-frequency.html#histogram-of-lags"><i class="fa fa-check"></i><b>7.4.2</b> Histogram of lags</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="checking-temporal-sampling-frequency.html"><a href="checking-temporal-sampling-frequency.html#main-text-figure-3"><i class="fa fa-check"></i><b>7.5</b> Main Text Figure 3</a></li>
<li class="chapter" data-level="7.6" data-path="checking-temporal-sampling-frequency.html"><a href="checking-temporal-sampling-frequency.html#checklists-per-month"><i class="fa fa-check"></i><b>7.6</b> Checklists per Month</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="adding-covariates-to-checklist-data.html"><a href="adding-covariates-to-checklist-data.html"><i class="fa fa-check"></i><b>8</b> Adding Covariates to Checklist Data</a><ul>
<li class="chapter" data-level="8.1" data-path="adding-covariates-to-checklist-data.html"><a href="adding-covariates-to-checklist-data.html#prepare-libraries-and-data"><i class="fa fa-check"></i><b>8.1</b> Prepare libraries and data</a></li>
<li class="chapter" data-level="8.2" data-path="adding-covariates-to-checklist-data.html"><a href="adding-covariates-to-checklist-data.html#spatial-subsampling"><i class="fa fa-check"></i><b>8.2</b> Spatial subsampling</a><ul>
<li class="chapter" data-level="8.2.1" data-path="adding-covariates-to-checklist-data.html"><a href="adding-covariates-to-checklist-data.html#counting-presence-observation-proportion"><i class="fa fa-check"></i><b>8.2.1</b> Counting presence observation proportion</a></li>
<li class="chapter" data-level="8.2.2" data-path="adding-covariates-to-checklist-data.html"><a href="adding-covariates-to-checklist-data.html#count-absences-after-spatial-thinning"><i class="fa fa-check"></i><b>8.2.2</b> Count absences after spatial thinning</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="adding-covariates-to-checklist-data.html"><a href="adding-covariates-to-checklist-data.html#temporal-subsampling"><i class="fa fa-check"></i><b>8.3</b> Temporal subsampling</a><ul>
<li class="chapter" data-level="8.3.1" data-path="adding-covariates-to-checklist-data.html"><a href="adding-covariates-to-checklist-data.html#count-absences-after-temporal-thinning"><i class="fa fa-check"></i><b>8.3.1</b> Count absences after temporal thinning</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="adding-covariates-to-checklist-data.html"><a href="adding-covariates-to-checklist-data.html#add-checklist-calibration-index"><i class="fa fa-check"></i><b>8.4</b> Add checklist calibration index</a></li>
<li class="chapter" data-level="8.5" data-path="adding-covariates-to-checklist-data.html"><a href="adding-covariates-to-checklist-data.html#add-climatic-and-landscape-covariates"><i class="fa fa-check"></i><b>8.5</b> Add climatic and landscape covariates</a></li>
<li class="chapter" data-level="8.6" data-path="adding-covariates-to-checklist-data.html"><a href="adding-covariates-to-checklist-data.html#spatial-buffers-around-selected-checklists"><i class="fa fa-check"></i><b>8.6</b> Spatial buffers around selected checklists</a></li>
<li class="chapter" data-level="8.7" data-path="adding-covariates-to-checklist-data.html"><a href="adding-covariates-to-checklist-data.html#spatial-buffer-wide-covariates"><i class="fa fa-check"></i><b>8.7</b> Spatial buffer-wide covariates</a><ul>
<li class="chapter" data-level="8.7.1" data-path="adding-covariates-to-checklist-data.html"><a href="adding-covariates-to-checklist-data.html#mean-climatic-covariates"><i class="fa fa-check"></i><b>8.7.1</b> Mean climatic covariates</a></li>
<li class="chapter" data-level="8.7.2" data-path="adding-covariates-to-checklist-data.html"><a href="adding-covariates-to-checklist-data.html#proportions-of-land-cover-type"><i class="fa fa-check"></i><b>8.7.2</b> Proportions of land cover type</a></li>
<li class="chapter" data-level="8.7.3" data-path="adding-covariates-to-checklist-data.html"><a href="adding-covariates-to-checklist-data.html#link-environmental-covariates-to-checklists"><i class="fa fa-check"></i><b>8.7.3</b> Link environmental covariates to checklists</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="modelling-species-occupancy.html"><a href="modelling-species-occupancy.html"><i class="fa fa-check"></i><b>9</b> Modelling Species Occupancy</a><ul>
<li class="chapter" data-level="9.0.1" data-path="modelling-species-occupancy.html"><a href="modelling-species-occupancy.html#load-necessary-libraries"><i class="fa fa-check"></i><b>9.0.1</b> Load necessary libraries</a></li>
<li class="chapter" data-level="9.1" data-path="modelling-species-occupancy.html"><a href="modelling-species-occupancy.html#load-dataframe-and-prepare-covariates"><i class="fa fa-check"></i><b>9.1</b> Load dataframe and prepare covariates</a><ul>
<li class="chapter" data-level="9.1.1" data-path="modelling-species-occupancy.html"><a href="modelling-species-occupancy.html#handle-the-sampling-protocol"><i class="fa fa-check"></i><b>9.1.1</b> Handle the sampling protocol</a></li>
<li class="chapter" data-level="9.1.2" data-path="modelling-species-occupancy.html"><a href="modelling-species-occupancy.html#handle-time-and-date"><i class="fa fa-check"></i><b>9.1.2</b> Handle time and date</a></li>
<li class="chapter" data-level="9.1.3" data-path="modelling-species-occupancy.html"><a href="modelling-species-occupancy.html#scaling-covariates"><i class="fa fa-check"></i><b>9.1.3</b> Scaling covariates</a></li>
<li class="chapter" data-level="9.1.4" data-path="modelling-species-occupancy.html"><a href="modelling-species-occupancy.html#correct-date-format"><i class="fa fa-check"></i><b>9.1.4</b> Correct date format</a></li>
<li class="chapter" data-level="9.1.5" data-path="modelling-species-occupancy.html"><a href="modelling-species-occupancy.html#check-for-correlated-covariates"><i class="fa fa-check"></i><b>9.1.5</b> Check for correlated covariates</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="modelling-species-occupancy.html"><a href="modelling-species-occupancy.html#running-a-null-model"><i class="fa fa-check"></i><b>9.2</b> Running a null model</a></li>
<li class="chapter" data-level="9.3" data-path="modelling-species-occupancy.html"><a href="modelling-species-occupancy.html#identifying-covariates-necessary-to-model-the-detection-process"><i class="fa fa-check"></i><b>9.3</b> Identifying covariates necessary to model the detection process</a></li>
<li class="chapter" data-level="9.4" data-path="modelling-species-occupancy.html"><a href="modelling-species-occupancy.html#land-cover-and-climate"><i class="fa fa-check"></i><b>9.4</b> Land Cover and Climate</a></li>
<li class="chapter" data-level="9.5" data-path="modelling-species-occupancy.html"><a href="modelling-species-occupancy.html#goodness-of-fit-tests"><i class="fa fa-check"></i><b>9.5</b> Goodness-of-fit tests</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="visualizing-occupancy-predictor-effects.html"><a href="visualizing-occupancy-predictor-effects.html"><i class="fa fa-check"></i><b>10</b> Visualizing Occupancy Predictor Effects</a><ul>
<li class="chapter" data-level="10.1" data-path="visualizing-occupancy-predictor-effects.html"><a href="visualizing-occupancy-predictor-effects.html#prepare-libraries-4"><i class="fa fa-check"></i><b>10.1</b> Prepare libraries</a></li>
<li class="chapter" data-level="10.2" data-path="visualizing-occupancy-predictor-effects.html"><a href="visualizing-occupancy-predictor-effects.html#load-species-list"><i class="fa fa-check"></i><b>10.2</b> Load species list</a></li>
<li class="chapter" data-level="10.3" data-path="visualizing-occupancy-predictor-effects.html"><a href="visualizing-occupancy-predictor-effects.html#show-aic-weight-importance"><i class="fa fa-check"></i><b>10.3</b> Show AIC weight importance</a><ul>
<li class="chapter" data-level="10.3.1" data-path="visualizing-occupancy-predictor-effects.html"><a href="visualizing-occupancy-predictor-effects.html#read-in-aic-weight-data"><i class="fa fa-check"></i><b>10.3.1</b> Read in AIC weight data</a></li>
<li class="chapter" data-level="10.3.2" data-path="visualizing-occupancy-predictor-effects.html"><a href="visualizing-occupancy-predictor-effects.html#prepare-cumulative-aic-weight-data"><i class="fa fa-check"></i><b>10.3.2</b> Prepare cumulative AIC weight data</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="visualizing-occupancy-predictor-effects.html"><a href="visualizing-occupancy-predictor-effects.html#prepare-model-coefficient-data"><i class="fa fa-check"></i><b>10.4</b> Prepare model coefficient data</a></li>
<li class="chapter" data-level="10.5" data-path="visualizing-occupancy-predictor-effects.html"><a href="visualizing-occupancy-predictor-effects.html#get-predictor-effects"><i class="fa fa-check"></i><b>10.5</b> Get predictor effects</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html"><i class="fa fa-check"></i><b>11</b> Predicting species-specific occupancy as a function of significant predictors</a><ul>
<li class="chapter" data-level="11.1" data-path="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#prepare-libraries-5"><i class="fa fa-check"></i><b>11.1</b> Prepare libraries</a></li>
<li class="chapter" data-level="11.2" data-path="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#read-data"><i class="fa fa-check"></i><b>11.2</b> Read data</a></li>
<li class="chapter" data-level="11.3" data-path="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#prepare-predictor-data"><i class="fa fa-check"></i><b>11.3</b> Prepare predictor data</a></li>
<li class="chapter" data-level="11.4" data-path="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#get-predictor-responses"><i class="fa fa-check"></i><b>11.4</b> Get predictor responses</a></li>
<li class="chapter" data-level="11.5" data-path="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#get-probability-of-occupancy"><i class="fa fa-check"></i><b>11.5</b> Get probability of occupancy</a></li>
<li class="chapter" data-level="11.6" data-path="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#add-scaling-for-predictors"><i class="fa fa-check"></i><b>11.6</b> Add scaling for predictors</a><ul>
<li class="chapter" data-level="11.6.1" data-path="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#figure-occupancy-predictors"><i class="fa fa-check"></i><b>11.6.1</b> Figure: Occupancy ~ predictors</a></li>
<li class="chapter" data-level="11.6.2" data-path="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#figures-occupancy-predictors-for-all-species"><i class="fa fa-check"></i><b>11.6.2</b> Figures: Occupancy ~ predictors for all species</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#mapping-species-occupancy"><i class="fa fa-check"></i><b>11.7</b> Mapping species occupancy</a><ul>
<li class="chapter" data-level="11.7.1" data-path="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#read-in-raster-layers"><i class="fa fa-check"></i><b>11.7.1</b> Read in raster layers</a></li>
<li class="chapter" data-level="11.7.2" data-path="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#split-landcover-into-proportions-per-1km"><i class="fa fa-check"></i><b>11.7.2</b> Split landcover into proportions per 1km</a></li>
<li class="chapter" data-level="11.7.3" data-path="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#prepare-climatic-layers"><i class="fa fa-check"></i><b>11.7.3</b> Prepare climatic layers</a></li>
<li class="chapter" data-level="11.7.4" data-path="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#mask-by-study-area"><i class="fa fa-check"></i><b>11.7.4</b> Mask by study area</a></li>
<li class="chapter" data-level="11.7.5" data-path="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#plot-full-bounds-of-landscape-variables"><i class="fa fa-check"></i><b>11.7.5</b> Plot full bounds of landscape variables</a></li>
<li class="chapter" data-level="11.7.6" data-path="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#prepare-soi-predictors"><i class="fa fa-check"></i><b>11.7.6</b> Prepare soi predictors</a></li>
<li class="chapter" data-level="11.7.7" data-path="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#prepare-species-occupancy-for-soi"><i class="fa fa-check"></i><b>11.7.7</b> Prepare species occupancy for SOI</a></li>
<li class="chapter" data-level="11.7.8" data-path="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#prepare-species-occupancy-for-all-species"><i class="fa fa-check"></i><b>11.7.8</b> Prepare species occupancy for all species</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>12</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Source code and supplementary material for <em>Using citizen science to parse climatic and landcover influences on bird occupancy within a tropical biodiversity hotspot</em></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="visualizing-occupancy-predictor-effects" class="section level1">
<h1><span class="header-section-number">Section 10</span> Visualizing Occupancy Predictor Effects</h1>
<p>In this section, we will visualize the magnitude and direction of species-specific probability of occupancy.</p>
<div id="prepare-libraries-4" class="section level2">
<h2><span class="header-section-number">10.1</span> Prepare libraries</h2>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="visualizing-occupancy-predictor-effects.html#cb95-1"></a><span class="co"># to load data</span></span>
<span id="cb95-2"><a href="visualizing-occupancy-predictor-effects.html#cb95-2"></a><span class="kw">library</span>(readxl)</span>
<span id="cb95-3"><a href="visualizing-occupancy-predictor-effects.html#cb95-3"></a></span>
<span id="cb95-4"><a href="visualizing-occupancy-predictor-effects.html#cb95-4"></a><span class="co"># to handle data</span></span>
<span id="cb95-5"><a href="visualizing-occupancy-predictor-effects.html#cb95-5"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb95-6"><a href="visualizing-occupancy-predictor-effects.html#cb95-6"></a><span class="kw">library</span>(readr)</span>
<span id="cb95-7"><a href="visualizing-occupancy-predictor-effects.html#cb95-7"></a><span class="kw">library</span>(forcats)</span>
<span id="cb95-8"><a href="visualizing-occupancy-predictor-effects.html#cb95-8"></a><span class="kw">library</span>(tidyr)</span>
<span id="cb95-9"><a href="visualizing-occupancy-predictor-effects.html#cb95-9"></a><span class="kw">library</span>(purrr)</span>
<span id="cb95-10"><a href="visualizing-occupancy-predictor-effects.html#cb95-10"></a><span class="kw">library</span>(stringr)</span>
<span id="cb95-11"><a href="visualizing-occupancy-predictor-effects.html#cb95-11"></a><span class="co"># library(data.table)</span></span>
<span id="cb95-12"><a href="visualizing-occupancy-predictor-effects.html#cb95-12"></a></span>
<span id="cb95-13"><a href="visualizing-occupancy-predictor-effects.html#cb95-13"></a><span class="co"># to wrangle models</span></span>
<span id="cb95-14"><a href="visualizing-occupancy-predictor-effects.html#cb95-14"></a><span class="kw">source</span>(<span class="st">&quot;R/fun_model_estimate_collection.r&quot;</span>)</span>
<span id="cb95-15"><a href="visualizing-occupancy-predictor-effects.html#cb95-15"></a><span class="kw">source</span>(<span class="st">&quot;R/fun_make_resp_data.r&quot;</span>)</span>
<span id="cb95-16"><a href="visualizing-occupancy-predictor-effects.html#cb95-16"></a></span>
<span id="cb95-17"><a href="visualizing-occupancy-predictor-effects.html#cb95-17"></a><span class="co"># nice tables</span></span>
<span id="cb95-18"><a href="visualizing-occupancy-predictor-effects.html#cb95-18"></a><span class="kw">library</span>(knitr)</span>
<span id="cb95-19"><a href="visualizing-occupancy-predictor-effects.html#cb95-19"></a><span class="kw">library</span>(kableExtra)</span>
<span id="cb95-20"><a href="visualizing-occupancy-predictor-effects.html#cb95-20"></a></span>
<span id="cb95-21"><a href="visualizing-occupancy-predictor-effects.html#cb95-21"></a><span class="co"># plotting</span></span>
<span id="cb95-22"><a href="visualizing-occupancy-predictor-effects.html#cb95-22"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb95-23"><a href="visualizing-occupancy-predictor-effects.html#cb95-23"></a><span class="kw">library</span>(patchwork)</span>
<span id="cb95-24"><a href="visualizing-occupancy-predictor-effects.html#cb95-24"></a><span class="kw">source</span>(<span class="st">&quot;R/fun_plot_interaction.r&quot;</span>)</span></code></pre></div>
</div>
<div id="load-species-list" class="section level2">
<h2><span class="header-section-number">10.2</span> Load species list</h2>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="visualizing-occupancy-predictor-effects.html#cb96-1"></a><span class="co"># list of species</span></span>
<span id="cb96-2"><a href="visualizing-occupancy-predictor-effects.html#cb96-2"></a><span class="co"># Removing species after running a chi-square goodness of fit test</span></span>
<span id="cb96-3"><a href="visualizing-occupancy-predictor-effects.html#cb96-3"></a>species &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/species_list.csv&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb96-4"><a href="visualizing-occupancy-predictor-effects.html#cb96-4"></a><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span>scientific_name <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(</span>
<span id="cb96-5"><a href="visualizing-occupancy-predictor-effects.html#cb96-5"></a>      <span class="st">&quot;Treron affinis&quot;</span>, <span class="st">&quot;Prinia hodgsonii&quot;</span>, <span class="st">&quot;Pellorneum ruficeps&quot;</span>,</span>
<span id="cb96-6"><a href="visualizing-occupancy-predictor-effects.html#cb96-6"></a>      <span class="st">&quot;Hypothymis azurea&quot;</span>,<span class="st">&quot;Dendrocitta leucogastra&quot;</span>,<span class="st">&quot;Chalcophaps indica&quot;</span>,</span>
<span id="cb96-7"><a href="visualizing-occupancy-predictor-effects.html#cb96-7"></a>      <span class="st">&quot;Rubigula gularis&quot;</span>,  <span class="st">&quot;Muscicapa dauurica&quot;</span>, <span class="st">&quot;Geokichla citrina&quot;</span>, </span>
<span id="cb96-8"><a href="visualizing-occupancy-predictor-effects.html#cb96-8"></a>      <span class="st">&quot;Chrysocolaptes guttacristatus&quot;</span>,<span class="st">&quot;Terpsiphone paradisi&quot;</span>,<span class="st">&quot;Orthotomus sutorius&quot;</span>,</span>
<span id="cb96-9"><a href="visualizing-occupancy-predictor-effects.html#cb96-9"></a>      <span class="st">&quot;Oriolus kundoo&quot;</span>, <span class="st">&quot;Dicrurus aeneus&quot;</span>, <span class="st">&quot;Cyornis tickelliae&quot;</span>,</span>
<span id="cb96-10"><a href="visualizing-occupancy-predictor-effects.html#cb96-10"></a>      <span class="st">&quot;Copsychus fulicatus&quot;</span>, <span class="st">&quot;Oriolus xanthornus&quot;</span>, <span class="st">&quot;Alcippe poioicephala&quot;</span>,</span>
<span id="cb96-11"><a href="visualizing-occupancy-predictor-effects.html#cb96-11"></a>      <span class="st">&quot;Ficedula nigrorufa&quot;</span>,<span class="st">&quot;Dendrocitta vagabunda&quot;</span>, <span class="st">&quot;Dicrurus paradiseus&quot;</span>,</span>
<span id="cb96-12"><a href="visualizing-occupancy-predictor-effects.html#cb96-12"></a>      <span class="st">&quot;Ocyceros griseus&quot;</span>, <span class="st">&quot;Psilopogon viridis&quot;</span>, <span class="st">&quot;Psittacula cyanocephala&quot;</span>))</span>
<span id="cb96-13"><a href="visualizing-occupancy-predictor-effects.html#cb96-13"></a></span>
<span id="cb96-14"><a href="visualizing-occupancy-predictor-effects.html#cb96-14"></a>list_of_species &lt;-<span class="st"> </span><span class="kw">as.character</span>(species<span class="op">$</span>scientific_name)</span></code></pre></div>
</div>
<div id="show-aic-weight-importance" class="section level2">
<h2><span class="header-section-number">10.3</span> Show AIC weight importance</h2>
<p>To get cumulative AIC weights, we first obtained a measure of relative importance of climatic and landscape predictors by calculating cumulative variable importance scores. These scores were calculated by obtaining the sum of model weights (AIC weights) across all models (including the top models) for each predictor across all species. We then calculated the mean cumulative variable importance score and a standard deviation for each predictor.</p>
<div id="read-in-aic-weight-data" class="section level3">
<h3><span class="header-section-number">10.3.1</span> Read in AIC weight data</h3>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="visualizing-occupancy-predictor-effects.html#cb97-1"></a><span class="co"># which files to read</span></span>
<span id="cb97-2"><a href="visualizing-occupancy-predictor-effects.html#cb97-2"></a>file_names &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;results/09_lc-clim-imp.xlsx&quot;</span>)</span>
<span id="cb97-3"><a href="visualizing-occupancy-predictor-effects.html#cb97-3"></a></span>
<span id="cb97-4"><a href="visualizing-occupancy-predictor-effects.html#cb97-4"></a><span class="co"># read in sheets by species</span></span>
<span id="cb97-5"><a href="visualizing-occupancy-predictor-effects.html#cb97-5"></a>model_imp &lt;-<span class="st"> </span><span class="kw">map</span>(file_names, <span class="cf">function</span>(f) {</span>
<span id="cb97-6"><a href="visualizing-occupancy-predictor-effects.html#cb97-6"></a>  md_list &lt;-<span class="st"> </span><span class="kw">map</span>(list_of_species, <span class="cf">function</span>(sn) {</span>
<span id="cb97-7"><a href="visualizing-occupancy-predictor-effects.html#cb97-7"></a></span>
<span id="cb97-8"><a href="visualizing-occupancy-predictor-effects.html#cb97-8"></a>    <span class="co"># some sheets are not found</span></span>
<span id="cb97-9"><a href="visualizing-occupancy-predictor-effects.html#cb97-9"></a></span>
<span id="cb97-10"><a href="visualizing-occupancy-predictor-effects.html#cb97-10"></a>    <span class="kw">tryCatch</span>(</span>
<span id="cb97-11"><a href="visualizing-occupancy-predictor-effects.html#cb97-11"></a>      {</span>
<span id="cb97-12"><a href="visualizing-occupancy-predictor-effects.html#cb97-12"></a>        readxl<span class="op">::</span><span class="kw">read_excel</span>(f, <span class="dt">sheet =</span> sn) <span class="op">%&gt;%</span></span>
<span id="cb97-13"><a href="visualizing-occupancy-predictor-effects.html#cb97-13"></a><span class="st">          `</span><span class="dt">colnames&lt;-</span><span class="st">`</span>(<span class="kw">c</span>(<span class="st">&quot;predictor&quot;</span>, <span class="st">&quot;AIC_weight&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb97-14"><a href="visualizing-occupancy-predictor-effects.html#cb97-14"></a><span class="st">          </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(predictor, <span class="st">&quot;psi&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb97-15"><a href="visualizing-occupancy-predictor-effects.html#cb97-15"></a><span class="st">          </span><span class="kw">mutate</span>(</span>
<span id="cb97-16"><a href="visualizing-occupancy-predictor-effects.html#cb97-16"></a>            <span class="dt">predictor =</span> stringr<span class="op">::</span><span class="kw">str_extract</span>(predictor,</span>
<span id="cb97-17"><a href="visualizing-occupancy-predictor-effects.html#cb97-17"></a>              <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">regex</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">((.*?)</span><span class="ch">\\</span><span class="st">)&quot;</span>)</span>
<span id="cb97-18"><a href="visualizing-occupancy-predictor-effects.html#cb97-18"></a>            ),</span>
<span id="cb97-19"><a href="visualizing-occupancy-predictor-effects.html#cb97-19"></a>            <span class="dt">predictor =</span> stringr<span class="op">::</span><span class="kw">str_replace_all</span>(predictor, <span class="st">&quot;[//(//)]&quot;</span>, <span class="st">&quot;&quot;</span>),</span>
<span id="cb97-20"><a href="visualizing-occupancy-predictor-effects.html#cb97-20"></a>            <span class="dt">predictor =</span> stringr<span class="op">::</span><span class="kw">str_remove</span>(predictor, <span class="st">&quot;</span><span class="ch">\\</span><span class="st">.y&quot;</span>)</span>
<span id="cb97-21"><a href="visualizing-occupancy-predictor-effects.html#cb97-21"></a>          )</span>
<span id="cb97-22"><a href="visualizing-occupancy-predictor-effects.html#cb97-22"></a>      },</span>
<span id="cb97-23"><a href="visualizing-occupancy-predictor-effects.html#cb97-23"></a>      <span class="dt">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb97-24"><a href="visualizing-occupancy-predictor-effects.html#cb97-24"></a>        <span class="kw">message</span>(<span class="kw">as.character</span>(e))</span>
<span id="cb97-25"><a href="visualizing-occupancy-predictor-effects.html#cb97-25"></a>      }</span>
<span id="cb97-26"><a href="visualizing-occupancy-predictor-effects.html#cb97-26"></a>    )</span>
<span id="cb97-27"><a href="visualizing-occupancy-predictor-effects.html#cb97-27"></a>  })</span>
<span id="cb97-28"><a href="visualizing-occupancy-predictor-effects.html#cb97-28"></a>  <span class="kw">names</span>(md_list) &lt;-<span class="st"> </span>list_of_species</span>
<span id="cb97-29"><a href="visualizing-occupancy-predictor-effects.html#cb97-29"></a></span>
<span id="cb97-30"><a href="visualizing-occupancy-predictor-effects.html#cb97-30"></a>  <span class="kw">return</span>(md_list)</span>
<span id="cb97-31"><a href="visualizing-occupancy-predictor-effects.html#cb97-31"></a>})</span></code></pre></div>
</div>
<div id="prepare-cumulative-aic-weight-data" class="section level3">
<h3><span class="header-section-number">10.3.2</span> Prepare cumulative AIC weight data</h3>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="visualizing-occupancy-predictor-effects.html#cb98-1"></a><span class="co"># bind rows</span></span>
<span id="cb98-2"><a href="visualizing-occupancy-predictor-effects.html#cb98-2"></a>model_imp &lt;-<span class="st"> </span><span class="kw">map</span>(model_imp, bind_rows) <span class="op">%&gt;%</span></span>
<span id="cb98-3"><a href="visualizing-occupancy-predictor-effects.html#cb98-3"></a><span class="st">  </span><span class="kw">bind_rows</span>() </span>
<span id="cb98-4"><a href="visualizing-occupancy-predictor-effects.html#cb98-4"></a></span>
<span id="cb98-5"><a href="visualizing-occupancy-predictor-effects.html#cb98-5"></a><span class="co"># convert to numeric</span></span>
<span id="cb98-6"><a href="visualizing-occupancy-predictor-effects.html#cb98-6"></a>model_imp<span class="op">$</span>AIC_weight &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(model_imp<span class="op">$</span>AIC_weight)</span>
<span id="cb98-7"><a href="visualizing-occupancy-predictor-effects.html#cb98-7"></a></span>
<span id="cb98-8"><a href="visualizing-occupancy-predictor-effects.html#cb98-8"></a><span class="co"># Let&#39;s get a summary of cumulative variable importance</span></span>
<span id="cb98-9"><a href="visualizing-occupancy-predictor-effects.html#cb98-9"></a>model_imp &lt;-<span class="st"> </span><span class="kw">group_by</span>(model_imp, predictor) <span class="op">%&gt;%</span></span>
<span id="cb98-10"><a href="visualizing-occupancy-predictor-effects.html#cb98-10"></a><span class="st">  </span><span class="kw">summarise</span>(</span>
<span id="cb98-11"><a href="visualizing-occupancy-predictor-effects.html#cb98-11"></a>    <span class="dt">mean_AIC =</span> <span class="kw">mean</span>(AIC_weight),</span>
<span id="cb98-12"><a href="visualizing-occupancy-predictor-effects.html#cb98-12"></a>    <span class="dt">sd_AIC =</span> <span class="kw">sd</span>(AIC_weight),</span>
<span id="cb98-13"><a href="visualizing-occupancy-predictor-effects.html#cb98-13"></a>    <span class="dt">min_AIC =</span> <span class="kw">min</span>(AIC_weight),</span>
<span id="cb98-14"><a href="visualizing-occupancy-predictor-effects.html#cb98-14"></a>    <span class="dt">max_AIC =</span> <span class="kw">max</span>(AIC_weight),</span>
<span id="cb98-15"><a href="visualizing-occupancy-predictor-effects.html#cb98-15"></a>    <span class="dt">med_AIC =</span> <span class="kw">median</span>(AIC_weight)</span>
<span id="cb98-16"><a href="visualizing-occupancy-predictor-effects.html#cb98-16"></a>  )</span>
<span id="cb98-17"><a href="visualizing-occupancy-predictor-effects.html#cb98-17"></a></span>
<span id="cb98-18"><a href="visualizing-occupancy-predictor-effects.html#cb98-18"></a><span class="co"># write to file</span></span>
<span id="cb98-19"><a href="visualizing-occupancy-predictor-effects.html#cb98-19"></a><span class="kw">write_csv</span>(model_imp, <span class="st">&quot;results/10_cumulative-AIC-weights.csv&quot;</span>)</span></code></pre></div>
<p>Read data back in.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="visualizing-occupancy-predictor-effects.html#cb99-1"></a><span class="co"># read data and make factor</span></span>
<span id="cb99-2"><a href="visualizing-occupancy-predictor-effects.html#cb99-2"></a>model_imp &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;results/10_cumulative-AIC-weights.csv&quot;</span>)</span>
<span id="cb99-3"><a href="visualizing-occupancy-predictor-effects.html#cb99-3"></a>model_imp<span class="op">$</span>predictor &lt;-<span class="st"> </span><span class="kw">as_factor</span>(model_imp<span class="op">$</span>predictor)</span></code></pre></div>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="visualizing-occupancy-predictor-effects.html#cb100-1"></a><span class="co"># make nice names</span></span>
<span id="cb100-2"><a href="visualizing-occupancy-predictor-effects.html#cb100-2"></a>predictor_name &lt;-<span class="st"> </span><span class="kw">tibble</span>(</span>
<span id="cb100-3"><a href="visualizing-occupancy-predictor-effects.html#cb100-3"></a>  <span class="dt">predictor =</span> <span class="kw">levels</span>(model_imp<span class="op">$</span>predictor),</span>
<span id="cb100-4"><a href="visualizing-occupancy-predictor-effects.html#cb100-4"></a>  <span class="dt">pred_name =</span> <span class="kw">c</span>(</span>
<span id="cb100-5"><a href="visualizing-occupancy-predictor-effects.html#cb100-5"></a>    <span class="st">&quot;Precipitation seasonality&quot;</span>,</span>
<span id="cb100-6"><a href="visualizing-occupancy-predictor-effects.html#cb100-6"></a>    <span class="st">&quot;Temperature seasonality&quot;</span>,</span>
<span id="cb100-7"><a href="visualizing-occupancy-predictor-effects.html#cb100-7"></a>    <span class="st">&quot;% Evergreen Forest&quot;</span>, <span class="st">&quot;% Deciduous Forest&quot;</span>,</span>
<span id="cb100-8"><a href="visualizing-occupancy-predictor-effects.html#cb100-8"></a>    <span class="st">&quot;% Mixed/Degraded Forest&quot;</span>, <span class="st">&quot;% Agriculture/Settlements&quot;</span>,</span>
<span id="cb100-9"><a href="visualizing-occupancy-predictor-effects.html#cb100-9"></a>    <span class="st">&quot;% Grassland&quot;</span>, <span class="st">&quot;% Plantations&quot;</span>, <span class="st">&quot;% Water Bodies&quot;</span></span>
<span id="cb100-10"><a href="visualizing-occupancy-predictor-effects.html#cb100-10"></a>  )</span>
<span id="cb100-11"><a href="visualizing-occupancy-predictor-effects.html#cb100-11"></a>)</span>
<span id="cb100-12"><a href="visualizing-occupancy-predictor-effects.html#cb100-12"></a></span>
<span id="cb100-13"><a href="visualizing-occupancy-predictor-effects.html#cb100-13"></a><span class="co"># rename predictor</span></span>
<span id="cb100-14"><a href="visualizing-occupancy-predictor-effects.html#cb100-14"></a>model_imp &lt;-<span class="st"> </span><span class="kw">left_join</span>(model_imp, predictor_name)</span></code></pre></div>
<p>Prepare figure for cumulative AIC weight. Figure code is hidden in versions rendered as HTML and PDF.</p>
</div>
</div>
<div id="prepare-model-coefficient-data" class="section level2">
<h2><span class="header-section-number">10.4</span> Prepare model coefficient data</h2>
<p>For each species, we examined those models which had AICc &lt; 4, as these top models were considered to explain a large proportion of the association between the species-specific probability of occupancy and environmental drivers. Using these restricted model sets for each species; we created a model-averaged coefficient estimate for each predictor and assessed its direction and significance. We considered a predictor to be significantly associated with occupancy if the range of the 95% confidence interval around the model-averaged coefficient did not contain zero.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="visualizing-occupancy-predictor-effects.html#cb101-1"></a>file_read &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;results/09_lc-clim-modelEst.xlsx&quot;</span>)</span>
<span id="cb101-2"><a href="visualizing-occupancy-predictor-effects.html#cb101-2"></a></span>
<span id="cb101-3"><a href="visualizing-occupancy-predictor-effects.html#cb101-3"></a><span class="co"># read data as list column</span></span>
<span id="cb101-4"><a href="visualizing-occupancy-predictor-effects.html#cb101-4"></a>model_est &lt;-<span class="st"> </span><span class="kw">map</span>(list_of_species, <span class="cf">function</span>(sn) {</span>
<span id="cb101-5"><a href="visualizing-occupancy-predictor-effects.html#cb101-5"></a>  <span class="kw">tryCatch</span>(</span>
<span id="cb101-6"><a href="visualizing-occupancy-predictor-effects.html#cb101-6"></a>    {</span>
<span id="cb101-7"><a href="visualizing-occupancy-predictor-effects.html#cb101-7"></a>      readxl<span class="op">::</span><span class="kw">read_excel</span>(file_read, <span class="dt">sheet =</span> sn) <span class="op">%&gt;%</span></span>
<span id="cb101-8"><a href="visualizing-occupancy-predictor-effects.html#cb101-8"></a><span class="st">        </span><span class="kw">rename</span>(<span class="dt">predictor =</span> <span class="st">&quot;...1&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb101-9"><a href="visualizing-occupancy-predictor-effects.html#cb101-9"></a><span class="st">        </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(predictor, <span class="st">&quot;psi&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb101-10"><a href="visualizing-occupancy-predictor-effects.html#cb101-10"></a><span class="st">        </span><span class="kw">mutate</span>(</span>
<span id="cb101-11"><a href="visualizing-occupancy-predictor-effects.html#cb101-11"></a>          <span class="dt">predictor =</span> stringr<span class="op">::</span><span class="kw">str_extract</span>(predictor,</span>
<span id="cb101-12"><a href="visualizing-occupancy-predictor-effects.html#cb101-12"></a>            <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">regex</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">((.*?)</span><span class="ch">\\</span><span class="st">)&quot;</span>)</span>
<span id="cb101-13"><a href="visualizing-occupancy-predictor-effects.html#cb101-13"></a>          ),</span>
<span id="cb101-14"><a href="visualizing-occupancy-predictor-effects.html#cb101-14"></a>          <span class="dt">predictor =</span> stringr<span class="op">::</span><span class="kw">str_replace_all</span>(predictor, <span class="st">&quot;[//(//)]&quot;</span>, <span class="st">&quot;&quot;</span>),</span>
<span id="cb101-15"><a href="visualizing-occupancy-predictor-effects.html#cb101-15"></a>          <span class="dt">predictor =</span> stringr<span class="op">::</span><span class="kw">str_remove</span>(predictor, <span class="st">&quot;</span><span class="ch">\\</span><span class="st">.y&quot;</span>)</span>
<span id="cb101-16"><a href="visualizing-occupancy-predictor-effects.html#cb101-16"></a>        )</span>
<span id="cb101-17"><a href="visualizing-occupancy-predictor-effects.html#cb101-17"></a>    },</span>
<span id="cb101-18"><a href="visualizing-occupancy-predictor-effects.html#cb101-18"></a>    <span class="dt">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb101-19"><a href="visualizing-occupancy-predictor-effects.html#cb101-19"></a>      <span class="kw">message</span>(<span class="kw">as.character</span>(e))</span>
<span id="cb101-20"><a href="visualizing-occupancy-predictor-effects.html#cb101-20"></a>    }</span>
<span id="cb101-21"><a href="visualizing-occupancy-predictor-effects.html#cb101-21"></a>  )</span>
<span id="cb101-22"><a href="visualizing-occupancy-predictor-effects.html#cb101-22"></a>})</span>
<span id="cb101-23"><a href="visualizing-occupancy-predictor-effects.html#cb101-23"></a><span class="co"># assign names</span></span>
<span id="cb101-24"><a href="visualizing-occupancy-predictor-effects.html#cb101-24"></a><span class="kw">names</span>(model_est) &lt;-<span class="st"> </span>list_of_species</span>
<span id="cb101-25"><a href="visualizing-occupancy-predictor-effects.html#cb101-25"></a></span>
<span id="cb101-26"><a href="visualizing-occupancy-predictor-effects.html#cb101-26"></a><span class="co"># prepare model data</span></span>
<span id="cb101-27"><a href="visualizing-occupancy-predictor-effects.html#cb101-27"></a>model_data &lt;-<span class="st"> </span><span class="kw">tibble</span>(</span>
<span id="cb101-28"><a href="visualizing-occupancy-predictor-effects.html#cb101-28"></a>  <span class="dt">scientific_name =</span> list_of_species</span>
<span id="cb101-29"><a href="visualizing-occupancy-predictor-effects.html#cb101-29"></a>)</span>
<span id="cb101-30"><a href="visualizing-occupancy-predictor-effects.html#cb101-30"></a></span>
<span id="cb101-31"><a href="visualizing-occupancy-predictor-effects.html#cb101-31"></a><span class="co"># remove null data</span></span>
<span id="cb101-32"><a href="visualizing-occupancy-predictor-effects.html#cb101-32"></a>model_est &lt;-<span class="st"> </span><span class="kw">keep</span>(model_est, <span class="dt">.p =</span> <span class="cf">function</span>(x) <span class="op">!</span><span class="kw">is.null</span>(x))</span>
<span id="cb101-33"><a href="visualizing-occupancy-predictor-effects.html#cb101-33"></a></span>
<span id="cb101-34"><a href="visualizing-occupancy-predictor-effects.html#cb101-34"></a><span class="co"># rename model data components and separate predictors</span></span>
<span id="cb101-35"><a href="visualizing-occupancy-predictor-effects.html#cb101-35"></a>names &lt;-<span class="st"> </span><span class="kw">c</span>(</span>
<span id="cb101-36"><a href="visualizing-occupancy-predictor-effects.html#cb101-36"></a>  <span class="st">&quot;predictor&quot;</span>, <span class="st">&quot;coefficient&quot;</span>, <span class="st">&quot;se&quot;</span>, <span class="st">&quot;ci_lower&quot;</span>,</span>
<span id="cb101-37"><a href="visualizing-occupancy-predictor-effects.html#cb101-37"></a>  <span class="st">&quot;ci_higher&quot;</span>, <span class="st">&quot;z_value&quot;</span>, <span class="st">&quot;p_value&quot;</span></span>
<span id="cb101-38"><a href="visualizing-occupancy-predictor-effects.html#cb101-38"></a>)</span>
<span id="cb101-39"><a href="visualizing-occupancy-predictor-effects.html#cb101-39"></a></span>
<span id="cb101-40"><a href="visualizing-occupancy-predictor-effects.html#cb101-40"></a><span class="co"># get data for plotting:</span></span>
<span id="cb101-41"><a href="visualizing-occupancy-predictor-effects.html#cb101-41"></a>model_est &lt;-<span class="st"> </span><span class="kw">map</span>(model_est, <span class="cf">function</span>(df) {</span>
<span id="cb101-42"><a href="visualizing-occupancy-predictor-effects.html#cb101-42"></a>  <span class="kw">colnames</span>(df) &lt;-<span class="st"> </span>names</span>
<span id="cb101-43"><a href="visualizing-occupancy-predictor-effects.html#cb101-43"></a>  <span class="co"># df &lt;- separate_interaction_terms(df)</span></span>
<span id="cb101-44"><a href="visualizing-occupancy-predictor-effects.html#cb101-44"></a>  <span class="co"># df &lt;- make_response_data(df)</span></span>
<span id="cb101-45"><a href="visualizing-occupancy-predictor-effects.html#cb101-45"></a>  <span class="kw">return</span>(df)</span>
<span id="cb101-46"><a href="visualizing-occupancy-predictor-effects.html#cb101-46"></a>})</span>
<span id="cb101-47"><a href="visualizing-occupancy-predictor-effects.html#cb101-47"></a></span>
<span id="cb101-48"><a href="visualizing-occupancy-predictor-effects.html#cb101-48"></a><span class="co"># add names and scales</span></span>
<span id="cb101-49"><a href="visualizing-occupancy-predictor-effects.html#cb101-49"></a>model_est &lt;-<span class="st"> </span><span class="kw">imap</span>(model_est, <span class="cf">function</span>(.x, .y) {</span>
<span id="cb101-50"><a href="visualizing-occupancy-predictor-effects.html#cb101-50"></a>  <span class="kw">mutate</span>(.x, <span class="dt">scientific_name =</span> .y)</span>
<span id="cb101-51"><a href="visualizing-occupancy-predictor-effects.html#cb101-51"></a>})</span>
<span id="cb101-52"><a href="visualizing-occupancy-predictor-effects.html#cb101-52"></a></span>
<span id="cb101-53"><a href="visualizing-occupancy-predictor-effects.html#cb101-53"></a><span class="co"># remove modulators</span></span>
<span id="cb101-54"><a href="visualizing-occupancy-predictor-effects.html#cb101-54"></a>model_est &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(model_est) <span class="op">%&gt;%</span></span>
<span id="cb101-55"><a href="visualizing-occupancy-predictor-effects.html#cb101-55"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="kw">matches</span>(<span class="st">&quot;modulator&quot;</span>))</span>
<span id="cb101-56"><a href="visualizing-occupancy-predictor-effects.html#cb101-56"></a></span>
<span id="cb101-57"><a href="visualizing-occupancy-predictor-effects.html#cb101-57"></a><span class="co"># join data to species name</span></span>
<span id="cb101-58"><a href="visualizing-occupancy-predictor-effects.html#cb101-58"></a>model_data &lt;-<span class="st"> </span>model_data <span class="op">%&gt;%</span></span>
<span id="cb101-59"><a href="visualizing-occupancy-predictor-effects.html#cb101-59"></a><span class="st">  </span><span class="kw">left_join</span>(model_est)</span>
<span id="cb101-60"><a href="visualizing-occupancy-predictor-effects.html#cb101-60"></a></span>
<span id="cb101-61"><a href="visualizing-occupancy-predictor-effects.html#cb101-61"></a><span class="co"># Keep only those predictors whose p-values are significant:</span></span>
<span id="cb101-62"><a href="visualizing-occupancy-predictor-effects.html#cb101-62"></a>model_data &lt;-<span class="st"> </span>model_data <span class="op">%&gt;%</span></span>
<span id="cb101-63"><a href="visualizing-occupancy-predictor-effects.html#cb101-63"></a><span class="st">  </span><span class="kw">filter</span>(p_value <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>) <span class="op">%&gt;%</span></span>
<span id="cb101-64"><a href="visualizing-occupancy-predictor-effects.html#cb101-64"></a><span class="st">  </span><span class="kw">filter</span>(predictor <span class="op">!=</span><span class="st"> &quot;Int&quot;</span>)</span></code></pre></div>
<p>Export predictor effects.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="visualizing-occupancy-predictor-effects.html#cb102-1"></a><span class="co"># get predictor effect data</span></span>
<span id="cb102-2"><a href="visualizing-occupancy-predictor-effects.html#cb102-2"></a>data_predictor_effect &lt;-<span class="st"> </span><span class="kw">distinct</span>(</span>
<span id="cb102-3"><a href="visualizing-occupancy-predictor-effects.html#cb102-3"></a>  model_data,</span>
<span id="cb102-4"><a href="visualizing-occupancy-predictor-effects.html#cb102-4"></a>  scientific_name,</span>
<span id="cb102-5"><a href="visualizing-occupancy-predictor-effects.html#cb102-5"></a>  se,</span>
<span id="cb102-6"><a href="visualizing-occupancy-predictor-effects.html#cb102-6"></a>  predictor, coefficient</span>
<span id="cb102-7"><a href="visualizing-occupancy-predictor-effects.html#cb102-7"></a>)</span>
<span id="cb102-8"><a href="visualizing-occupancy-predictor-effects.html#cb102-8"></a></span>
<span id="cb102-9"><a href="visualizing-occupancy-predictor-effects.html#cb102-9"></a><span class="co"># write to file</span></span>
<span id="cb102-10"><a href="visualizing-occupancy-predictor-effects.html#cb102-10"></a><span class="kw">write_csv</span>(data_predictor_effect, <span class="st">&quot;results/10_data-predictor-effect.csv&quot;</span>)</span></code></pre></div>
<p>Export model data.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="visualizing-occupancy-predictor-effects.html#cb103-1"></a>model_data_to_file &lt;-<span class="st"> </span>model_data <span class="op">%&gt;%</span></span>
<span id="cb103-2"><a href="visualizing-occupancy-predictor-effects.html#cb103-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(</span>
<span id="cb103-3"><a href="visualizing-occupancy-predictor-effects.html#cb103-3"></a>    predictor,</span>
<span id="cb103-4"><a href="visualizing-occupancy-predictor-effects.html#cb103-4"></a>    scientific_name</span>
<span id="cb103-5"><a href="visualizing-occupancy-predictor-effects.html#cb103-5"></a>  )</span>
<span id="cb103-6"><a href="visualizing-occupancy-predictor-effects.html#cb103-6"></a></span>
<span id="cb103-7"><a href="visualizing-occupancy-predictor-effects.html#cb103-7"></a><span class="co"># remove .y</span></span>
<span id="cb103-8"><a href="visualizing-occupancy-predictor-effects.html#cb103-8"></a>model_data_to_file &lt;-<span class="st"> </span>model_data_to_file <span class="op">%&gt;%</span></span>
<span id="cb103-9"><a href="visualizing-occupancy-predictor-effects.html#cb103-9"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">predictor =</span> <span class="kw">str_remove</span>(predictor, <span class="st">&quot;</span><span class="ch">\\</span><span class="st">.y&quot;</span>))</span>
<span id="cb103-10"><a href="visualizing-occupancy-predictor-effects.html#cb103-10"></a></span>
<span id="cb103-11"><a href="visualizing-occupancy-predictor-effects.html#cb103-11"></a><span class="kw">write_csv</span>(</span>
<span id="cb103-12"><a href="visualizing-occupancy-predictor-effects.html#cb103-12"></a>  model_data_to_file,</span>
<span id="cb103-13"><a href="visualizing-occupancy-predictor-effects.html#cb103-13"></a>  <span class="st">&quot;results/10_data-occupancy-predictors.csv&quot;</span></span>
<span id="cb103-14"><a href="visualizing-occupancy-predictor-effects.html#cb103-14"></a>)</span></code></pre></div>
<p>Read in data after clearing R session.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="visualizing-occupancy-predictor-effects.html#cb104-1"></a><span class="co"># first merge species trait data with significant predictor</span></span>
<span id="cb104-2"><a href="visualizing-occupancy-predictor-effects.html#cb104-2"></a>species_trait &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/species-trait-dat.csv&quot;</span>)</span>
<span id="cb104-3"><a href="visualizing-occupancy-predictor-effects.html#cb104-3"></a>sig_predictor &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;results/10_data-predictor-effect.csv&quot;</span>)</span>
<span id="cb104-4"><a href="visualizing-occupancy-predictor-effects.html#cb104-4"></a>merged_species_traits &lt;-<span class="st"> </span><span class="kw">inner_join</span>(sig_predictor, species_trait,</span>
<span id="cb104-5"><a href="visualizing-occupancy-predictor-effects.html#cb104-5"></a>  <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;scientific_name&quot;</span> =<span class="st"> &quot;scientific_name&quot;</span>)</span>
<span id="cb104-6"><a href="visualizing-occupancy-predictor-effects.html#cb104-6"></a>)</span>
<span id="cb104-7"><a href="visualizing-occupancy-predictor-effects.html#cb104-7"></a><span class="kw">write_csv</span>(</span>
<span id="cb104-8"><a href="visualizing-occupancy-predictor-effects.html#cb104-8"></a>  merged_species_traits,</span>
<span id="cb104-9"><a href="visualizing-occupancy-predictor-effects.html#cb104-9"></a>  <span class="st">&quot;results/10_results-predictors-species-traits.csv&quot;</span></span>
<span id="cb104-10"><a href="visualizing-occupancy-predictor-effects.html#cb104-10"></a>)</span>
<span id="cb104-11"><a href="visualizing-occupancy-predictor-effects.html#cb104-11"></a></span>
<span id="cb104-12"><a href="visualizing-occupancy-predictor-effects.html#cb104-12"></a><span class="co"># read from file</span></span>
<span id="cb104-13"><a href="visualizing-occupancy-predictor-effects.html#cb104-13"></a>model_data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;results/10_results-predictors-species-traits.csv&quot;</span>)</span></code></pre></div>
<p>Fix predictor name.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="visualizing-occupancy-predictor-effects.html#cb105-1"></a><span class="co"># remove .y from predictors</span></span>
<span id="cb105-2"><a href="visualizing-occupancy-predictor-effects.html#cb105-2"></a>model_data &lt;-<span class="st"> </span>model_data <span class="op">%&gt;%</span></span>
<span id="cb105-3"><a href="visualizing-occupancy-predictor-effects.html#cb105-3"></a><span class="st">  </span><span class="kw">mutate_at</span>(<span class="dt">.vars =</span> <span class="kw">c</span>(<span class="st">&quot;predictor&quot;</span>), <span class="dt">.funs =</span> <span class="cf">function</span>(x) {</span>
<span id="cb105-4"><a href="visualizing-occupancy-predictor-effects.html#cb105-4"></a>    stringr<span class="op">::</span><span class="kw">str_remove</span>(x, <span class="st">&quot;.y&quot;</span>)</span>
<span id="cb105-5"><a href="visualizing-occupancy-predictor-effects.html#cb105-5"></a>  })</span></code></pre></div>
</div>
<div id="get-predictor-effects" class="section level2">
<h2><span class="header-section-number">10.5</span> Get predictor effects</h2>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="visualizing-occupancy-predictor-effects.html#cb106-1"></a><span class="co"># is the coeff positive? how many positive per scale per predictor per axis of split?</span></span>
<span id="cb106-2"><a href="visualizing-occupancy-predictor-effects.html#cb106-2"></a><span class="co"># now splitting by habitat --- forest or open country</span></span>
<span id="cb106-3"><a href="visualizing-occupancy-predictor-effects.html#cb106-3"></a>data_predictor &lt;-<span class="st"> </span><span class="kw">mutate</span>(model_data,</span>
<span id="cb106-4"><a href="visualizing-occupancy-predictor-effects.html#cb106-4"></a>  <span class="dt">direction =</span> coefficient <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span></span>
<span id="cb106-5"><a href="visualizing-occupancy-predictor-effects.html#cb106-5"></a>) <span class="op">%&gt;%</span></span>
<span id="cb106-6"><a href="visualizing-occupancy-predictor-effects.html#cb106-6"></a><span class="st">  </span><span class="kw">filter</span>(predictor <span class="op">!=</span><span class="st"> &quot;Int&quot;</span>, predictor <span class="op">!=</span><span class="st"> &quot;Ibio4^2&quot;</span> <span class="op">&amp;</span><span class="st"> </span><span class="co"># If you had squared terms</span></span>
<span id="cb106-7"><a href="visualizing-occupancy-predictor-effects.html#cb106-7"></a><span class="st">    </span>predictor <span class="op">!=</span><span class="st"> &quot;Ibio15^2&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb106-8"><a href="visualizing-occupancy-predictor-effects.html#cb106-8"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">habitat =</span> <span class="st">&quot;Habitat.type&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb106-9"><a href="visualizing-occupancy-predictor-effects.html#cb106-9"></a><span class="st">  </span><span class="kw">count</span>(</span>
<span id="cb106-10"><a href="visualizing-occupancy-predictor-effects.html#cb106-10"></a>    predictor,</span>
<span id="cb106-11"><a href="visualizing-occupancy-predictor-effects.html#cb106-11"></a>    habitat,</span>
<span id="cb106-12"><a href="visualizing-occupancy-predictor-effects.html#cb106-12"></a>    direction</span>
<span id="cb106-13"><a href="visualizing-occupancy-predictor-effects.html#cb106-13"></a>  ) <span class="op">%&gt;%</span></span>
<span id="cb106-14"><a href="visualizing-occupancy-predictor-effects.html#cb106-14"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">mag =</span> n <span class="op">*</span><span class="st"> </span>(<span class="kw">if_else</span>(direction, <span class="dv">1</span>, <span class="dv">-1</span>)))</span>
<span id="cb106-15"><a href="visualizing-occupancy-predictor-effects.html#cb106-15"></a></span>
<span id="cb106-16"><a href="visualizing-occupancy-predictor-effects.html#cb106-16"></a><span class="co"># wrangle data to get nice bars</span></span>
<span id="cb106-17"><a href="visualizing-occupancy-predictor-effects.html#cb106-17"></a>data_predictor &lt;-<span class="st"> </span>data_predictor <span class="op">%&gt;%</span></span>
<span id="cb106-18"><a href="visualizing-occupancy-predictor-effects.html#cb106-18"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>n) <span class="op">%&gt;%</span></span>
<span id="cb106-19"><a href="visualizing-occupancy-predictor-effects.html#cb106-19"></a><span class="st">  </span><span class="kw">drop_na</span>(direction) <span class="op">%&gt;%</span></span>
<span id="cb106-20"><a href="visualizing-occupancy-predictor-effects.html#cb106-20"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">direction =</span> <span class="kw">ifelse</span>(direction, <span class="st">&quot;positive&quot;</span>, <span class="st">&quot;negative&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb106-21"><a href="visualizing-occupancy-predictor-effects.html#cb106-21"></a><span class="st">  </span><span class="kw">pivot_wider</span>(<span class="dt">values_from =</span> <span class="st">&quot;mag&quot;</span>, <span class="dt">names_from =</span> <span class="st">&quot;direction&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb106-22"><a href="visualizing-occupancy-predictor-effects.html#cb106-22"></a><span class="st">  </span><span class="kw">mutate_at</span>(</span>
<span id="cb106-23"><a href="visualizing-occupancy-predictor-effects.html#cb106-23"></a>    <span class="kw">vars</span>(positive, negative),</span>
<span id="cb106-24"><a href="visualizing-occupancy-predictor-effects.html#cb106-24"></a>    <span class="op">~</span><span class="st"> </span><span class="kw">if_else</span>(<span class="kw">is.na</span>(.), <span class="dv">0</span>, .)</span>
<span id="cb106-25"><a href="visualizing-occupancy-predictor-effects.html#cb106-25"></a>  )</span>
<span id="cb106-26"><a href="visualizing-occupancy-predictor-effects.html#cb106-26"></a></span>
<span id="cb106-27"><a href="visualizing-occupancy-predictor-effects.html#cb106-27"></a>data_predictor_long &lt;-<span class="st"> </span>data_predictor <span class="op">%&gt;%</span></span>
<span id="cb106-28"><a href="visualizing-occupancy-predictor-effects.html#cb106-28"></a><span class="st">  </span><span class="kw">pivot_longer</span>(</span>
<span id="cb106-29"><a href="visualizing-occupancy-predictor-effects.html#cb106-29"></a>    <span class="dt">cols =</span> <span class="kw">c</span>(<span class="st">&quot;negative&quot;</span>, <span class="st">&quot;positive&quot;</span>),</span>
<span id="cb106-30"><a href="visualizing-occupancy-predictor-effects.html#cb106-30"></a>    <span class="dt">names_to =</span> <span class="st">&quot;effect&quot;</span>,</span>
<span id="cb106-31"><a href="visualizing-occupancy-predictor-effects.html#cb106-31"></a>    <span class="dt">values_to =</span> <span class="st">&quot;magnitude&quot;</span></span>
<span id="cb106-32"><a href="visualizing-occupancy-predictor-effects.html#cb106-32"></a>  )</span>
<span id="cb106-33"><a href="visualizing-occupancy-predictor-effects.html#cb106-33"></a></span>
<span id="cb106-34"><a href="visualizing-occupancy-predictor-effects.html#cb106-34"></a><span class="co"># write</span></span>
<span id="cb106-35"><a href="visualizing-occupancy-predictor-effects.html#cb106-35"></a><span class="kw">write_csv</span>(</span>
<span id="cb106-36"><a href="visualizing-occupancy-predictor-effects.html#cb106-36"></a>  data_predictor_long,</span>
<span id="cb106-37"><a href="visualizing-occupancy-predictor-effects.html#cb106-37"></a>  <span class="st">&quot;results/10_data-predictor-direction-nSpecies.csv&quot;</span></span>
<span id="cb106-38"><a href="visualizing-occupancy-predictor-effects.html#cb106-38"></a>)</span></code></pre></div>
<p>Prepare data to determine the direction (positive or negative) of the effect of each predictor. How many species are affected in either direction?</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="visualizing-occupancy-predictor-effects.html#cb107-1"></a><span class="co"># join with predictor names and relative AIC</span></span>
<span id="cb107-2"><a href="visualizing-occupancy-predictor-effects.html#cb107-2"></a>data_predictor_long &lt;-<span class="st"> </span><span class="kw">left_join</span>(data_predictor_long, model_imp)</span></code></pre></div>
<p>Prepare figure of the number of species affected in each direction. Figure code is hidden in versions rendered as HTML and PDF.</p>
<div class="figure">
<img src="figs/fig_04.png" alt="" />
<p class="caption"><strong>Environmental predictors and species-specific associations</strong>
The direction of association between species-specific probability of occupancy and climatic and landscape predictors is shown here (as a function of habitat preference). Blue colors show the number of species that are positively associated with a climatic/landscape predictor while red colors show the number of species that are negatively associated with a climatic/landscape predictor (see Table 1 for the number of forest/generalist species that show positive/negative association with each of the predictors).</p>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="modelling-species-occupancy.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/pratikunterwegs/eBirdOccupancy/edit/master/10_visualize-occu-predictor-effects.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
