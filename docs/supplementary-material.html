<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 7 Supplementary material | Influence of land cover and climate on the occupancy of avian distributions along a tropical montane gradient</title>
  <meta name="description" content="Section 7 Supplementary material | Influence of land cover and climate on the occupancy of avian distributions along a tropical montane gradient" />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 7 Supplementary material | Influence of land cover and climate on the occupancy of avian distributions along a tropical montane gradient" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Section 7 Supplementary material | Influence of land cover and climate on the occupancy of avian distributions along a tropical montane gradient" />
  <meta name="github-repo" content="pratikunterwegs/eBirdOccupancy" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 7 Supplementary material | Influence of land cover and climate on the occupancy of avian distributions along a tropical montane gradient" />
  
  <meta name="twitter:description" content="Section 7 Supplementary material | Influence of land cover and climate on the occupancy of avian distributions along a tropical montane gradient" />
  

<meta name="author" content="Vijay Ramesh, Pratik R Gupte, and Morgan Tingley" />


<meta name="date" content="2020-01-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="occupancy-modelling.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#attribution"><i class="fa fa-check"></i><b>1.1</b> Attribution</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#data-access"><i class="fa fa-check"></i><b>1.2</b> Data access</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#data-processing"><i class="fa fa-check"></i><b>1.3</b> Data processing</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="preparing-ebird-data.html"><a href="preparing-ebird-data.html"><i class="fa fa-check"></i><b>2</b> Preparing eBird data</a><ul>
<li class="chapter" data-level="2.1" data-path="preparing-ebird-data.html"><a href="preparing-ebird-data.html#prepare-libraries-and-data-sources"><i class="fa fa-check"></i><b>2.1</b> Prepare libraries and data sources</a></li>
<li class="chapter" data-level="2.2" data-path="preparing-ebird-data.html"><a href="preparing-ebird-data.html#filter-data"><i class="fa fa-check"></i><b>2.2</b> Filter data</a></li>
<li class="chapter" data-level="2.3" data-path="preparing-ebird-data.html"><a href="preparing-ebird-data.html#process-filtered-data"><i class="fa fa-check"></i><b>2.3</b> Process filtered data</a></li>
<li class="chapter" data-level="2.4" data-path="preparing-ebird-data.html"><a href="preparing-ebird-data.html#spatial-filter"><i class="fa fa-check"></i><b>2.4</b> Spatial filter</a></li>
<li class="chapter" data-level="2.5" data-path="preparing-ebird-data.html"><a href="preparing-ebird-data.html#handle-presence-data"><i class="fa fa-check"></i><b>2.5</b> Handle presence data</a></li>
<li class="chapter" data-level="2.6" data-path="preparing-ebird-data.html"><a href="preparing-ebird-data.html#add-decimal-time"><i class="fa fa-check"></i><b>2.6</b> Add decimal time</a></li>
<li class="chapter" data-level="2.7" data-path="preparing-ebird-data.html"><a href="preparing-ebird-data.html#write-data"><i class="fa fa-check"></i><b>2.7</b> Write data</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="prepare-landscape-data.html"><a href="prepare-landscape-data.html"><i class="fa fa-check"></i><b>3</b> Prepare landscape data</a><ul>
<li class="chapter" data-level="3.1" data-path="prepare-landscape-data.html"><a href="prepare-landscape-data.html#prepare-libraries"><i class="fa fa-check"></i><b>3.1</b> Prepare libraries</a></li>
<li class="chapter" data-level="3.2" data-path="prepare-landscape-data.html"><a href="prepare-landscape-data.html#prepare-initial-data"><i class="fa fa-check"></i><b>3.2</b> Prepare initial data</a><ul>
<li class="chapter" data-level="3.2.1" data-path="prepare-landscape-data.html"><a href="prepare-landscape-data.html#prepare-spatial-extent"><i class="fa fa-check"></i><b>3.2.1</b> Prepare spatial extent</a></li>
<li class="chapter" data-level="3.2.2" data-path="prepare-landscape-data.html"><a href="prepare-landscape-data.html#prepare-terrain-rasters"><i class="fa fa-check"></i><b>3.2.2</b> Prepare terrain rasters</a></li>
<li class="chapter" data-level="3.2.3" data-path="prepare-landscape-data.html"><a href="prepare-landscape-data.html#prepare-chelsa-rasters"><i class="fa fa-check"></i><b>3.2.3</b> Prepare CHELSA rasters</a></li>
<li class="chapter" data-level="3.2.4" data-path="prepare-landscape-data.html"><a href="prepare-landscape-data.html#stack-prepared-rasters"><i class="fa fa-check"></i><b>3.2.4</b> Stack prepared rasters</a></li>
<li class="chapter" data-level="3.2.5" data-path="prepare-landscape-data.html"><a href="prepare-landscape-data.html#prepare-landcover"><i class="fa fa-check"></i><b>3.2.5</b> Prepare landcover</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="prepare-landscape-data.html"><a href="prepare-landscape-data.html#resample-rasters"><i class="fa fa-check"></i><b>3.3</b> Resample rasters</a><ul>
<li class="chapter" data-level="3.3.1" data-path="prepare-landscape-data.html"><a href="prepare-landscape-data.html#read-landcover-as-list"><i class="fa fa-check"></i><b>3.3.1</b> Read landcover as list</a></li>
<li class="chapter" data-level="3.3.2" data-path="prepare-landscape-data.html"><a href="prepare-landscape-data.html#reproject-environmental-data-to-landcover"><i class="fa fa-check"></i><b>3.3.2</b> Reproject environmental data to landcover</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="prepare-observer-expertise.html"><a href="prepare-observer-expertise.html"><i class="fa fa-check"></i><b>4</b> Prepare observer expertise</a><ul>
<li class="chapter" data-level="4.1" data-path="prepare-observer-expertise.html"><a href="prepare-observer-expertise.html#prepare-libraries-1"><i class="fa fa-check"></i><b>4.1</b> Prepare libraries</a></li>
<li class="chapter" data-level="4.2" data-path="prepare-observer-expertise.html"><a href="prepare-observer-expertise.html#prepare-data"><i class="fa fa-check"></i><b>4.2</b> Prepare data</a></li>
<li class="chapter" data-level="4.3" data-path="prepare-observer-expertise.html"><a href="prepare-observer-expertise.html#explicit-spatial-subset"><i class="fa fa-check"></i><b>4.3</b> Explicit spatial subset</a></li>
<li class="chapter" data-level="4.4" data-path="prepare-observer-expertise.html"><a href="prepare-observer-expertise.html#prepare-species-of-interest"><i class="fa fa-check"></i><b>4.4</b> Prepare species of interest</a></li>
<li class="chapter" data-level="4.5" data-path="prepare-observer-expertise.html"><a href="prepare-observer-expertise.html#prepare-checklists-for-observer-score"><i class="fa fa-check"></i><b>4.5</b> Prepare checklists for observer score</a></li>
<li class="chapter" data-level="4.6" data-path="prepare-observer-expertise.html"><a href="prepare-observer-expertise.html#get-landcover"><i class="fa fa-check"></i><b>4.6</b> Get landcover</a></li>
<li class="chapter" data-level="4.7" data-path="prepare-observer-expertise.html"><a href="prepare-observer-expertise.html#filter-data-for-stats"><i class="fa fa-check"></i><b>4.7</b> Filter data for stats</a></li>
<li class="chapter" data-level="4.8" data-path="prepare-observer-expertise.html"><a href="prepare-observer-expertise.html#run-observer-expertise-model"><i class="fa fa-check"></i><b>4.8</b> Run observer expertise model</a></li>
<li class="chapter" data-level="4.9" data-path="prepare-observer-expertise.html"><a href="prepare-observer-expertise.html#write-model-to-file"><i class="fa fa-check"></i><b>4.9</b> Write model to file</a></li>
<li class="chapter" data-level="4.10" data-path="prepare-observer-expertise.html"><a href="prepare-observer-expertise.html#get-observer-expertise-as-species-in-60-mins"><i class="fa fa-check"></i><b>4.10</b> Get observer expertise as species in 60 mins</a></li>
<li class="chapter" data-level="4.11" data-path="prepare-observer-expertise.html"><a href="prepare-observer-expertise.html#write-observer-expertise-to-file"><i class="fa fa-check"></i><b>4.11</b> Write observer expertise to file</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="add-covariates-to-subsampled-data.html"><a href="add-covariates-to-subsampled-data.html"><i class="fa fa-check"></i><b>5</b> Add covariates to subsampled data</a><ul>
<li class="chapter" data-level="5.1" data-path="add-covariates-to-subsampled-data.html"><a href="add-covariates-to-subsampled-data.html#prepare-libraries-and-data"><i class="fa fa-check"></i><b>5.1</b> Prepare libraries and data</a></li>
<li class="chapter" data-level="5.2" data-path="add-covariates-to-subsampled-data.html"><a href="add-covariates-to-subsampled-data.html#subsample-data"><i class="fa fa-check"></i><b>5.2</b> Subsample data</a></li>
<li class="chapter" data-level="5.3" data-path="add-covariates-to-subsampled-data.html"><a href="add-covariates-to-subsampled-data.html#add-expertise-score"><i class="fa fa-check"></i><b>5.3</b> Add expertise score</a></li>
<li class="chapter" data-level="5.4" data-path="add-covariates-to-subsampled-data.html"><a href="add-covariates-to-subsampled-data.html#add-landscape-covariates"><i class="fa fa-check"></i><b>5.4</b> Add landscape covariates</a></li>
<li class="chapter" data-level="5.5" data-path="add-covariates-to-subsampled-data.html"><a href="add-covariates-to-subsampled-data.html#construct-buffers-around-subsampled-points"><i class="fa fa-check"></i><b>5.5</b> Construct buffers around subsampled points</a></li>
<li class="chapter" data-level="5.6" data-path="add-covariates-to-subsampled-data.html"><a href="add-covariates-to-subsampled-data.html#getting-area-means"><i class="fa fa-check"></i><b>5.6</b> Getting area means</a><ul>
<li class="chapter" data-level="5.6.1" data-path="add-covariates-to-subsampled-data.html"><a href="add-covariates-to-subsampled-data.html#mean-environmental-covariates"><i class="fa fa-check"></i><b>5.6.1</b> Mean environmental covariates</a></li>
<li class="chapter" data-level="5.6.2" data-path="add-covariates-to-subsampled-data.html"><a href="add-covariates-to-subsampled-data.html#proportional-landcover"><i class="fa fa-check"></i><b>5.6.2</b> Proportional landcover</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="add-covariates-to-subsampled-data.html"><a href="add-covariates-to-subsampled-data.html#join-landscape-data-to-obs-data"><i class="fa fa-check"></i><b>5.7</b> Join landscape data to obs data</a></li>
<li class="chapter" data-level="5.8" data-path="add-covariates-to-subsampled-data.html"><a href="add-covariates-to-subsampled-data.html#write-data-to-files"><i class="fa fa-check"></i><b>5.8</b> Write data to files</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="occupancy-modelling.html"><a href="occupancy-modelling.html"><i class="fa fa-check"></i><b>6</b> Occupancy modelling</a><ul>
<li class="chapter" data-level="6.1" data-path="occupancy-modelling.html"><a href="occupancy-modelling.html#load-necessary-libraries"><i class="fa fa-check"></i><b>6.1</b> Load necessary libraries</a></li>
<li class="chapter" data-level="6.2" data-path="occupancy-modelling.html"><a href="occupancy-modelling.html#load-dataframe-and-scale-covariates"><i class="fa fa-check"></i><b>6.2</b> Load dataframe and scale covariates</a></li>
<li class="chapter" data-level="6.3" data-path="occupancy-modelling.html"><a href="occupancy-modelling.html#identifying-covariates-necessary-to-model-the-detection-process"><i class="fa fa-check"></i><b>6.3</b> Identifying covariates necessary to model the detection process</a></li>
<li class="chapter" data-level="6.4" data-path="occupancy-modelling.html"><a href="occupancy-modelling.html#running-a-null-model"><i class="fa fa-check"></i><b>6.4</b> Running a null model</a></li>
<li class="chapter" data-level="6.5" data-path="occupancy-modelling.html"><a href="occupancy-modelling.html#land-cover-and-climate-effects-modeled-separately"><i class="fa fa-check"></i><b>6.5</b> Land Cover and Climate (effects modeled separately)</a></li>
<li class="chapter" data-level="6.6" data-path="occupancy-modelling.html"><a href="occupancy-modelling.html#elevation-alone"><i class="fa fa-check"></i><b>6.6</b> Elevation alone</a></li>
<li class="chapter" data-level="6.7" data-path="occupancy-modelling.html"><a href="occupancy-modelling.html#the-interaction-between-land-cover-and-elevation-and-climate-and-elevation"><i class="fa fa-check"></i><b>6.7</b> The interaction between Land cover and elevation and climate and Elevation</a></li>
<li class="chapter" data-level="6.8" data-path="occupancy-modelling.html"><a href="occupancy-modelling.html#the-linear-combined-effect-of-land-cover-and-climate"><i class="fa fa-check"></i><b>6.8</b> The linear combined effect of land cover and climate</a></li>
<li class="chapter" data-level="6.9" data-path="occupancy-modelling.html"><a href="occupancy-modelling.html#the-interaction-between-inter-annual-variation-in-temperature-and-land-cover"><i class="fa fa-check"></i><b>6.9</b> The interaction between inter-annual variation in temperature and land cover</a></li>
<li class="chapter" data-level="6.10" data-path="occupancy-modelling.html"><a href="occupancy-modelling.html#the-interaction-between-inter-annual-variation-in-precip-and-land-cover"><i class="fa fa-check"></i><b>6.10</b> The interaction between inter-annual variation in precip and land cover</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="supplementary-material.html"><a href="supplementary-material.html"><i class="fa fa-check"></i><b>7</b> Supplementary material</a><ul>
<li class="chapter" data-level="7.1" data-path="supplementary-material.html"><a href="supplementary-material.html#distance-to-roads"><i class="fa fa-check"></i><b>7.1</b> Distance to roads</a><ul>
<li class="chapter" data-level="7.1.1" data-path="supplementary-material.html"><a href="supplementary-material.html#prepare-libraries-2"><i class="fa fa-check"></i><b>7.1.1</b> Prepare libraries</a></li>
<li class="chapter" data-level="7.1.2" data-path="supplementary-material.html"><a href="supplementary-material.html#prepare-data-for-processing"><i class="fa fa-check"></i><b>7.1.2</b> Prepare data for processing</a></li>
<li class="chapter" data-level="7.1.3" data-path="supplementary-material.html"><a href="supplementary-material.html#explicit-spatial-filter"><i class="fa fa-check"></i><b>7.1.3</b> Explicit spatial filter</a></li>
<li class="chapter" data-level="7.1.4" data-path="supplementary-material.html"><a href="supplementary-material.html#plot-histogram-distance-to-roads"><i class="fa fa-check"></i><b>7.1.4</b> Plot histogram: distance to roads</a></li>
<li class="chapter" data-level="7.1.5" data-path="supplementary-material.html"><a href="supplementary-material.html#plot-map-points-on-roads"><i class="fa fa-check"></i><b>7.1.5</b> Plot map: points on roads</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="supplementary-material.html"><a href="supplementary-material.html#species-observation-distributions"><i class="fa fa-check"></i><b>7.2</b> Species observation distributions</a><ul>
<li class="chapter" data-level="7.2.1" data-path="supplementary-material.html"><a href="supplementary-material.html#prepare-libraries-3"><i class="fa fa-check"></i><b>7.2.1</b> Prepare libraries</a></li>
<li class="chapter" data-level="7.2.2" data-path="supplementary-material.html"><a href="supplementary-material.html#read-species-of-interest"><i class="fa fa-check"></i><b>7.2.2</b> Read species of interest</a></li>
<li class="chapter" data-level="7.2.3" data-path="supplementary-material.html"><a href="supplementary-material.html#load-raw-data-for-locations"><i class="fa fa-check"></i><b>7.2.3</b> Load raw data for locations</a></li>
<li class="chapter" data-level="7.2.4" data-path="supplementary-material.html"><a href="supplementary-material.html#get-proportional-obs-counts-in-20km-cells"><i class="fa fa-check"></i><b>7.2.4</b> Get proportional obs counts in 20km cells</a></li>
<li class="chapter" data-level="7.2.5" data-path="supplementary-material.html"><a href="supplementary-material.html#plot-maps"><i class="fa fa-check"></i><b>7.2.5</b> Plot maps</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="supplementary-material.html"><a href="supplementary-material.html#climate-in-relation-to-elevation"><i class="fa fa-check"></i><b>7.3</b> Climate in relation to elevation</a><ul>
<li class="chapter" data-level="7.3.1" data-path="supplementary-material.html"><a href="supplementary-material.html#prepare-libraries-4"><i class="fa fa-check"></i><b>7.3.1</b> Prepare libraries</a></li>
<li class="chapter" data-level="7.3.2" data-path="supplementary-material.html"><a href="supplementary-material.html#plot-climatic-variables-over-elevation"><i class="fa fa-check"></i><b>7.3.2</b> Plot climatic variables over elevation</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="supplementary-material.html"><a href="supplementary-material.html#landcover-in-relation-to-elevation"><i class="fa fa-check"></i><b>7.4</b> Landcover in relation to elevation</a><ul>
<li class="chapter" data-level="7.4.1" data-path="supplementary-material.html"><a href="supplementary-material.html#get-data-from-landscape-rasters"><i class="fa fa-check"></i><b>7.4.1</b> Get data from landscape rasters</a></li>
<li class="chapter" data-level="7.4.2" data-path="supplementary-material.html"><a href="supplementary-material.html#plot-proportional-landcover-in-elevation"><i class="fa fa-check"></i><b>7.4.2</b> Plot proportional landcover in elevation</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="supplementary-material.html"><a href="supplementary-material.html#climate-in-relation-to-landcover"><i class="fa fa-check"></i><b>7.5</b> Climate in relation to landcover</a><ul>
<li class="chapter" data-level="7.5.1" data-path="supplementary-material.html"><a href="supplementary-material.html#prepare-libraries-5"><i class="fa fa-check"></i><b>7.5.1</b> Prepare libraries</a></li>
<li class="chapter" data-level="7.5.2" data-path="supplementary-material.html"><a href="supplementary-material.html#plot-climatic-variables-over-landcover"><i class="fa fa-check"></i><b>7.5.2</b> Plot climatic variables over landcover</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="supplementary-material.html"><a href="supplementary-material.html#obsever-expertise-in-time-and-space"><i class="fa fa-check"></i><b>7.6</b> Obsever expertise in time and space</a><ul>
<li class="chapter" data-level="7.6.1" data-path="supplementary-material.html"><a href="supplementary-material.html#prepare-libraries-6"><i class="fa fa-check"></i><b>7.6.1</b> Prepare libraries</a></li>
<li class="chapter" data-level="7.6.2" data-path="supplementary-material.html"><a href="supplementary-material.html#species-seen-in-relation-to-osberver-expertise"><i class="fa fa-check"></i><b>7.6.2</b> Species seen in relation to osberver expertise</a></li>
<li class="chapter" data-level="7.6.3" data-path="supplementary-material.html"><a href="supplementary-material.html#expertise-in-relation-to-landcover"><i class="fa fa-check"></i><b>7.6.3</b> Expertise in relation to landcover</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="supplementary-material.html"><a href="supplementary-material.html#spatial-autocorrelation-in-climatic-predictors"><i class="fa fa-check"></i><b>7.7</b> Spatial autocorrelation in climatic predictors</a><ul>
<li class="chapter" data-level="7.7.1" data-path="supplementary-material.html"><a href="supplementary-material.html#load-libs-and-prep-data"><i class="fa fa-check"></i><b>7.7.1</b> Load libs and prep data</a></li>
<li class="chapter" data-level="7.7.2" data-path="supplementary-material.html"><a href="supplementary-material.html#calculate-variograms"><i class="fa fa-check"></i><b>7.7.2</b> Calculate variograms</a></li>
<li class="chapter" data-level="7.7.3" data-path="supplementary-material.html"><a href="supplementary-material.html#plot-chelsa-data-and-variograms"><i class="fa fa-check"></i><b>7.7.3</b> Plot CHELSA data and variograms</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Influence of land cover and climate on the occupancy of avian distributions along a tropical montane gradient</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="supplementary-material" class="section level1">
<h1><span class="header-section-number">Section 7</span> Supplementary material</h1>
<div id="distance-to-roads" class="section level2">
<h2><span class="header-section-number">7.1</span> Distance to roads</h2>
<div id="prepare-libraries-2" class="section level3">
<h3><span class="header-section-number">7.1.1</span> Prepare libraries</h3>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1"><span class="co"># load libraries</span></a>
<a class="sourceLine" id="cb53-2" title="2"><span class="kw">library</span>(reticulate)</a>
<a class="sourceLine" id="cb53-3" title="3"><span class="kw">library</span>(sf)</a>
<a class="sourceLine" id="cb53-4" title="4"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb53-5" title="5"><span class="kw">library</span>(scales)</a>
<a class="sourceLine" id="cb53-6" title="6"><span class="kw">library</span>(readr)</a>
<a class="sourceLine" id="cb53-7" title="7"></a>
<a class="sourceLine" id="cb53-8" title="8"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb53-9" title="9"><span class="kw">library</span>(ggthemes)</a>
<a class="sourceLine" id="cb53-10" title="10"><span class="kw">library</span>(ggspatial)</a>
<a class="sourceLine" id="cb53-11" title="11"><span class="kw">library</span>(scico)</a>
<a class="sourceLine" id="cb53-12" title="12"></a>
<a class="sourceLine" id="cb53-13" title="13"><span class="co"># round any function</span></a>
<a class="sourceLine" id="cb53-14" title="14">round_any &lt;-<span class="st"> </span><span class="cf">function</span>(x, <span class="dt">accuracy =</span> <span class="dv">20000</span>){<span class="kw">round</span>(x<span class="op">/</span>accuracy)<span class="op">*</span>accuracy}</a>
<a class="sourceLine" id="cb53-15" title="15"></a>
<a class="sourceLine" id="cb53-16" title="16"><span class="co"># set python path</span></a>
<a class="sourceLine" id="cb53-17" title="17"><span class="kw">use_python</span>(<span class="st">&quot;/usr/bin/python3&quot;</span>)</a></code></pre></div>
<p>Importing python libraries.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb54-1" title="1"><span class="co"># import classic python libs</span></a>
<a class="sourceLine" id="cb54-2" title="2"><span class="im">import</span> itertools</a>
<a class="sourceLine" id="cb54-3" title="3"><span class="im">from</span> operator <span class="im">import</span> itemgetter</a>
<a class="sourceLine" id="cb54-4" title="4"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb54-5" title="5"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb54-6" title="6"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb54-7" title="7"></a>
<a class="sourceLine" id="cb54-8" title="8"><span class="co"># libs for dataframes</span></a>
<a class="sourceLine" id="cb54-9" title="9"><span class="im">import</span> pandas <span class="im">as</span> pd</a>
<a class="sourceLine" id="cb54-10" title="10"></a>
<a class="sourceLine" id="cb54-11" title="11"><span class="co"># import libs for geodata</span></a>
<a class="sourceLine" id="cb54-12" title="12"><span class="im">from</span> shapely.ops <span class="im">import</span> nearest_points</a>
<a class="sourceLine" id="cb54-13" title="13"><span class="im">import</span> geopandas <span class="im">as</span> gpd</a>
<a class="sourceLine" id="cb54-14" title="14"><span class="im">import</span> rasterio</a>
<a class="sourceLine" id="cb54-15" title="15"></a>
<a class="sourceLine" id="cb54-16" title="16"><span class="co"># import ckdtree</span></a>
<a class="sourceLine" id="cb54-17" title="17"><span class="im">from</span> scipy.spatial <span class="im">import</span> cKDTree</a>
<a class="sourceLine" id="cb54-18" title="18"><span class="im">from</span> shapely.geometry <span class="im">import</span> Point, MultiPoint, LineString, MultiLineString</a></code></pre></div>
</div>
<div id="prepare-data-for-processing" class="section level3">
<h3><span class="header-section-number">7.1.2</span> Prepare data for processing</h3>
<div class="sourceCode" id="cb55"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb55-1" title="1"><span class="co"># read in roads shapefile</span></a>
<a class="sourceLine" id="cb55-2" title="2">roads <span class="op">=</span> gpd.read_file(<span class="st">&quot;data/spatial/roads_studysite_2019/roads_studysite_2019.shp&quot;</span>)</a>
<a class="sourceLine" id="cb55-3" title="3">roads.head()</a>
<a class="sourceLine" id="cb55-4" title="4"></a>
<a class="sourceLine" id="cb55-5" title="5"><span class="co"># read in checklist covariates for conversion to gpd</span></a>
<a class="sourceLine" id="cb55-6" title="6"><span class="co"># get unique coordinates, assign them to the df</span></a>
<a class="sourceLine" id="cb55-7" title="7"><span class="co"># convert df to geo-df</span></a>
<a class="sourceLine" id="cb55-8" title="8">chkCovars <span class="op">=</span> pd.read_csv(<span class="st">&quot;data/eBirdChecklistVars.csv&quot;</span>)</a>
<a class="sourceLine" id="cb55-9" title="9">unique_locs <span class="op">=</span> chkCovars.drop_duplicates(subset<span class="op">=</span>[<span class="st">&#39;longitude&#39;</span>,<span class="st">&#39;latitude&#39;</span>,<span class="st">&#39;sampling_event_identifier&#39;</span>])[[<span class="st">&#39;longitude&#39;</span>, <span class="st">&#39;latitude&#39;</span>, <span class="st">&#39;nSp&#39;</span>, <span class="st">&#39;sampling_event_identifier&#39;</span>]]</a>
<a class="sourceLine" id="cb55-10" title="10">unique_locs[<span class="st">&#39;coordId&#39;</span>] <span class="op">=</span> np.arange(<span class="dv">1</span>, unique_locs.shape[<span class="dv">0</span>]<span class="op">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb55-11" title="11">chkCovars <span class="op">=</span> chkCovars.merge(unique_locs, on<span class="op">=</span>[<span class="st">&#39;longitude&#39;</span>, <span class="st">&#39;latitude&#39;</span>, <span class="st">&#39;sampling_event_identifier&#39;</span>])</a>
<a class="sourceLine" id="cb55-12" title="12"></a>
<a class="sourceLine" id="cb55-13" title="13">unique_locs <span class="op">=</span> gpd.GeoDataFrame(</a>
<a class="sourceLine" id="cb55-14" title="14">unique_locs,</a>
<a class="sourceLine" id="cb55-15" title="15">geometry<span class="op">=</span>gpd.points_from_xy(unique_locs.longitude, unique_locs.latitude))</a>
<a class="sourceLine" id="cb55-16" title="16">unique_locs.crs <span class="op">=</span> {<span class="st">&#39;init&#39;</span> :<span class="st">&#39;epsg:4326&#39;</span>}</a>
<a class="sourceLine" id="cb55-17" title="17"></a>
<a class="sourceLine" id="cb55-18" title="18"><span class="co"># reproject spatials to 43n epsg 32642</span></a>
<a class="sourceLine" id="cb55-19" title="19">roads <span class="op">=</span> roads.to_crs({<span class="st">&#39;init&#39;</span>: <span class="st">&#39;epsg:32642&#39;</span>})</a>
<a class="sourceLine" id="cb55-20" title="20">unique_locs <span class="op">=</span> unique_locs.to_crs({<span class="st">&#39;init&#39;</span>: <span class="st">&#39;epsg:32642&#39;</span>})</a>
<a class="sourceLine" id="cb55-21" title="21"></a>
<a class="sourceLine" id="cb55-22" title="22"></a>
<a class="sourceLine" id="cb55-23" title="23"><span class="co"># function to simplify multilinestrings</span></a>
<a class="sourceLine" id="cb55-24" title="24"><span class="kw">def</span> simplify_roads(complex_roads):</a>
<a class="sourceLine" id="cb55-25" title="25">    simpleRoads <span class="op">=</span> []</a>
<a class="sourceLine" id="cb55-26" title="26">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(complex_roads.geometry)):</a>
<a class="sourceLine" id="cb55-27" title="27">        feature <span class="op">=</span> complex_roads.geometry.iloc[i]</a>
<a class="sourceLine" id="cb55-28" title="28">        <span class="cf">if</span> feature.geom_type <span class="op">==</span> <span class="st">&quot;LineString&quot;</span>:</a>
<a class="sourceLine" id="cb55-29" title="29">            simpleRoads.append(feature)</a>
<a class="sourceLine" id="cb55-30" title="30">        <span class="cf">elif</span> feature.geom_type <span class="op">==</span> <span class="st">&quot;MultiLineString&quot;</span>:</a>
<a class="sourceLine" id="cb55-31" title="31">            <span class="cf">for</span> road_level2 <span class="kw">in</span> feature:</a>
<a class="sourceLine" id="cb55-32" title="32">                simpleRoads.append(road_level2)</a>
<a class="sourceLine" id="cb55-33" title="33">    <span class="cf">return</span> simpleRoads</a>
<a class="sourceLine" id="cb55-34" title="34"></a>
<a class="sourceLine" id="cb55-35" title="35"></a>
<a class="sourceLine" id="cb55-36" title="36"><span class="co"># function to use ckdtrees for nearest point finding</span></a>
<a class="sourceLine" id="cb55-37" title="37"><span class="kw">def</span> ckdnearest(gdfA, gdfB):</a>
<a class="sourceLine" id="cb55-38" title="38">    A <span class="op">=</span> np.concatenate(</a>
<a class="sourceLine" id="cb55-39" title="39">    [np.array(geom.coords) <span class="cf">for</span> geom <span class="kw">in</span> gdfA.geometry.to_list()])</a>
<a class="sourceLine" id="cb55-40" title="40">    simplified_features <span class="op">=</span> simplify_roads(gdfB)</a>
<a class="sourceLine" id="cb55-41" title="41">    B <span class="op">=</span> [np.array(geom.coords) <span class="cf">for</span> geom <span class="kw">in</span> simplified_features]</a>
<a class="sourceLine" id="cb55-42" title="42">    B <span class="op">=</span> np.concatenate(B)</a>
<a class="sourceLine" id="cb55-43" title="43">    ckd_tree <span class="op">=</span> cKDTree(B)</a>
<a class="sourceLine" id="cb55-44" title="44">    dist, idx <span class="op">=</span> ckd_tree.query(A, k<span class="op">=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb55-45" title="45">    <span class="cf">return</span> dist</a>
<a class="sourceLine" id="cb55-46" title="46"></a>
<a class="sourceLine" id="cb55-47" title="47"></a>
<a class="sourceLine" id="cb55-48" title="48"><span class="co"># get distance to nearest road</span></a>
<a class="sourceLine" id="cb55-49" title="49">unique_locs[<span class="st">&#39;dist_road&#39;</span>] <span class="op">=</span> ckdnearest(unique_locs, roads)</a>
<a class="sourceLine" id="cb55-50" title="50"></a>
<a class="sourceLine" id="cb55-51" title="51"><span class="co"># write to file</span></a>
<a class="sourceLine" id="cb55-52" title="52">unique_locs <span class="op">=</span> pd.DataFrame(unique_locs.drop(columns<span class="op">=</span><span class="st">&#39;geometry&#39;</span>))</a>
<a class="sourceLine" id="cb55-53" title="53">unique_locs[<span class="st">&#39;dist_road&#39;</span>] <span class="op">=</span> unique_locs[<span class="st">&#39;dist_road&#39;</span>]</a>
<a class="sourceLine" id="cb55-54" title="54">unique_locs.to_csv(path_or_buf<span class="op">=</span><span class="st">&quot;data/locs_dist_to_road.csv&quot;</span>, index<span class="op">=</span><span class="va">False</span>)</a>
<a class="sourceLine" id="cb55-55" title="55"></a>
<a class="sourceLine" id="cb55-56" title="56"><span class="co"># merge unique locs with chkCovars</span></a>
<a class="sourceLine" id="cb55-57" title="57">chkCovars <span class="op">=</span> chkCovars.merge(unique_locs, on<span class="op">=</span>[<span class="st">&#39;latitude&#39;</span>, <span class="st">&#39;longitude&#39;</span>, <span class="st">&#39;coordId&#39;</span>, <span class="st">&#39;sampling_event_identifier&#39;</span>])</a></code></pre></div>
</div>
<div id="explicit-spatial-filter" class="section level3">
<h3><span class="header-section-number">7.1.3</span> Explicit spatial filter</h3>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1"><span class="co"># extract data from python</span></a>
<a class="sourceLine" id="cb56-2" title="2">chkCovars &lt;-<span class="st"> </span>py<span class="op">$</span>chkCovars</a>
<a class="sourceLine" id="cb56-3" title="3">chkCovars &lt;-<span class="st"> </span><span class="kw">st_as_sf</span>(chkCovars, <span class="dt">coords =</span> <span class="kw">c</span>(<span class="st">&quot;longitude&quot;</span>, <span class="st">&quot;latitude&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb56-4" title="4"><span class="st">  `</span><span class="dt">st_crs&lt;-</span><span class="st">`</span>(<span class="dv">4326</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb56-5" title="5"><span class="st">  </span><span class="kw">st_transform</span>(<span class="dv">32643</span>)</a>
<a class="sourceLine" id="cb56-6" title="6"></a>
<a class="sourceLine" id="cb56-7" title="7"><span class="co"># read wg</span></a>
<a class="sourceLine" id="cb56-8" title="8">wg &lt;-<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&quot;data/spatial/hillsShapefile/Nil_Ana_Pal.shp&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb56-9" title="9"><span class="st">  </span><span class="kw">st_transform</span>(<span class="dv">32643</span>)</a>
<a class="sourceLine" id="cb56-10" title="10"></a>
<a class="sourceLine" id="cb56-11" title="11"><span class="co"># spatial subset</span></a>
<a class="sourceLine" id="cb56-12" title="12">chkCovars &lt;-<span class="st"> </span>chkCovars <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb56-13" title="13"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">id =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb56-14" title="14"><span class="st">  </span><span class="kw">filter</span>(id <span class="op">%in%</span><span class="st"> </span><span class="kw">unlist</span>(<span class="kw">st_contains</span>(wg, chkCovars)))</a></code></pre></div>
</div>
<div id="plot-histogram-distance-to-roads" class="section level3">
<h3><span class="header-section-number">7.1.4</span> Plot histogram: distance to roads</h3>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" title="1"><span class="co"># make histogram</span></a>
<a class="sourceLine" id="cb57-2" title="2">hist_roads &lt;-<span class="st"> </span><span class="kw">ggplot</span>(chkCovars)<span class="op">+</span></a>
<a class="sourceLine" id="cb57-3" title="3"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(dist_road <span class="op">/</span><span class="st"> </span><span class="fl">1e3</span>),</a>
<a class="sourceLine" id="cb57-4" title="4">                 <span class="dt">bins =</span> <span class="dv">20</span>, <span class="dt">size=</span><span class="fl">0.2</span>, <span class="dt">fill=</span><span class="st">&quot;steelblue&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb57-5" title="5"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;distance to roads (km)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;# checklists&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb57-6" title="6"><span class="st">  </span><span class="kw">scale_x_log10</span>(<span class="dt">label=</span><span class="kw">label_number</span>(<span class="dt">accuracy =</span> <span class="fl">0.1</span>), </a>
<a class="sourceLine" id="cb57-7" title="7">                <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">10</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb57-8" title="8"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">label=</span><span class="kw">label_number</span>(<span class="dt">scale=</span><span class="fl">0.001</span>, <span class="dt">accuracy =</span> <span class="dv">1</span>, <span class="dt">suffix =</span> <span class="st">&quot;K&quot;</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb57-9" title="9"><span class="st">  </span><span class="kw">theme_few</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb57-10" title="10"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill=</span><span class="st">&quot;white&quot;</span>, <span class="dt">colour =</span> <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb57-11" title="11">        <span class="dt">panel.background =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb57-12" title="12">        <span class="dt">panel.border =</span> <span class="kw">element_blank</span>(), <span class="dt">axis.line =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
</div>
<div id="plot-map-points-on-roads" class="section level3">
<h3><span class="header-section-number">7.1.5</span> Plot map: points on roads</h3>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1">roads &lt;-<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&quot;data/spatial/roads_studysite_2019/roads_studysite_2019.shp&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb58-2" title="2"><span class="st">  </span><span class="kw">st_transform</span>(<span class="dv">32643</span>)</a>
<a class="sourceLine" id="cb58-3" title="3">points &lt;-<span class="st"> </span>chkCovars <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb58-4" title="4"><span class="st">  </span><span class="kw">bind_cols</span>(<span class="kw">as_tibble</span>(<span class="kw">st_coordinates</span>(.))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb58-5" title="5"><span class="st">  </span><span class="kw">st_drop_geometry</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb58-6" title="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">X =</span> <span class="kw">round_any</span>(X, <span class="dv">2500</span>), <span class="dt">Y =</span> <span class="kw">round_any</span>(Y, <span class="dv">2500</span>))</a>
<a class="sourceLine" id="cb58-7" title="7"></a>
<a class="sourceLine" id="cb58-8" title="8">points &lt;-<span class="st"> </span><span class="kw">count</span>(points, X,Y)</a>
<a class="sourceLine" id="cb58-9" title="9"></a>
<a class="sourceLine" id="cb58-10" title="10"><span class="co"># add land</span></a>
<a class="sourceLine" id="cb58-11" title="11"><span class="kw">library</span>(rnaturalearth)</a>
<a class="sourceLine" id="cb58-12" title="12">land &lt;-<span class="st"> </span><span class="kw">ne_countries</span>(<span class="dt">scale =</span> <span class="dv">50</span>, <span class="dt">type =</span> <span class="st">&quot;countries&quot;</span>, <span class="dt">continent =</span> <span class="st">&quot;asia&quot;</span>,</a>
<a class="sourceLine" id="cb58-13" title="13">                     <span class="dt">country =</span> <span class="st">&quot;india&quot;</span>,</a>
<a class="sourceLine" id="cb58-14" title="14">                     <span class="dt">returnclass =</span> <span class="kw">c</span>(<span class="st">&quot;sf&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb58-15" title="15"><span class="st">  </span><span class="kw">st_transform</span>(<span class="dv">32643</span>)</a>
<a class="sourceLine" id="cb58-16" title="16"></a>
<a class="sourceLine" id="cb58-17" title="17">bbox &lt;-<span class="st"> </span><span class="kw">st_bbox</span>(wg)</a></code></pre></div>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" title="1"><span class="co"># plot on maps</span></a>
<a class="sourceLine" id="cb59-2" title="2"><span class="kw">ggplot</span>(wg)<span class="op">+</span></a>
<a class="sourceLine" id="cb59-3" title="3"><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> land, <span class="dt">fill =</span> <span class="st">&quot;grey90&quot;</span>, <span class="dt">col =</span> <span class="ot">NA</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb59-4" title="4"><span class="st">  </span><span class="kw">annotation_custom</span>(<span class="dt">grob =</span> hist_roads <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplotGrob</span>(),</a>
<a class="sourceLine" id="cb59-5" title="5">                    <span class="dt">xmin =</span> bbox[<span class="st">&quot;xmax&quot;</span>] <span class="op">-</span><span class="st"> </span>(bbox[<span class="st">&quot;xmax&quot;</span>] <span class="op">-</span><span class="st"> </span>bbox[<span class="st">&quot;xmin&quot;</span>])<span class="op">/</span><span class="fl">2.5</span>, </a>
<a class="sourceLine" id="cb59-6" title="6">                    <span class="dt">xmax =</span> bbox[<span class="st">&quot;xmax&quot;</span>], </a>
<a class="sourceLine" id="cb59-7" title="7">                    <span class="dt">ymin =</span> bbox[<span class="st">&quot;ymax&quot;</span>] <span class="op">-</span><span class="st"> </span>(bbox[<span class="st">&quot;ymax&quot;</span>] <span class="op">-</span><span class="st"> </span>bbox[<span class="st">&quot;ymin&quot;</span>])<span class="op">/</span><span class="dv">3</span>, </a>
<a class="sourceLine" id="cb59-8" title="8">                    <span class="dt">ymax =</span> bbox[<span class="st">&quot;ymax&quot;</span>])<span class="op">+</span></a>
<a class="sourceLine" id="cb59-9" title="9"><span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">data=</span>points, <span class="kw">aes</span>(X,Y,<span class="dt">fill=</span>n), <span class="dt">col =</span> <span class="st">&quot;grey90&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb59-10" title="10"><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">fill=</span> <span class="ot">NA</span>, <span class="dt">col =</span> <span class="dv">1</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb59-11" title="11"><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data=</span>roads, <span class="dt">size=</span><span class="fl">0.2</span>, <span class="dt">col=</span><span class="st">&quot;steelblue&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb59-12" title="12"><span class="st">  </span></a>
<a class="sourceLine" id="cb59-13" title="13"><span class="st">  </span><span class="co"># scale_colour_manual(values = &quot;steelblue&quot;, labels = &quot;roads&quot;)+</span></a>
<a class="sourceLine" id="cb59-14" title="14"><span class="st">  </span></a>
<a class="sourceLine" id="cb59-15" title="15"><span class="st">  </span><span class="kw">scale_fill_scico</span>(<span class="dt">trans =</span> <span class="st">&quot;log10&quot;</span>, <span class="dt">palette =</span> <span class="st">&quot;lajolla&quot;</span>, <span class="dt">values=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb59-16" title="16"><span class="st">  </span><span class="kw">annotation_north_arrow</span>(<span class="dt">location =</span> <span class="st">&quot;br&quot;</span>, <span class="dt">which_north =</span> <span class="st">&quot;true&quot;</span>, </a>
<a class="sourceLine" id="cb59-17" title="17">                         <span class="dt">pad_x =</span> <span class="kw">unit</span>(<span class="fl">0.1</span>, <span class="st">&quot;in&quot;</span>), <span class="dt">pad_y =</span> <span class="kw">unit</span>(<span class="fl">0.5</span>, <span class="st">&quot;in&quot;</span>),</a>
<a class="sourceLine" id="cb59-18" title="18">                         <span class="dt">style =</span> north_arrow_fancy_orienteering) <span class="op">+</span></a>
<a class="sourceLine" id="cb59-19" title="19"><span class="st">  </span><span class="kw">annotation_scale</span>(<span class="dt">location =</span> <span class="st">&quot;br&quot;</span>, <span class="dt">width_hint =</span> <span class="fl">0.4</span>, <span class="dt">text_cex =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb59-20" title="20"><span class="st">  </span></a>
<a class="sourceLine" id="cb59-21" title="21"><span class="st">  </span><span class="kw">theme_few</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb59-22" title="22"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="fl">0.9</span>,<span class="fl">0.55</span>),</a>
<a class="sourceLine" id="cb59-23" title="23">        <span class="dt">legend.background =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb59-24" title="24">        <span class="dt">legend.key =</span> <span class="kw">element_rect</span>(<span class="dt">fill=</span><span class="st">&quot;grey90&quot;</span>),</a>
<a class="sourceLine" id="cb59-25" title="25">        <span class="dt">axis.title =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb59-26" title="26">        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill=</span><span class="st">&quot;lightblue&quot;</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb59-27" title="27"><span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">expand =</span> <span class="ot">FALSE</span>, <span class="dt">xlim =</span> bbox[<span class="kw">c</span>(<span class="st">&quot;xmin&quot;</span>, <span class="st">&quot;xmax&quot;</span>)], <span class="dt">ylim =</span> bbox[<span class="kw">c</span>(<span class="st">&quot;ymin&quot;</span>, <span class="st">&quot;ymax&quot;</span>)])<span class="op">+</span></a>
<a class="sourceLine" id="cb59-28" title="28"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;checklists&quot;</span>, <span class="dt">colour=</span><span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb59-29" title="29"></a>
<a class="sourceLine" id="cb59-30" title="30"><span class="co"># save figure</span></a>
<a class="sourceLine" id="cb59-31" title="31"><span class="kw">ggsave</span>(<span class="dt">filename =</span> <span class="st">&quot;figs/fig_distRoads.png&quot;</span>, <span class="dt">device =</span> <span class="kw">png</span>())</a>
<a class="sourceLine" id="cb59-32" title="32"><span class="kw">dev.off</span>()</a></code></pre></div>
<div class="figure">
<img src="figs/fig_distRoads.png" alt="Checklist locations in the Nilgiris. Inset histogram shows checklists' distance to the nearest road, with the X-axis on a log-scale." width="1000" />
<p class="caption">
(#fig:plot_figure1)Checklist locations in the Nilgiris. Inset histogram shows checklists distance to the nearest road, with the X-axis on a log-scale.
</p>
</div>

</div>
</div>
<div id="species-observation-distributions" class="section level2">
<h2><span class="header-section-number">7.2</span> Species observation distributions</h2>
<div id="prepare-libraries-3" class="section level3">
<h3><span class="header-section-number">7.2.1</span> Prepare libraries</h3>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1"><span class="co"># load libraries</span></a>
<a class="sourceLine" id="cb60-2" title="2"><span class="kw">library</span>(data.table)</a>
<a class="sourceLine" id="cb60-3" title="3"><span class="kw">library</span>(readxl)</a>
<a class="sourceLine" id="cb60-4" title="4"><span class="kw">library</span>(magrittr)</a>
<a class="sourceLine" id="cb60-5" title="5"><span class="kw">library</span>(stringr)</a>
<a class="sourceLine" id="cb60-6" title="6"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb60-7" title="7"><span class="kw">library</span>(tidyr)</a>
<a class="sourceLine" id="cb60-8" title="8"></a>
<a class="sourceLine" id="cb60-9" title="9"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb60-10" title="10"><span class="kw">library</span>(ggthemes)</a>
<a class="sourceLine" id="cb60-11" title="11"><span class="kw">library</span>(scico)</a>
<a class="sourceLine" id="cb60-12" title="12"></a>
<a class="sourceLine" id="cb60-13" title="13"><span class="co"># round any function</span></a>
<a class="sourceLine" id="cb60-14" title="14">round_any &lt;-<span class="st"> </span><span class="cf">function</span>(x, <span class="dt">accuracy =</span> <span class="dv">20000</span>){<span class="kw">round</span>(x<span class="op">/</span>accuracy)<span class="op">*</span>accuracy}</a></code></pre></div>
</div>
<div id="read-species-of-interest" class="section level3">
<h3><span class="header-section-number">7.2.2</span> Read species of interest</h3>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1"><span class="co"># add species of interest</span></a>
<a class="sourceLine" id="cb61-2" title="2">specieslist &lt;-<span class="st"> </span><span class="kw">read_excel</span>(<span class="st">&quot;data/species_list_13_11_2019.xlsx&quot;</span>)</a>
<a class="sourceLine" id="cb61-3" title="3">speciesOfInterest &lt;-<span class="st"> </span>specieslist<span class="op">$</span>scientific_name</a></code></pre></div>
</div>
<div id="load-raw-data-for-locations" class="section level3">
<h3><span class="header-section-number">7.2.3</span> Load raw data for locations</h3>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1"><span class="co"># read in shapefile of nilgiris to subset by bounding box</span></a>
<a class="sourceLine" id="cb62-2" title="2"><span class="kw">library</span>(sf)</a>
<a class="sourceLine" id="cb62-3" title="3">wg &lt;-<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&quot;data/spatial/hillsShapefile/Nil_Ana_Pal.shp&quot;</span>); box &lt;-<span class="st"> </span><span class="kw">st_bbox</span>(wg)</a>
<a class="sourceLine" id="cb62-4" title="4"></a>
<a class="sourceLine" id="cb62-5" title="5"><span class="co"># read in data and subset</span></a>
<a class="sourceLine" id="cb62-6" title="6">ebd &lt;-<span class="st"> </span><span class="kw">fread</span>(<span class="st">&quot;ebd_Filtered_Jun2019.txt&quot;</span>)</a>
<a class="sourceLine" id="cb62-7" title="7">ebd &lt;-<span class="st"> </span>ebd[<span class="kw">between</span>(LONGITUDE, box[<span class="st">&quot;xmin&quot;</span>], box[<span class="st">&quot;xmax&quot;</span>]) <span class="op">&amp;</span><span class="st"> </span><span class="kw">between</span>(LATITUDE, box[<span class="st">&quot;ymin&quot;</span>], box[<span class="st">&quot;ymax&quot;</span>]),]</a>
<a class="sourceLine" id="cb62-8" title="8">ebd &lt;-<span class="st"> </span>ebd[<span class="kw">year</span>(<span class="st">`</span><span class="dt">OBSERVATION DATE</span><span class="st">`</span>) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">2013</span>,]</a>
<a class="sourceLine" id="cb62-9" title="9"></a>
<a class="sourceLine" id="cb62-10" title="10"><span class="co"># make new column names</span></a>
<a class="sourceLine" id="cb62-11" title="11">newNames &lt;-<span class="st"> </span><span class="kw">str_replace_all</span>(<span class="kw">colnames</span>(ebd), <span class="st">&quot; &quot;</span>, <span class="st">&quot;_&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb62-12" title="12"><span class="st">  </span><span class="kw">str_to_lower</span>()</a>
<a class="sourceLine" id="cb62-13" title="13"><span class="kw">setnames</span>(ebd, newNames)</a>
<a class="sourceLine" id="cb62-14" title="14"></a>
<a class="sourceLine" id="cb62-15" title="15"><span class="co"># keep useful columns</span></a>
<a class="sourceLine" id="cb62-16" title="16">columnsOfInterest &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;scientific_name&quot;</span>,<span class="st">&quot;observation_count&quot;</span>,<span class="st">&quot;locality&quot;</span>,<span class="st">&quot;locality_id&quot;</span>,<span class="st">&quot;locality_type&quot;</span>,<span class="st">&quot;latitude&quot;</span>,<span class="st">&quot;longitude&quot;</span>,<span class="st">&quot;observation_date&quot;</span>, <span class="st">&quot;sampling_event_identifier&quot;</span>)</a>
<a class="sourceLine" id="cb62-17" title="17">ebd &lt;-<span class="st"> </span>ebd[,..columnsOfInterest]</a></code></pre></div>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" title="1"><span class="co"># strict spatial filter and assign grid</span></a>
<a class="sourceLine" id="cb63-2" title="2">locs &lt;-<span class="st"> </span>ebd[,.(longitude, latitude)]</a>
<a class="sourceLine" id="cb63-3" title="3"></a>
<a class="sourceLine" id="cb63-4" title="4"><span class="co"># transform to UTM and get 20km boxes</span></a>
<a class="sourceLine" id="cb63-5" title="5">coords &lt;-<span class="st"> </span><span class="kw">setDF</span>(locs) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb63-6" title="6"><span class="st">  </span><span class="kw">st_as_sf</span>(<span class="dt">coords =</span> <span class="kw">c</span>(<span class="st">&quot;longitude&quot;</span>, <span class="st">&quot;latitude&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb63-7" title="7"><span class="st">  `</span><span class="dt">st_crs&lt;-</span><span class="st">`</span>(<span class="dv">4326</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb63-8" title="8"><span class="st">  </span><span class="kw">bind_cols</span>(<span class="kw">as.data.table</span>(<span class="kw">st_coordinates</span>(.))) <span class="op">%&gt;%</span><span class="st">  </span></a>
<a class="sourceLine" id="cb63-9" title="9"><span class="st">  </span><span class="kw">st_transform</span>(<span class="dv">32643</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb63-10" title="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">id =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(.))</a>
<a class="sourceLine" id="cb63-11" title="11"></a>
<a class="sourceLine" id="cb63-12" title="12"><span class="co"># convert wg to UTM for filter</span></a>
<a class="sourceLine" id="cb63-13" title="13">wg &lt;-<span class="st"> </span><span class="kw">st_transform</span>(wg, <span class="dv">32643</span>)</a>
<a class="sourceLine" id="cb63-14" title="14">coords &lt;-<span class="st"> </span>coords <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb63-15" title="15"><span class="st">  </span><span class="kw">filter</span>(id <span class="op">%in%</span><span class="st"> </span><span class="kw">unlist</span>(<span class="kw">st_contains</span>(wg, coords))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb63-16" title="16"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">longitude =</span> X, <span class="dt">latitude =</span> Y) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb63-17" title="17"><span class="st">  </span><span class="kw">bind_cols</span>(<span class="kw">as.data.table</span>(<span class="kw">st_coordinates</span>(.))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb63-18" title="18"><span class="st">  </span><span class="kw">st_drop_geometry</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb63-19" title="19"><span class="st">  </span><span class="kw">as.data.table</span>()</a>
<a class="sourceLine" id="cb63-20" title="20"></a>
<a class="sourceLine" id="cb63-21" title="21"><span class="co"># remove unneeded objs</span></a>
<a class="sourceLine" id="cb63-22" title="22"><span class="kw">rm</span>(locs); <span class="kw">gc</span>()</a>
<a class="sourceLine" id="cb63-23" title="23"></a>
<a class="sourceLine" id="cb63-24" title="24">coords &lt;-<span class="st"> </span>coords[,.N,by=.(longitude, latitude, X, Y)]</a>
<a class="sourceLine" id="cb63-25" title="25"></a>
<a class="sourceLine" id="cb63-26" title="26">ebd &lt;-<span class="st"> </span><span class="kw">merge</span>(ebd, coords, <span class="dt">all =</span> <span class="ot">FALSE</span>, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;longitude&quot;</span>, <span class="st">&quot;latitude&quot;</span>))</a>
<a class="sourceLine" id="cb63-27" title="27"></a>
<a class="sourceLine" id="cb63-28" title="28">ebd &lt;-<span class="st"> </span>ebd[(longitude <span class="op">%in%</span><span class="st"> </span>coords<span class="op">$</span>longitude) <span class="op">&amp;</span><span class="st"> </span>(latitude <span class="op">%in%</span><span class="st"> </span>coords<span class="op">$</span>latitude),]</a></code></pre></div>
</div>
<div id="get-proportional-obs-counts-in-20km-cells" class="section level3">
<h3><span class="header-section-number">7.2.4</span> Get proportional obs counts in 20km cells</h3>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" title="1"><span class="co"># round to 20km cell in UTM coords</span></a>
<a class="sourceLine" id="cb64-2" title="2">ebd[,<span class="st">`</span><span class="dt">:=</span><span class="st">`</span>(<span class="dt">X =</span> <span class="kw">round_any</span>(X), <span class="dt">Y =</span> <span class="kw">round_any</span>(Y))]</a>
<a class="sourceLine" id="cb64-3" title="3"></a>
<a class="sourceLine" id="cb64-4" title="4"><span class="co"># count checklists in cell</span></a>
<a class="sourceLine" id="cb64-5" title="5">ebd_summary &lt;-<span class="st"> </span>ebd[,nchk <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(sampling_event_identifier)), by=.(X,Y)]</a>
<a class="sourceLine" id="cb64-6" title="6"></a>
<a class="sourceLine" id="cb64-7" title="7"><span class="co"># count checklists reporting each species in cell and get proportion</span></a>
<a class="sourceLine" id="cb64-8" title="8">ebd_summary &lt;-<span class="st"> </span>ebd_summary[,.(<span class="dt">nrep =</span> <span class="kw">length</span>(<span class="kw">unique</span>(sampling_event_identifier))), by =<span class="st"> </span>.(X,Y,nchk,scientific_name)]</a>
<a class="sourceLine" id="cb64-9" title="9"></a>
<a class="sourceLine" id="cb64-10" title="10">ebd_summary[,p_rep <span class="op">:</span><span class="er">=</span><span class="st"> </span>nrep<span class="op">/</span>nchk ]</a>
<a class="sourceLine" id="cb64-11" title="11"></a>
<a class="sourceLine" id="cb64-12" title="12"><span class="co"># filter for soi</span></a>
<a class="sourceLine" id="cb64-13" title="13">ebd_summary &lt;-<span class="st"> </span>ebd_summary[scientific_name <span class="op">%in%</span><span class="st"> </span>speciesOfInterest,]</a>
<a class="sourceLine" id="cb64-14" title="14"></a>
<a class="sourceLine" id="cb64-15" title="15"><span class="co"># complete the dataframe for no reports</span></a>
<a class="sourceLine" id="cb64-16" title="16">ebd_summary &lt;-<span class="st"> </span><span class="kw">setDF</span>(ebd_summary) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb64-17" title="17"><span class="st">  </span><span class="kw">complete</span>(<span class="kw">nesting</span>(X,Y), scientific_name, <span class="dt">fill =</span> <span class="kw">list</span>(<span class="dt">p_rep =</span> <span class="dv">0</span>))</a></code></pre></div>
</div>
<div id="plot-maps" class="section level3">
<h3><span class="header-section-number">7.2.5</span> Plot maps</h3>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" title="1"><span class="co"># add land</span></a>
<a class="sourceLine" id="cb65-2" title="2"><span class="kw">library</span>(rnaturalearth)</a>
<a class="sourceLine" id="cb65-3" title="3">land &lt;-<span class="st"> </span><span class="kw">ne_countries</span>(<span class="dt">scale =</span> <span class="dv">50</span>, <span class="dt">type =</span> <span class="st">&quot;countries&quot;</span>, <span class="dt">continent =</span> <span class="st">&quot;asia&quot;</span>,</a>
<a class="sourceLine" id="cb65-4" title="4">                     <span class="dt">country =</span> <span class="st">&quot;india&quot;</span>,</a>
<a class="sourceLine" id="cb65-5" title="5">                     <span class="dt">returnclass =</span> <span class="kw">c</span>(<span class="st">&quot;sf&quot;</span>))</a>
<a class="sourceLine" id="cb65-6" title="6"></a>
<a class="sourceLine" id="cb65-7" title="7"><span class="co"># crop land</span></a>
<a class="sourceLine" id="cb65-8" title="8">land &lt;-<span class="st"> </span><span class="kw">st_transform</span>(land, <span class="dv">32643</span>)</a></code></pre></div>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" title="1"><span class="co"># make plot</span></a>
<a class="sourceLine" id="cb66-2" title="2">wg &lt;-<span class="st"> </span><span class="kw">st_transform</span>(wg, <span class="dv">32643</span>)</a>
<a class="sourceLine" id="cb66-3" title="3">bbox &lt;-<span class="st"> </span><span class="kw">st_bbox</span>(wg)</a>
<a class="sourceLine" id="cb66-4" title="4"></a>
<a class="sourceLine" id="cb66-5" title="5">plotDistributions &lt;-</a>
<a class="sourceLine" id="cb66-6" title="6"><span class="kw">ggplot</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb66-7" title="7"><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> land, <span class="dt">fill =</span> <span class="st">&quot;grey90&quot;</span>, <span class="dt">col =</span> <span class="ot">NA</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb66-8" title="8"><span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">data =</span> ebd_summary,</a>
<a class="sourceLine" id="cb66-9" title="9">            <span class="kw">aes</span>(X, Y, <span class="dt">fill =</span> p_rep), <span class="dt">lwd =</span> <span class="fl">0.5</span>, <span class="dt">col =</span> <span class="st">&quot;grey90&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb66-10" title="10"><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> wg, <span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">lwd =</span> <span class="fl">0.3</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb66-11" title="11"><span class="st">  </span></a>
<a class="sourceLine" id="cb66-12" title="12"><span class="st">  </span><span class="kw">scale_fill_scico</span>(<span class="dt">palette =</span> <span class="st">&quot;lajolla&quot;</span>, <span class="dt">direction =</span> <span class="dv">1</span>, <span class="dt">label =</span> scales<span class="op">::</span>percent)<span class="op">+</span></a>
<a class="sourceLine" id="cb66-13" title="13"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>scientific_name, <span class="dt">ncol =</span> <span class="dv">10</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb66-14" title="14"><span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">xlim =</span> bbox[<span class="kw">c</span>(<span class="st">&quot;xmin&quot;</span>, <span class="st">&quot;xmax&quot;</span>)], <span class="dt">ylim =</span> bbox[<span class="kw">c</span>(<span class="st">&quot;ymin&quot;</span>, <span class="st">&quot;ymax&quot;</span>)])<span class="op">+</span></a>
<a class="sourceLine" id="cb66-15" title="15"><span class="st">  </span><span class="kw">theme_few</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb66-16" title="16"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;right&quot;</span>, </a>
<a class="sourceLine" id="cb66-17" title="17">        <span class="dt">axis.title =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb66-18" title="18">        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>),</a>
<a class="sourceLine" id="cb66-19" title="19">        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;lightblue&quot;</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb66-20" title="20"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;prop.</span><span class="ch">\n</span><span class="st">reporting</span><span class="ch">\n</span><span class="st">checklists&quot;</span>)</a>
<a class="sourceLine" id="cb66-21" title="21">  </a>
<a class="sourceLine" id="cb66-22" title="22"><span class="co"># export data</span></a>
<a class="sourceLine" id="cb66-23" title="23"><span class="kw">ggsave</span>(plotDistributions, <span class="dt">filename =</span> <span class="st">&quot;figs/fig_species_distributions.png&quot;</span>, </a>
<a class="sourceLine" id="cb66-24" title="24">       <span class="dt">height =</span> <span class="dv">12</span>, <span class="dt">width =</span> <span class="dv">17</span>, <span class="dt">device =</span> <span class="kw">png</span>(), <span class="dt">dpi =</span> <span class="dv">300</span>); <span class="kw">dev.off</span>()</a></code></pre></div>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" title="1"><span class="co"># show exported image</span></a>
<a class="sourceLine" id="cb67-2" title="2">knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="st">&quot;figs/fig_species_distributions.png&quot;</span>)</a></code></pre></div>
<div class="figure">
<img src="figs/fig_species_distributions.png" alt="Proportion of checklists reporting a species in each grid cell (20km side) between 2013 and 2018. Checklists were filtered to be within the boundaries of the Nilgiri Hills (black outline), but rounding to 20km cells may place cells outside the boundary. Deeper shades of red indicate a higher proportion of checklists reporting a species." width="2550" />
<p class="caption">
(#fig:export_fig_obs_dist)Proportion of checklists reporting a species in each grid cell (20km side) between 2013 and 2018. Checklists were filtered to be within the boundaries of the Nilgiri Hills (black outline), but rounding to 20km cells may place cells outside the boundary. Deeper shades of red indicate a higher proportion of checklists reporting a species.
</p>
</div>

</div>
</div>
<div id="climate-in-relation-to-elevation" class="section level2">
<h2><span class="header-section-number">7.3</span> Climate in relation to elevation</h2>
<div id="prepare-libraries-4" class="section level3">
<h3><span class="header-section-number">7.3.1</span> Prepare libraries</h3>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" title="1"><span class="co"># load libs</span></a>
<a class="sourceLine" id="cb68-2" title="2"><span class="kw">library</span>(raster)</a>
<a class="sourceLine" id="cb68-3" title="3"><span class="kw">library</span>(glue)</a>
<a class="sourceLine" id="cb68-4" title="4"><span class="kw">library</span>(purrr)</a>
<a class="sourceLine" id="cb68-5" title="5"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb68-6" title="6"><span class="kw">library</span>(tidyr)</a>
<a class="sourceLine" id="cb68-7" title="7"></a>
<a class="sourceLine" id="cb68-8" title="8"><span class="kw">library</span>(scales)</a>
<a class="sourceLine" id="cb68-9" title="9"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb68-10" title="10"><span class="kw">library</span>(ggthemes)</a>
<a class="sourceLine" id="cb68-11" title="11"></a>
<a class="sourceLine" id="cb68-12" title="12"><span class="co"># get ci func</span></a>
<a class="sourceLine" id="cb68-13" title="13">ci &lt;-<span class="st"> </span><span class="cf">function</span>(x){<span class="kw">qnorm</span>(<span class="fl">0.975</span>)<span class="op">*</span><span class="kw">sd</span>(x, <span class="dt">na.rm =</span> T)<span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">length</span>(x))}</a></code></pre></div>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" title="1"><span class="co"># read landscape prepare for plotting</span></a>
<a class="sourceLine" id="cb69-2" title="2">landscape &lt;-<span class="st"> </span><span class="kw">stack</span>(<span class="st">&quot;data/spatial/landscape_resamp01km.tif&quot;</span>)</a>
<a class="sourceLine" id="cb69-3" title="3"></a>
<a class="sourceLine" id="cb69-4" title="4"><span class="co"># get proper names</span></a>
<a class="sourceLine" id="cb69-5" title="5">elev_names &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;elev&quot;</span>, <span class="st">&quot;slope&quot;</span>, <span class="st">&quot;aspect&quot;</span>)</a>
<a class="sourceLine" id="cb69-6" title="6">evi_names &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;evi_01&quot;</span>, <span class="st">&quot;evi_07&quot;</span>, <span class="st">&quot;evi_10&quot;</span>)</a>
<a class="sourceLine" id="cb69-7" title="7">chelsa_names &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;chelsa_bio10_04&quot;</span>, <span class="st">&quot;chelsa_bio10_17&quot;</span>, <span class="st">&quot;chelsa_bio10_18&quot;</span>,</a>
<a class="sourceLine" id="cb69-8" title="8">                  <span class="st">&quot;chelsa_prec&quot;</span>, <span class="st">&quot;chelsa_temp&quot;</span>)</a>
<a class="sourceLine" id="cb69-9" title="9"></a>
<a class="sourceLine" id="cb69-10" title="10"><span class="kw">names</span>(landscape) &lt;-<span class="st"> </span><span class="kw">as.character</span>(<span class="kw">glue</span>(<span class="st">&#39;{c(elev_names, evi_names, chelsa_names, &quot;landcover&quot;)}&#39;</span>))</a></code></pre></div>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1"><span class="co"># make duplicate stack</span></a>
<a class="sourceLine" id="cb70-2" title="2">land_data &lt;-<span class="st"> </span>landscape[[<span class="kw">c</span>(<span class="st">&quot;elev&quot;</span>, chelsa_names)]]</a>
<a class="sourceLine" id="cb70-3" title="3"></a>
<a class="sourceLine" id="cb70-4" title="4"><span class="co"># convert to list</span></a>
<a class="sourceLine" id="cb70-5" title="5">land_data &lt;-<span class="st"> </span><span class="kw">as.list</span>(land_data)</a>
<a class="sourceLine" id="cb70-6" title="6"></a>
<a class="sourceLine" id="cb70-7" title="7"><span class="co"># map get values over the stack</span></a>
<a class="sourceLine" id="cb70-8" title="8">land_data &lt;-<span class="st"> </span><span class="kw">map</span>(land_data, getValues)</a>
<a class="sourceLine" id="cb70-9" title="9"><span class="kw">names</span>(land_data) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;elev&quot;</span>, chelsa_names)</a>
<a class="sourceLine" id="cb70-10" title="10"></a>
<a class="sourceLine" id="cb70-11" title="11"><span class="co"># conver to dataframe and round to 100m</span></a>
<a class="sourceLine" id="cb70-12" title="12">land_data &lt;-<span class="st"> </span><span class="kw">bind_cols</span>(land_data)</a>
<a class="sourceLine" id="cb70-13" title="13">land_data &lt;-<span class="st"> </span><span class="kw">drop_na</span>(land_data) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb70-14" title="14"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">elev_round  =</span> plyr<span class="op">::</span><span class="kw">round_any</span>(elev, <span class="dv">200</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb70-15" title="15"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>elev) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb70-16" title="16"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">contains</span>(<span class="st">&quot;chelsa&quot;</span>),</a>
<a class="sourceLine" id="cb70-17" title="17">               <span class="dt">names_to =</span> <span class="st">&quot;clim_var&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb70-18" title="18"><span class="st">  </span><span class="kw">group_by</span>(elev_round, clim_var) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb70-19" title="19"><span class="st">  </span><span class="kw">summarise_all</span>(<span class="dt">.funs =</span> <span class="kw">list</span>(<span class="op">~</span><span class="kw">mean</span>(.), <span class="op">~</span><span class="kw">ci</span>(.)))</a></code></pre></div>
</div>
<div id="plot-climatic-variables-over-elevation" class="section level3">
<h3><span class="header-section-number">7.3.2</span> Plot climatic variables over elevation</h3>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" title="1"><span class="co"># plot in facets</span></a>
<a class="sourceLine" id="cb71-2" title="2"></a>
<a class="sourceLine" id="cb71-3" title="3">fig_climate_elev &lt;-<span class="st"> </span><span class="kw">ggplot</span>(land_data)<span class="op">+</span></a>
<a class="sourceLine" id="cb71-4" title="4"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x =</span> elev_round, <span class="dt">y =</span> mean),</a>
<a class="sourceLine" id="cb71-5" title="5">            <span class="dt">size =</span> <span class="fl">0.2</span>, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb71-6" title="6"><span class="st">  </span><span class="kw">geom_pointrange</span>(<span class="kw">aes</span>(<span class="dt">x =</span> elev_round, <span class="dt">y =</span> mean, <span class="dt">ymin=</span>mean<span class="op">-</span>ci, <span class="dt">ymax=</span>mean<span class="op">+</span>ci),</a>
<a class="sourceLine" id="cb71-7" title="7">                  <span class="dt">size =</span> <span class="fl">0.3</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb71-8" title="8"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">labels =</span> scales<span class="op">::</span>comma)<span class="op">+</span></a>
<a class="sourceLine" id="cb71-9" title="9"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels =</span> scales<span class="op">::</span>comma)<span class="op">+</span></a>
<a class="sourceLine" id="cb71-10" title="10"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>clim_var, <span class="dt">scales =</span> <span class="st">&quot;free_y&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb71-11" title="11"><span class="st">  </span><span class="kw">theme_few</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb71-12" title="12"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;elevation (m)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;CHELSA variable value&quot;</span>)</a>
<a class="sourceLine" id="cb71-13" title="13"></a>
<a class="sourceLine" id="cb71-14" title="14"><span class="co"># save as png</span></a>
<a class="sourceLine" id="cb71-15" title="15"><span class="kw">ggsave</span>(fig_climate_elev, <span class="dt">filename =</span> <span class="st">&quot;figs/fig_climate_elev.png&quot;</span>, </a>
<a class="sourceLine" id="cb71-16" title="16">       <span class="dt">height =</span> <span class="dv">4</span>, <span class="dt">width =</span> <span class="dv">6</span>, <span class="dt">device =</span> <span class="kw">png</span>(), <span class="dt">dpi =</span> <span class="dv">300</span>); <span class="kw">dev.off</span>()</a></code></pre></div>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" title="1"><span class="co"># show exported image</span></a>
<a class="sourceLine" id="cb72-2" title="2">knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="st">&quot;figs/fig_climate_elev.png&quot;</span>)</a></code></pre></div>
<div class="figure">
<img src="figs/fig_climate_elev.png" alt="CHELSA climatic variables as a function of elevation, in increments of 200m. Points represent means, while vertical lines show 95% confidence intervals." width="900" />
<p class="caption">
(#fig:export_fig_clim_elev)CHELSA climatic variables as a function of elevation, in increments of 200m. Points represent means, while vertical lines show 95% confidence intervals.
</p>
</div>
</div>
</div>
<div id="landcover-in-relation-to-elevation" class="section level2">
<h2><span class="header-section-number">7.4</span> Landcover in relation to elevation</h2>
<div id="get-data-from-landscape-rasters" class="section level3">
<h3><span class="header-section-number">7.4.1</span> Get data from landscape rasters</h3>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" title="1"><span class="co"># get data from landscape rasters</span></a>
<a class="sourceLine" id="cb73-2" title="2">lc_elev &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">elev =</span> <span class="kw">getValues</span>(landscape[[<span class="st">&quot;elev&quot;</span>]]),</a>
<a class="sourceLine" id="cb73-3" title="3">                  <span class="dt">landcover =</span> <span class="kw">getValues</span>(landscape[[<span class="st">&quot;landcover&quot;</span>]]))</a>
<a class="sourceLine" id="cb73-4" title="4"><span class="co"># process data for proportions</span></a>
<a class="sourceLine" id="cb73-5" title="5">lc_elev &lt;-<span class="st"> </span>lc_elev <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb73-6" title="6"><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(landcover), landcover <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb73-7" title="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">elev =</span> plyr<span class="op">::</span><span class="kw">round_any</span>(elev, <span class="dv">100</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb73-8" title="8"><span class="st">  </span><span class="kw">count</span>(elev, landcover) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb73-9" title="9"><span class="st">  </span><span class="kw">group_by</span>(elev) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb73-10" title="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prop =</span> n<span class="op">/</span><span class="kw">sum</span>(n))</a></code></pre></div>
</div>
<div id="plot-proportional-landcover-in-elevation" class="section level3">
<h3><span class="header-section-number">7.4.2</span> Plot proportional landcover in elevation</h3>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1"><span class="co"># plot figure as tilemap</span></a>
<a class="sourceLine" id="cb74-2" title="2">fig_lc_elev &lt;-<span class="st"> </span><span class="kw">ggplot</span>(lc_elev)<span class="op">+</span></a>
<a class="sourceLine" id="cb74-3" title="3"><span class="st">  </span><span class="kw">geom_tile</span>(<span class="kw">aes</span>(<span class="dt">x=</span>elev, <span class="dt">y=</span><span class="kw">factor</span>(landcover), </a>
<a class="sourceLine" id="cb74-4" title="4">                <span class="dt">fill=</span>prop), </a>
<a class="sourceLine" id="cb74-5" title="5">            <span class="dt">col=</span><span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="fl">0.6</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb74-6" title="6"><span class="st">  </span><span class="kw">scale_fill_scico</span>(<span class="dt">palette =</span> <span class="st">&quot;bilbao&quot;</span>, <span class="dt">begin =</span> <span class="fl">0.0</span>, <span class="dt">end =</span> <span class="fl">1.0</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb74-7" title="7"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">2500</span>, <span class="dv">500</span>), <span class="dt">labels =</span> comma)<span class="op">+</span></a>
<a class="sourceLine" id="cb74-8" title="8"><span class="st">  </span><span class="kw">scale_alpha_continuous</span>(<span class="dt">range =</span> <span class="kw">c</span>(<span class="fl">0.3</span>, <span class="dv">1</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb74-9" title="9"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;elevation (m)&quot;</span>, </a>
<a class="sourceLine" id="cb74-10" title="10">       <span class="dt">y =</span> <span class="st">&quot;landcover&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb74-11" title="11"><span class="st">  </span><span class="kw">theme_few</span>()</a>
<a class="sourceLine" id="cb74-12" title="12"></a>
<a class="sourceLine" id="cb74-13" title="13"><span class="co"># export figure</span></a>
<a class="sourceLine" id="cb74-14" title="14"><span class="kw">ggsave</span>(fig_lc_elev, <span class="dt">filename =</span> <span class="st">&quot;figs/fig_lc_elev.png&quot;</span>, </a>
<a class="sourceLine" id="cb74-15" title="15">       <span class="dt">height =</span> <span class="dv">3</span>, <span class="dt">width =</span> <span class="dv">6</span>, <span class="dt">device =</span> <span class="kw">png</span>(), <span class="dt">dpi =</span> <span class="dv">300</span>); <span class="kw">dev.off</span>()</a></code></pre></div>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" title="1"><span class="co"># show exported image</span></a>
<a class="sourceLine" id="cb75-2" title="2">knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="st">&quot;figs/fig_lc_elev.png&quot;</span>)</a></code></pre></div>
<div class="figure">
<img src="figs/fig_lc_elev.png" alt="Proportional landcover (low = white, high = dark red), as a function of elevation in the study site. Data represent elevation in increments of 100m." width="900" />
<p class="caption">
(#fig:show_fig_lc_elev)Proportional landcover (low = white, high = dark red), as a function of elevation in the study site. Data represent elevation in increments of 100m.
</p>
</div>

</div>
</div>
<div id="climate-in-relation-to-landcover" class="section level2">
<h2><span class="header-section-number">7.5</span> Climate in relation to landcover</h2>
<div id="prepare-libraries-5" class="section level3">
<h3><span class="header-section-number">7.5.1</span> Prepare libraries</h3>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" title="1"><span class="co"># load libs</span></a>
<a class="sourceLine" id="cb76-2" title="2"><span class="kw">library</span>(raster)</a>
<a class="sourceLine" id="cb76-3" title="3"><span class="kw">library</span>(glue)</a>
<a class="sourceLine" id="cb76-4" title="4"><span class="kw">library</span>(purrr)</a>
<a class="sourceLine" id="cb76-5" title="5"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb76-6" title="6"><span class="kw">library</span>(tidyr)</a>
<a class="sourceLine" id="cb76-7" title="7"></a>
<a class="sourceLine" id="cb76-8" title="8"><span class="co"># plotting options</span></a>
<a class="sourceLine" id="cb76-9" title="9"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb76-10" title="10"><span class="kw">library</span>(ggthemes)</a>
<a class="sourceLine" id="cb76-11" title="11"><span class="kw">library</span>(scico)</a>
<a class="sourceLine" id="cb76-12" title="12"></a>
<a class="sourceLine" id="cb76-13" title="13"><span class="co"># get ci func</span></a>
<a class="sourceLine" id="cb76-14" title="14">ci &lt;-<span class="st"> </span><span class="cf">function</span>(x){<span class="kw">qnorm</span>(<span class="fl">0.975</span>)<span class="op">*</span><span class="kw">sd</span>(x, <span class="dt">na.rm =</span> T)<span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">length</span>(x))}</a></code></pre></div>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" title="1"><span class="co"># read landscape prepare for plotting</span></a>
<a class="sourceLine" id="cb77-2" title="2">landscape &lt;-<span class="st"> </span><span class="kw">stack</span>(<span class="st">&quot;data/spatial/landscape_resamp01km.tif&quot;</span>)</a>
<a class="sourceLine" id="cb77-3" title="3"></a>
<a class="sourceLine" id="cb77-4" title="4"><span class="co"># get proper names</span></a>
<a class="sourceLine" id="cb77-5" title="5">elev_names &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;elev&quot;</span>, <span class="st">&quot;slope&quot;</span>, <span class="st">&quot;aspect&quot;</span>)</a>
<a class="sourceLine" id="cb77-6" title="6">chelsa_names &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;chelsa_bio10_04&quot;</span>, <span class="st">&quot;chelsa_bio10_17&quot;</span>, <span class="st">&quot;chelsa_bio10_18&quot;</span>,</a>
<a class="sourceLine" id="cb77-7" title="7">                  <span class="st">&quot;chelsa_prec&quot;</span>, <span class="st">&quot;chelsa_temp&quot;</span>)</a>
<a class="sourceLine" id="cb77-8" title="8"></a>
<a class="sourceLine" id="cb77-9" title="9"><span class="kw">names</span>(landscape) &lt;-<span class="st"> </span><span class="kw">as.character</span>(<span class="kw">glue</span>(<span class="st">&#39;{c(elev_names, chelsa_names, &quot;landcover&quot;)}&#39;</span>))</a></code></pre></div>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" title="1"><span class="co"># make duplicate stack</span></a>
<a class="sourceLine" id="cb78-2" title="2">land_data &lt;-<span class="st"> </span>landscape[[<span class="kw">c</span>(<span class="st">&quot;landcover&quot;</span>, chelsa_names)]]</a>
<a class="sourceLine" id="cb78-3" title="3"></a>
<a class="sourceLine" id="cb78-4" title="4"><span class="co"># convert to list</span></a>
<a class="sourceLine" id="cb78-5" title="5">land_data &lt;-<span class="st"> </span><span class="kw">as.list</span>(land_data)</a>
<a class="sourceLine" id="cb78-6" title="6"></a>
<a class="sourceLine" id="cb78-7" title="7"><span class="co"># map get values over the stack</span></a>
<a class="sourceLine" id="cb78-8" title="8">land_data &lt;-<span class="st"> </span>purrr<span class="op">::</span><span class="kw">map</span>(land_data, raster<span class="op">::</span>getValues)</a>
<a class="sourceLine" id="cb78-9" title="9"><span class="kw">names</span>(land_data) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;landcover&quot;</span>, chelsa_names)</a>
<a class="sourceLine" id="cb78-10" title="10"></a>
<a class="sourceLine" id="cb78-11" title="11"><span class="co"># conver to dataframe and round to 100m</span></a>
<a class="sourceLine" id="cb78-12" title="12">land_data &lt;-<span class="st"> </span><span class="kw">bind_cols</span>(land_data)</a>
<a class="sourceLine" id="cb78-13" title="13">land_data &lt;-<span class="st"> </span><span class="kw">drop_na</span>(land_data) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb78-14" title="14"><span class="st">  </span><span class="kw">filter</span>(landcover <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb78-15" title="15"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">contains</span>(<span class="st">&quot;chelsa&quot;</span>),</a>
<a class="sourceLine" id="cb78-16" title="16">               <span class="dt">names_to =</span> <span class="st">&quot;clim_var&quot;</span>) <span class="co">#%&gt;% </span></a>
<a class="sourceLine" id="cb78-17" title="17"><span class="co"># group_by(landcover, clim_var) %&gt;% </span></a>
<a class="sourceLine" id="cb78-18" title="18"><span class="co"># summarise_all(.funs = list(~mean(.), ~ci(.)))</span></a></code></pre></div>
</div>
<div id="plot-climatic-variables-over-landcover" class="section level3">
<h3><span class="header-section-number">7.5.2</span> Plot climatic variables over landcover</h3>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" title="1"><span class="co"># plot in facets</span></a>
<a class="sourceLine" id="cb79-2" title="2"></a>
<a class="sourceLine" id="cb79-3" title="3">fig_climate_lc &lt;-<span class="st"> </span><span class="kw">ggplot</span>(land_data)<span class="op">+</span></a>
<a class="sourceLine" id="cb79-4" title="4"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="kw">aes</span>(<span class="dt">x =</span> landcover<span class="fl">-0.25</span>, <span class="dt">y=</span>value,</a>
<a class="sourceLine" id="cb79-5" title="5">                  <span class="dt">col =</span> <span class="kw">factor</span>(landcover)),</a>
<a class="sourceLine" id="cb79-6" title="6">              <span class="dt">width =</span> <span class="fl">0.2</span>,</a>
<a class="sourceLine" id="cb79-7" title="7">              <span class="dt">size =</span> <span class="fl">0.1</span>, <span class="dt">alpha =</span> <span class="fl">0.1</span>, <span class="dt">shape =</span> <span class="dv">4</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb79-8" title="8"><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> landcover<span class="fl">+0.25</span>, <span class="dt">y =</span> value, <span class="dt">group =</span> landcover),</a>
<a class="sourceLine" id="cb79-9" title="9">               <span class="dt">width =</span> <span class="fl">0.2</span>,</a>
<a class="sourceLine" id="cb79-10" title="10">               <span class="dt">outlier.size =</span> <span class="fl">0.2</span>, <span class="dt">alpha =</span> <span class="fl">0.3</span>, <span class="dt">fill =</span> <span class="ot">NA</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb79-11" title="11"><span class="st">  </span><span class="kw">scale_colour_scico_d</span>(<span class="dt">begin=</span><span class="fl">0.2</span>, <span class="dt">end=</span><span class="fl">0.8</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb79-12" title="12"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels =</span> scales<span class="op">::</span>comma)<span class="op">+</span></a>
<a class="sourceLine" id="cb79-13" title="13"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb79-14" title="14"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>clim_var, <span class="dt">scales =</span> <span class="st">&quot;free_y&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb79-15" title="15"><span class="st">  </span><span class="kw">theme_few</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb79-16" title="16"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb79-17" title="17"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;landcover class&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;CHELSA variable value&quot;</span>)</a>
<a class="sourceLine" id="cb79-18" title="18"></a>
<a class="sourceLine" id="cb79-19" title="19"><span class="co"># save as png</span></a>
<a class="sourceLine" id="cb79-20" title="20"><span class="kw">ggsave</span>(fig_climate_lc, <span class="dt">filename =</span> <span class="st">&quot;figs/fig_climate_landcover.png&quot;</span>, </a>
<a class="sourceLine" id="cb79-21" title="21">       <span class="dt">height =</span> <span class="dv">5</span>, <span class="dt">width =</span> <span class="dv">8</span>, <span class="dt">device =</span> <span class="kw">png</span>(), <span class="dt">dpi =</span> <span class="dv">300</span>); <span class="kw">dev.off</span>()</a></code></pre></div>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" title="1"><span class="co"># show exported image</span></a>
<a class="sourceLine" id="cb80-2" title="2">knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="st">&quot;figs/fig_climate_landcover.png&quot;</span>)</a></code></pre></div>
<div class="figure">
<img src="figs/fig_climate_landcover.png" alt="CHELSA climatic variables as a function of landcover class. Grey points in the background represent raw data." width="1200" />
<p class="caption">
(#fig:export_fig_clim_lc)CHELSA climatic variables as a function of landcover class. Grey points in the background represent raw data.
</p>
</div>

</div>
</div>
<div id="obsever-expertise-in-time-and-space" class="section level2">
<h2><span class="header-section-number">7.6</span> Obsever expertise in time and space</h2>
<div id="prepare-libraries-6" class="section level3">
<h3><span class="header-section-number">7.6.1</span> Prepare libraries</h3>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" title="1"><span class="co"># load libs</span></a>
<a class="sourceLine" id="cb81-2" title="2"><span class="kw">library</span>(raster)</a>
<a class="sourceLine" id="cb81-3" title="3"><span class="kw">library</span>(glue)</a>
<a class="sourceLine" id="cb81-4" title="4"><span class="kw">library</span>(purrr)</a>
<a class="sourceLine" id="cb81-5" title="5"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb81-6" title="6"><span class="kw">library</span>(tidyr)</a>
<a class="sourceLine" id="cb81-7" title="7"><span class="kw">library</span>(readr)</a>
<a class="sourceLine" id="cb81-8" title="8"><span class="kw">library</span>(scales)</a>
<a class="sourceLine" id="cb81-9" title="9"></a>
<a class="sourceLine" id="cb81-10" title="10"><span class="co"># plotting libs</span></a>
<a class="sourceLine" id="cb81-11" title="11"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb81-12" title="12"><span class="kw">library</span>(ggthemes)</a>
<a class="sourceLine" id="cb81-13" title="13"><span class="kw">library</span>(pals)</a>
<a class="sourceLine" id="cb81-14" title="14"></a>
<a class="sourceLine" id="cb81-15" title="15"><span class="co"># get ci func</span></a>
<a class="sourceLine" id="cb81-16" title="16">ci &lt;-<span class="st"> </span><span class="cf">function</span>(x){<span class="kw">qnorm</span>(<span class="fl">0.975</span>)<span class="op">*</span><span class="kw">sd</span>(x, <span class="dt">na.rm =</span> T)<span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">length</span>(x))}</a></code></pre></div>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" title="1"><span class="co"># read in scores and checklist data and link</span></a>
<a class="sourceLine" id="cb82-2" title="2">scores &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/dataObsExpScore.csv&quot;</span>)</a>
<a class="sourceLine" id="cb82-3" title="3">data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/eBirdChecklistVars.csv&quot;</span>)</a>
<a class="sourceLine" id="cb82-4" title="4"></a>
<a class="sourceLine" id="cb82-5" title="5">data &lt;-<span class="st"> </span><span class="kw">left_join</span>(data, scores, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;observer_id&quot;</span> =<span class="st"> &quot;observer&quot;</span>))</a>
<a class="sourceLine" id="cb82-6" title="6">data &lt;-<span class="st"> </span><span class="kw">select</span>(data, score, nSp, totSoiSeen, landcover, year) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb82-7" title="7"><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(score))</a></code></pre></div>
</div>
<div id="species-seen-in-relation-to-osberver-expertise" class="section level3">
<h3><span class="header-section-number">7.6.2</span> Species seen in relation to osberver expertise</h3>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" title="1"><span class="co"># summarise data by rounded score and year</span></a>
<a class="sourceLine" id="cb83-2" title="2">data_summary01 &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb83-3" title="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">score =</span> plyr<span class="op">::</span><span class="kw">round_any</span>(score, <span class="fl">0.2</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb83-4" title="4"><span class="st">  </span><span class="kw">select</span>(score, year, nSp, totSoiSeen) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb83-5" title="5"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(<span class="st">&quot;nSp&quot;</span>, <span class="st">&quot;totSoiSeen&quot;</span>),</a>
<a class="sourceLine" id="cb83-6" title="6">               <span class="dt">names_to =</span> <span class="st">&quot;variable&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;value&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb83-7" title="7"><span class="st">  </span><span class="kw">group_by</span>(score, year, variable) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb83-8" title="8"><span class="st">  </span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(value), <span class="kw">list</span>(<span class="op">~</span><span class="kw">mean</span>(.), <span class="op">~</span><span class="kw">ci</span>(.)))</a>
<a class="sourceLine" id="cb83-9" title="9"></a>
<a class="sourceLine" id="cb83-10" title="10"><span class="co"># make plot and export</span></a>
<a class="sourceLine" id="cb83-11" title="11">fig_nsp_score &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb83-12" title="12"><span class="st">  </span><span class="kw">ggplot</span>(data_summary01)<span class="op">+</span></a>
<a class="sourceLine" id="cb83-13" title="13"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">data =</span> data, <span class="kw">aes</span>(<span class="dt">x =</span> score, <span class="dt">y =</span> nSp), </a>
<a class="sourceLine" id="cb83-14" title="14">             <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.2</span>, <span class="dt">size =</span> <span class="fl">0.1</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb83-15" title="15"><span class="st">  </span><span class="kw">geom_pointrange</span>(<span class="kw">aes</span>(<span class="dt">x =</span> score, <span class="dt">y =</span> mean, </a>
<a class="sourceLine" id="cb83-16" title="16">                      <span class="dt">ymin=</span>mean<span class="op">-</span>ci, <span class="dt">ymax=</span>mean<span class="op">+</span>ci,</a>
<a class="sourceLine" id="cb83-17" title="17">                      <span class="dt">col =</span> <span class="kw">as.factor</span>(variable)),</a>
<a class="sourceLine" id="cb83-18" title="18">                  <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="dt">width =</span> <span class="fl">0.05</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb83-19" title="19"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>year)<span class="op">+</span></a>
<a class="sourceLine" id="cb83-20" title="20"><span class="st">  </span><span class="kw">scale_y_log10</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb83-21" title="21"><span class="co">#  coord_cartesian(ylim=c(0,50))+</span></a>
<a class="sourceLine" id="cb83-22" title="22"><span class="st">  </span><span class="kw">scale_colour_scico_d</span>(<span class="dt">palette =</span> <span class="st">&quot;cork&quot;</span>, <span class="dt">begin =</span> <span class="fl">0.2</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb83-23" title="23"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;expertise score&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;species reported&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb83-24" title="24"><span class="st">  </span><span class="kw">theme_few</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb83-25" title="25"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</a>
<a class="sourceLine" id="cb83-26" title="26"></a>
<a class="sourceLine" id="cb83-27" title="27"><span class="co"># export figure</span></a>
<a class="sourceLine" id="cb83-28" title="28"><span class="kw">ggsave</span>(<span class="dt">filename =</span> <span class="st">&quot;figs/fig_nsp_score.png&quot;</span>, <span class="dt">width =</span> <span class="dv">8</span>, <span class="dt">height =</span> <span class="dv">6</span>, <span class="dt">device =</span> <span class="kw">png</span>(), <span class="dt">dpi =</span> <span class="dv">300</span>); <span class="kw">dev.off</span>()</a></code></pre></div>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1"><span class="co"># show exported image</span></a>
<a class="sourceLine" id="cb84-2" title="2">knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="st">&quot;figs/fig_nsp_score.png&quot;</span>)</a></code></pre></div>
<div class="figure">
<img src="figs/fig_nsp_score.png" alt="Total number of species (blue) and species of interest to this study (green) reported in checklists from the study area over the years 2013 -- 2018, as a function of the expertise score of the reporting observer. Points represent means, with bars showing the 95% confidence intervals; data shown are for expertise scores rounded to multiples of 0.2, and the y-axis is on a log scale. Raw data are shown in the background (grey points)." width="1200" />
<p class="caption">
(#fig:show_fig_nsp_score)Total number of species (blue) and species of interest to this study (green) reported in checklists from the study area over the years 2013  2018, as a function of the expertise score of the reporting observer. Points represent means, with bars showing the 95% confidence intervals; data shown are for expertise scores rounded to multiples of 0.2, and the y-axis is on a log scale. Raw data are shown in the background (grey points).
</p>
</div>
</div>
<div id="expertise-in-relation-to-landcover" class="section level3">
<h3><span class="header-section-number">7.6.3</span> Expertise in relation to landcover</h3>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" title="1"><span class="co"># plot histograms of expertise scores in different landcover classes</span></a>
<a class="sourceLine" id="cb85-2" title="2">data &lt;-<span class="st"> </span><span class="kw">filter</span>(data, <span class="op">!</span><span class="kw">is.na</span>(landcover))</a>
<a class="sourceLine" id="cb85-3" title="3"></a>
<a class="sourceLine" id="cb85-4" title="4"><span class="co"># make plot</span></a>
<a class="sourceLine" id="cb85-5" title="5">fig_exp_lc &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data)<span class="op">+</span></a>
<a class="sourceLine" id="cb85-6" title="6"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x =</span> score), <span class="dt">fill =</span> <span class="st">&quot;steelblue&quot;</span>, <span class="dt">bins =</span> <span class="dv">20</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb85-7" title="7"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>landcover, <span class="dt">scales =</span> <span class="st">&quot;free_y&quot;</span>, <span class="dt">labeller =</span> label_both, <span class="dt">nrow =</span> <span class="dv">2</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb85-8" title="8"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels =</span> comma)<span class="op">+</span></a>
<a class="sourceLine" id="cb85-9" title="9"><span class="st">  </span><span class="kw">theme_few</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb85-10" title="10"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb85-11" title="11"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;expertise score&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;count&quot;</span>)</a>
<a class="sourceLine" id="cb85-12" title="12"></a>
<a class="sourceLine" id="cb85-13" title="13"><span class="co"># export figure</span></a>
<a class="sourceLine" id="cb85-14" title="14"></a>
<a class="sourceLine" id="cb85-15" title="15"><span class="kw">ggsave</span>(<span class="dt">filename =</span> <span class="st">&quot;figs/fig_exp_lc.png&quot;</span>, <span class="dt">width =</span> <span class="dv">8</span>, <span class="dt">height =</span> <span class="dv">4</span>, <span class="dt">device =</span> <span class="kw">png</span>(), <span class="dt">dpi =</span> <span class="dv">300</span>); <span class="kw">dev.off</span>()</a></code></pre></div>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" title="1"><span class="co"># show exported image</span></a>
<a class="sourceLine" id="cb86-2" title="2">knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="st">&quot;figs/fig_exp_lc.png&quot;</span>)</a></code></pre></div>
<div class="figure">
<img src="figs/fig_exp_lc.png" alt="Distribution of expertise scores in the seven landcover classes present in the study site." width="1200" />
<p class="caption">
(#fig:show_fig_exp_lc)Distribution of expertise scores in the seven landcover classes present in the study site.
</p>
</div>

</div>
</div>
<div id="spatial-autocorrelation-in-climatic-predictors" class="section level2">
<h2><span class="header-section-number">7.7</span> Spatial autocorrelation in climatic predictors</h2>
<div id="load-libs-and-prep-data" class="section level3">
<h3><span class="header-section-number">7.7.1</span> Load libs and prep data</h3>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" title="1"><span class="co"># load libs</span></a>
<a class="sourceLine" id="cb87-2" title="2"><span class="kw">library</span>(raster)</a>
<a class="sourceLine" id="cb87-3" title="3"><span class="kw">library</span>(gstat)</a>
<a class="sourceLine" id="cb87-4" title="4"><span class="kw">library</span>(stars)</a>
<a class="sourceLine" id="cb87-5" title="5"><span class="kw">library</span>(purrr)</a>
<a class="sourceLine" id="cb87-6" title="6"><span class="kw">library</span>(tibble)</a>
<a class="sourceLine" id="cb87-7" title="7"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb87-8" title="8"><span class="kw">library</span>(tidyr)</a>
<a class="sourceLine" id="cb87-9" title="9"></a>
<a class="sourceLine" id="cb87-10" title="10"><span class="co"># plot libs</span></a>
<a class="sourceLine" id="cb87-11" title="11"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb87-12" title="12"><span class="kw">library</span>(ggthemes)</a>
<a class="sourceLine" id="cb87-13" title="13"><span class="kw">library</span>(scico)</a>
<a class="sourceLine" id="cb87-14" title="14"><span class="kw">library</span>(gridExtra)</a>
<a class="sourceLine" id="cb87-15" title="15"><span class="kw">library</span>(cowplot)</a>
<a class="sourceLine" id="cb87-16" title="16"><span class="kw">library</span>(ggspatial)</a>
<a class="sourceLine" id="cb87-17" title="17"></a>
<a class="sourceLine" id="cb87-18" title="18"><span class="co">#&#39;make custom functiont to convert matrix to df</span></a>
<a class="sourceLine" id="cb87-19" title="19">raster_to_df &lt;-<span class="st"> </span><span class="cf">function</span>(inp) {</a>
<a class="sourceLine" id="cb87-20" title="20">  </a>
<a class="sourceLine" id="cb87-21" title="21">  <span class="co"># assert is a raster obj</span></a>
<a class="sourceLine" id="cb87-22" title="22">  assertthat<span class="op">::</span><span class="kw">assert_that</span>(<span class="st">&quot;RasterLayer&quot;</span> <span class="op">%in%</span><span class="st"> </span><span class="kw">class</span>(inp),</a>
<a class="sourceLine" id="cb87-23" title="23">                          <span class="dt">msg =</span> <span class="st">&quot;input is not a raster&quot;</span>)</a>
<a class="sourceLine" id="cb87-24" title="24">  </a>
<a class="sourceLine" id="cb87-25" title="25">  coords &lt;-<span class="st"> </span><span class="kw">coordinates</span>(inp)</a>
<a class="sourceLine" id="cb87-26" title="26">  vals &lt;-<span class="st"> </span><span class="kw">getValues</span>(inp)</a>
<a class="sourceLine" id="cb87-27" title="27">  </a>
<a class="sourceLine" id="cb87-28" title="28">  data &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x =</span> coords[,<span class="dv">1</span>], <span class="dt">y =</span> coords[,<span class="dv">2</span>], <span class="dt">value =</span> vals)</a>
<a class="sourceLine" id="cb87-29" title="29">  </a>
<a class="sourceLine" id="cb87-30" title="30">  <span class="kw">return</span>(data)</a>
<a class="sourceLine" id="cb87-31" title="31">}</a></code></pre></div>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" title="1"><span class="co"># list landscape covariate stacks</span></a>
<a class="sourceLine" id="cb88-2" title="2">landscape_files &lt;-<span class="st"> &quot;data/spatial/landscape_resamp01km.tif&quot;</span></a>
<a class="sourceLine" id="cb88-3" title="3">landscape_data &lt;-<span class="st"> </span><span class="kw">stack</span>(landscape_files)</a>
<a class="sourceLine" id="cb88-4" title="4"></a>
<a class="sourceLine" id="cb88-5" title="5"><span class="co"># get proper names</span></a>
<a class="sourceLine" id="cb88-6" title="6">{</a>
<a class="sourceLine" id="cb88-7" title="7">  elev_names &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;elev&quot;</span>, <span class="st">&quot;slope&quot;</span>, <span class="st">&quot;aspect&quot;</span>)</a>
<a class="sourceLine" id="cb88-8" title="8">  chelsa_names &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;chelsa_bio10_04&quot;</span>, <span class="st">&quot;chelsa_bio10_17&quot;</span>, <span class="st">&quot;chelsa_bio10_18&quot;</span>,<span class="st">&quot;chelsa_prec&quot;</span>, <span class="st">&quot;chelsa_temp&quot;</span>)</a>
<a class="sourceLine" id="cb88-9" title="9">  <span class="kw">names</span>(landscape_data) &lt;-<span class="st"> </span><span class="kw">as.character</span>(<span class="kw">glue</span>(<span class="st">&#39;{c(elev_names, chelsa_names, &quot;landcover&quot;)}&#39;</span>))</a>
<a class="sourceLine" id="cb88-10" title="10">}</a>
<a class="sourceLine" id="cb88-11" title="11"></a>
<a class="sourceLine" id="cb88-12" title="12"><span class="co"># get chelsa rasters</span></a>
<a class="sourceLine" id="cb88-13" title="13">chelsa &lt;-<span class="st"> </span>landscape_data[[chelsa_names]]</a>
<a class="sourceLine" id="cb88-14" title="14">chelsa &lt;-<span class="st"> </span>purrr<span class="op">::</span><span class="kw">map</span>(<span class="kw">as.list</span>(chelsa), raster_to_df)</a></code></pre></div>
</div>
<div id="calculate-variograms" class="section level3">
<h3><span class="header-section-number">7.7.2</span> Calculate variograms</h3>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" title="1"><span class="co"># prep variograms</span></a>
<a class="sourceLine" id="cb89-2" title="2">vgrams &lt;-<span class="st"> </span>purrr<span class="op">::</span><span class="kw">map</span>(chelsa, <span class="cf">function</span>(z){</a>
<a class="sourceLine" id="cb89-3" title="3">  z &lt;-<span class="st"> </span><span class="kw">drop_na</span>(z)</a>
<a class="sourceLine" id="cb89-4" title="4">  vgram &lt;-<span class="st"> </span>gstat<span class="op">::</span><span class="kw">variogram</span>(value<span class="op">~</span><span class="dv">1</span>, <span class="dt">loc=</span><span class="op">~</span>x<span class="op">+</span>y, <span class="dt">data =</span> z)</a>
<a class="sourceLine" id="cb89-5" title="5">  <span class="kw">return</span>(vgram)</a>
<a class="sourceLine" id="cb89-6" title="6">})</a>
<a class="sourceLine" id="cb89-7" title="7"></a>
<a class="sourceLine" id="cb89-8" title="8"><span class="co"># save temp</span></a>
<a class="sourceLine" id="cb89-9" title="9"><span class="kw">save</span>(vgrams, <span class="dt">file =</span> <span class="st">&quot;data/chelsa/chelsaVariograms.rdata&quot;</span>)</a>
<a class="sourceLine" id="cb89-10" title="10"></a>
<a class="sourceLine" id="cb89-11" title="11"><span class="co"># get variogram data</span></a>
<a class="sourceLine" id="cb89-12" title="12">vgrams &lt;-<span class="st"> </span>purrr<span class="op">::</span><span class="kw">map</span>(vgrams, <span class="cf">function</span>(df){</a>
<a class="sourceLine" id="cb89-13" title="13">  df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(dist, gamma)</a>
<a class="sourceLine" id="cb89-14" title="14">})</a>
<a class="sourceLine" id="cb89-15" title="15">vgrams &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">variable =</span> chelsa_names,</a>
<a class="sourceLine" id="cb89-16" title="16">                 <span class="dt">data =</span> vgrams)</a></code></pre></div>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" title="1">wg &lt;-<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&quot;data/spatial/hillsShapefile/Nil_Ana_Pal.shp&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb90-2" title="2"><span class="st">  </span><span class="kw">st_transform</span>(<span class="dv">32643</span>)</a>
<a class="sourceLine" id="cb90-3" title="3">bbox &lt;-<span class="st"> </span><span class="kw">st_bbox</span>(wg)</a>
<a class="sourceLine" id="cb90-4" title="4"></a>
<a class="sourceLine" id="cb90-5" title="5"><span class="co"># add lamd</span></a>
<a class="sourceLine" id="cb90-6" title="6"><span class="kw">library</span>(rnaturalearth)</a>
<a class="sourceLine" id="cb90-7" title="7">land &lt;-<span class="st"> </span><span class="kw">ne_countries</span>(<span class="dt">scale =</span> <span class="dv">50</span>, <span class="dt">type =</span> <span class="st">&quot;countries&quot;</span>, <span class="dt">continent =</span> <span class="st">&quot;asia&quot;</span>,</a>
<a class="sourceLine" id="cb90-8" title="8">                     <span class="dt">country =</span> <span class="st">&quot;india&quot;</span>,</a>
<a class="sourceLine" id="cb90-9" title="9">                     <span class="dt">returnclass =</span> <span class="kw">c</span>(<span class="st">&quot;sf&quot;</span>))</a>
<a class="sourceLine" id="cb90-10" title="10"></a>
<a class="sourceLine" id="cb90-11" title="11"><span class="co"># crop land</span></a>
<a class="sourceLine" id="cb90-12" title="12">land &lt;-<span class="st"> </span><span class="kw">st_transform</span>(land, <span class="dv">32643</span>)</a></code></pre></div>
</div>
<div id="plot-chelsa-data-and-variograms" class="section level3">
<h3><span class="header-section-number">7.7.3</span> Plot CHELSA data and variograms</h3>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" title="1"><span class="co"># make ggplot of variograms</span></a>
<a class="sourceLine" id="cb91-2" title="2">yaxis &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;semivariance&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;&quot;</span>, <span class="dv">4</span>))</a>
<a class="sourceLine" id="cb91-3" title="3">xaxis &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;distance (km)&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb91-4" title="4">fig_vgrams &lt;-<span class="st"> </span>purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(vgrams<span class="op">$</span>data, yaxis, xaxis), <span class="cf">function</span>(df, ya, xa){</a>
<a class="sourceLine" id="cb91-5" title="5">  </a>
<a class="sourceLine" id="cb91-6" title="6">  <span class="kw">ggplot</span>(df)<span class="op">+</span></a>
<a class="sourceLine" id="cb91-7" title="7"><span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x =</span> dist<span class="op">/</span><span class="dv">1000</span>, <span class="dt">y =</span> gamma), <span class="dt">size =</span> <span class="fl">0.2</span>, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb91-8" title="8"><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> dist<span class="op">/</span><span class="dv">1000</span>, <span class="dt">y =</span> gamma), <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb91-9" title="9"><span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">labels =</span> comma)<span class="op">+</span></a>
<a class="sourceLine" id="cb91-10" title="10"><span class="st">    </span><span class="kw">scale_y_log10</span>(<span class="dt">labels =</span> comma)<span class="op">+</span></a>
<a class="sourceLine" id="cb91-11" title="11"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> xa, <span class="dt">y =</span> ya)<span class="op">+</span></a>
<a class="sourceLine" id="cb91-12" title="12"><span class="st">    </span><span class="kw">theme_few</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb91-13" title="13"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>),</a>
<a class="sourceLine" id="cb91-14" title="14">          <span class="dt">strip.text =</span> <span class="kw">element_blank</span>())</a>
<a class="sourceLine" id="cb91-15" title="15">  </a>
<a class="sourceLine" id="cb91-16" title="16">})</a>
<a class="sourceLine" id="cb91-17" title="17">fig_vgrams &lt;-<span class="st"> </span>purrr<span class="op">::</span><span class="kw">map</span>(fig_vgrams, as_grob)</a>
<a class="sourceLine" id="cb91-18" title="18"></a>
<a class="sourceLine" id="cb91-19" title="19"><span class="co"># make ggplot of chelsa data</span></a>
<a class="sourceLine" id="cb91-20" title="20">chelsa &lt;-<span class="st"> </span><span class="kw">as.list</span>(landscape_data[[chelsa_names]]) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb91-21" title="21"><span class="st">  </span>purrr<span class="op">::</span><span class="kw">map</span>(st_as_stars)</a>
<a class="sourceLine" id="cb91-22" title="22"></a>
<a class="sourceLine" id="cb91-23" title="23"><span class="co"># colour palettes</span></a>
<a class="sourceLine" id="cb91-24" title="24">pal &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;broc&quot;</span>, <span class="st">&quot;oslo&quot;</span>, <span class="st">&quot;oslo&quot;</span>, <span class="st">&quot;lapaz&quot;</span>, <span class="st">&quot;vik&quot;</span>)</a>
<a class="sourceLine" id="cb91-25" title="25">title &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;a Temp. seasonality&quot;</span>,</a>
<a class="sourceLine" id="cb91-26" title="26">           <span class="st">&quot;b Ppt. driest quarter&quot;</span>,</a>
<a class="sourceLine" id="cb91-27" title="27">           <span class="st">&quot;c Ppt. warmest quarter&quot;</span>,</a>
<a class="sourceLine" id="cb91-28" title="28">           <span class="st">&quot;d Variation ppt.&quot;</span>,</a>
<a class="sourceLine" id="cb91-29" title="29">           <span class="st">&quot;e Variation temp.&quot;</span>)</a>
<a class="sourceLine" id="cb91-30" title="30">fig_list_chelsa &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb91-31" title="31"><span class="st">  </span>purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(chelsa, pal, title), </a>
<a class="sourceLine" id="cb91-32" title="32">              <span class="cf">function</span>(df, pal, t){</a>
<a class="sourceLine" id="cb91-33" title="33">                <span class="kw">ggplot</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb91-34" title="34"><span class="st">                  </span><span class="kw">geom_stars</span>(<span class="dt">data =</span> df)<span class="op">+</span></a>
<a class="sourceLine" id="cb91-35" title="35"><span class="st">                  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> land, <span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb91-36" title="36"><span class="st">                  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> wg, <span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">size =</span> <span class="fl">0.3</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb91-37" title="37"><span class="st">                  </span><span class="kw">scale_fill_scico</span>(<span class="dt">palette =</span> pal, <span class="dt">direction =</span> <span class="dv">-1</span>, </a>
<a class="sourceLine" id="cb91-38" title="38">                                   <span class="dt">label =</span> comma, <span class="dt">na.value =</span> <span class="ot">NA</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb91-39" title="39"><span class="st">                  </span><span class="kw">coord_sf</span>(<span class="dt">xlim =</span> bbox[<span class="kw">c</span>(<span class="st">&quot;xmin&quot;</span>, <span class="st">&quot;xmax&quot;</span>)], </a>
<a class="sourceLine" id="cb91-40" title="40">                           <span class="dt">ylim =</span> bbox[<span class="kw">c</span>(<span class="st">&quot;ymin&quot;</span>, <span class="st">&quot;ymax&quot;</span>)])<span class="op">+</span></a>
<a class="sourceLine" id="cb91-41" title="41"><span class="st">                  </span><span class="kw">annotation_scale</span>(<span class="dt">location =</span> <span class="st">&quot;br&quot;</span>, <span class="dt">width_hint =</span> <span class="fl">0.4</span>, <span class="dt">text_cex =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb91-42" title="42"><span class="st">                  </span></a>
<a class="sourceLine" id="cb91-43" title="43"><span class="st">                  </span><span class="kw">theme_few</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb91-44" title="44"><span class="st">                  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;top&quot;</span>,</a>
<a class="sourceLine" id="cb91-45" title="45">                        <span class="dt">title =</span> <span class="kw">element_text</span>(<span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>),</a>
<a class="sourceLine" id="cb91-46" title="46">                        <span class="dt">legend.key.height =</span> <span class="kw">unit</span>(<span class="fl">0.2</span>, <span class="st">&quot;cm&quot;</span>),</a>
<a class="sourceLine" id="cb91-47" title="47">                        <span class="dt">legend.key.width =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;cm&quot;</span>),</a>
<a class="sourceLine" id="cb91-48" title="48">                        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),</a>
<a class="sourceLine" id="cb91-49" title="49">                        <span class="dt">axis.title =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb91-50" title="50">                        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>),</a>
<a class="sourceLine" id="cb91-51" title="51">                        <span class="co"># panel.background = element_rect(fill = &quot;lightblue&quot;),</span></a>
<a class="sourceLine" id="cb91-52" title="52">                        <span class="dt">legend.title =</span> <span class="kw">element_blank</span>())<span class="op">+</span></a>
<a class="sourceLine" id="cb91-53" title="53"><span class="st">                  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="ot">NULL</span>, <span class="dt">y=</span><span class="ot">NULL</span>, <span class="dt">title =</span> t)</a>
<a class="sourceLine" id="cb91-54" title="54">              })</a>
<a class="sourceLine" id="cb91-55" title="55">fig_list_chelsa &lt;-<span class="st"> </span>purrr<span class="op">::</span><span class="kw">map</span>(fig_list_chelsa, as_grob)</a></code></pre></div>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" title="1">fig_list_chelsa &lt;-<span class="st"> </span><span class="kw">append</span>(fig_list_chelsa, fig_vgrams)</a>
<a class="sourceLine" id="cb92-2" title="2">lmatrix &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>), <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>), <span class="kw">c</span>(<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>)), <span class="dt">nrow =</span> <span class="dv">3</span>, <span class="dt">byrow =</span> T)</a>
<a class="sourceLine" id="cb92-3" title="3">plot_grid &lt;-<span class="st"> </span><span class="kw">grid.arrange</span>(<span class="dt">grobs =</span> fig_list_chelsa, <span class="dt">layout_matrix =</span> lmatrix)</a>
<a class="sourceLine" id="cb92-4" title="4"></a>
<a class="sourceLine" id="cb92-5" title="5"><span class="kw">ggsave</span>(<span class="dt">plot =</span> plot_grid, <span class="dt">filename =</span> <span class="st">&quot;figs/fig_chelsa_variograms.png&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>, <span class="dt">width =</span> <span class="dv">12</span>, <span class="dt">height =</span> <span class="dv">6</span>)</a></code></pre></div>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" title="1"><span class="co"># show exported image</span></a>
<a class="sourceLine" id="cb93-2" title="2">knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="st">&quot;figs/fig_chelsa_variograms.png&quot;</span>)</a></code></pre></div>
<div class="figure">
<img src="figs/fig_chelsa_variograms.png" alt="CHELSA rasters with study area outline, and associated semivariograms. Semivariograms are on a log-transformed y-axis." width="1800" />
<p class="caption">
(#fig:show_fig_chelsa)CHELSA rasters with study area outline, and associated semivariograms. Semivariograms are on a log-transformed y-axis.
</p>
</div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="occupancy-modelling.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/pratikunterwegs/eBirdOccupancy/edit/master/06_supplement01.rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
