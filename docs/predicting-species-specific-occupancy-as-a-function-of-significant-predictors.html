<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 11 Predicting species-specific occupancy as a function of significant predictors | Source code and supplementary material for Using citizen science to parse climatic and landcover influences on bird occupancy within a tropical biodiversity hotspot</title>
  <meta name="description" content="Section 11 Predicting species-specific occupancy as a function of significant predictors | Source code and supplementary material for Using citizen science to parse climatic and landcover influences on bird occupancy within a tropical biodiversity hotspot" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 11 Predicting species-specific occupancy as a function of significant predictors | Source code and supplementary material for Using citizen science to parse climatic and landcover influences on bird occupancy within a tropical biodiversity hotspot" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="vjjan91/eBirdOccupancy" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 11 Predicting species-specific occupancy as a function of significant predictors | Source code and supplementary material for Using citizen science to parse climatic and landcover influences on bird occupancy within a tropical biodiversity hotspot" />
  
  
  

<meta name="author" content="Vijay Ramesh" />
<meta name="author" content="Pratik R. Gupte" />
<meta name="author" content="Morgan W. Tingley" />
<meta name="author" content="VV Robin" />
<meta name="author" content="Ruth DeFries" />


<meta name="date" content="2022-04-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="visualizing-occupancy-predictor-effects.html"/>
<link rel="next" href="references.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#data-processing"><i class="fa fa-check"></i><b>1.1</b> Data processing</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="selecting-species-of-interest.html"><a href="selecting-species-of-interest.html"><i class="fa fa-check"></i><b>2</b> Selecting species of interest</a><ul>
<li class="chapter" data-level="2.1" data-path="selecting-species-of-interest.html"><a href="selecting-species-of-interest.html#prepare-libraries"><i class="fa fa-check"></i><b>2.1</b> Prepare libraries</a></li>
<li class="chapter" data-level="2.2" data-path="selecting-species-of-interest.html"><a href="selecting-species-of-interest.html#subset-species-by-geographical-confines-of-the-study-area"><i class="fa fa-check"></i><b>2.2</b> Subset species by geographical confines of the study area</a></li>
<li class="chapter" data-level="2.3" data-path="selecting-species-of-interest.html"><a href="selecting-species-of-interest.html#subset-an-initial-list-of-terrestrial-birds-based-on-a-minimum-of-1000-detections-between-2013-2021-and-b-remove-species-that-are-often-easily-confused-with-congeners"><i class="fa fa-check"></i><b>2.3</b> Subset an initial list of terrestrial birds based on a) minimum of 1000 detections between 2013-2021 and b) remove species that are often easily confused with congeners</a></li>
<li class="chapter" data-level="2.4" data-path="selecting-species-of-interest.html"><a href="selecting-species-of-interest.html#read-subset-of-species-following-filtering-and-removal-of-waterbirds-raptors-and-other-noctural-species"><i class="fa fa-check"></i><b>2.4</b> Read subset of species following filtering and removal of waterbirds, raptors, and other noctural species</a></li>
<li class="chapter" data-level="2.5" data-path="selecting-species-of-interest.html"><a href="selecting-species-of-interest.html#load-raw-data-for-locations"><i class="fa fa-check"></i><b>2.5</b> Load raw data for locations</a></li>
<li class="chapter" data-level="2.6" data-path="selecting-species-of-interest.html"><a href="selecting-species-of-interest.html#get-proportional-obs-counts-in-25km-cells"><i class="fa fa-check"></i><b>2.6</b> Get proportional obs counts in 25km cells</a></li>
<li class="chapter" data-level="2.7" data-path="selecting-species-of-interest.html"><a href="selecting-species-of-interest.html#which-species-are-reported-sufficiently-in-checklists"><i class="fa fa-check"></i><b>2.7</b> Which species are reported sufficiently in checklists?</a></li>
<li class="chapter" data-level="2.8" data-path="selecting-species-of-interest.html"><a href="selecting-species-of-interest.html#figure-checklist-distribution"><i class="fa fa-check"></i><b>2.8</b> Figure: Checklist distribution</a></li>
<li class="chapter" data-level="2.9" data-path="selecting-species-of-interest.html"><a href="selecting-species-of-interest.html#prepare-the-species-list"><i class="fa fa-check"></i><b>2.9</b> Prepare the species list</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="preparing-ebird-data.html"><a href="preparing-ebird-data.html"><i class="fa fa-check"></i><b>3</b> Preparing eBird Data</a><ul>
<li class="chapter" data-level="3.1" data-path="preparing-ebird-data.html"><a href="preparing-ebird-data.html#prepare-libraries-and-data-sources"><i class="fa fa-check"></i><b>3.1</b> Prepare libraries and data sources</a></li>
<li class="chapter" data-level="3.2" data-path="preparing-ebird-data.html"><a href="preparing-ebird-data.html#filter-data"><i class="fa fa-check"></i><b>3.2</b> Filter data</a></li>
<li class="chapter" data-level="3.3" data-path="preparing-ebird-data.html"><a href="preparing-ebird-data.html#process-filtered-data"><i class="fa fa-check"></i><b>3.3</b> Process filtered data</a></li>
<li class="chapter" data-level="3.4" data-path="preparing-ebird-data.html"><a href="preparing-ebird-data.html#spatial-filter"><i class="fa fa-check"></i><b>3.4</b> Spatial filter</a></li>
<li class="chapter" data-level="3.5" data-path="preparing-ebird-data.html"><a href="preparing-ebird-data.html#handle-presence-data"><i class="fa fa-check"></i><b>3.5</b> Handle presence data</a></li>
<li class="chapter" data-level="3.6" data-path="preparing-ebird-data.html"><a href="preparing-ebird-data.html#add-decimal-time"><i class="fa fa-check"></i><b>3.6</b> Add decimal time</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="preparing-environmental-predictors.html"><a href="preparing-environmental-predictors.html"><i class="fa fa-check"></i><b>4</b> Preparing Environmental Predictors</a><ul>
<li class="chapter" data-level="4.1" data-path="preparing-environmental-predictors.html"><a href="preparing-environmental-predictors.html#prepare-libraries-1"><i class="fa fa-check"></i><b>4.1</b> Prepare libraries</a></li>
<li class="chapter" data-level="4.2" data-path="preparing-environmental-predictors.html"><a href="preparing-environmental-predictors.html#prepare-spatial-extent"><i class="fa fa-check"></i><b>4.2</b> Prepare spatial extent</a></li>
<li class="chapter" data-level="4.3" data-path="preparing-environmental-predictors.html"><a href="preparing-environmental-predictors.html#prepare-terrain-rasters"><i class="fa fa-check"></i><b>4.3</b> Prepare terrain rasters</a></li>
<li class="chapter" data-level="4.4" data-path="preparing-environmental-predictors.html"><a href="preparing-environmental-predictors.html#prepare-chelsa-rasters"><i class="fa fa-check"></i><b>4.4</b> Prepare CHELSA rasters</a><ul>
<li class="chapter" data-level="4.4.1" data-path="preparing-environmental-predictors.html"><a href="preparing-environmental-predictors.html#prepare-bioclim-4a-and-15"><i class="fa fa-check"></i><b>4.4.1</b> Prepare BIOCLIM 4a and 15</a></li>
<li class="chapter" data-level="4.4.2" data-path="preparing-environmental-predictors.html"><a href="preparing-environmental-predictors.html#prepare-bioclim-4a"><i class="fa fa-check"></i><b>4.4.2</b> Prepare BIOCLIM 4a</a></li>
<li class="chapter" data-level="4.4.3" data-path="preparing-environmental-predictors.html"><a href="preparing-environmental-predictors.html#prepare-bioclim-15"><i class="fa fa-check"></i><b>4.4.3</b> Prepare Bioclim 15</a></li>
<li class="chapter" data-level="4.4.4" data-path="preparing-environmental-predictors.html"><a href="preparing-environmental-predictors.html#stack-terrain-and-climate"><i class="fa fa-check"></i><b>4.4.4</b> Stack terrain and climate</a></li>
<li class="chapter" data-level="4.4.5" data-path="preparing-environmental-predictors.html"><a href="preparing-environmental-predictors.html#stack-terrain-and-climate-1"><i class="fa fa-check"></i><b>4.4.5</b> Stack terrain and climate</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="preparing-environmental-predictors.html"><a href="preparing-environmental-predictors.html#resample-landcover-from-10m-to-1km"><i class="fa fa-check"></i><b>4.5</b> Resample landcover from 10m to 1km</a></li>
<li class="chapter" data-level="4.6" data-path="preparing-environmental-predictors.html"><a href="preparing-environmental-predictors.html#resample-other-rasters-to-1km"><i class="fa fa-check"></i><b>4.6</b> Resample other rasters to 1km</a><ul>
<li class="chapter" data-level="4.6.1" data-path="preparing-environmental-predictors.html"><a href="preparing-environmental-predictors.html#read-in-resampled-landcover"><i class="fa fa-check"></i><b>4.6.1</b> Read in resampled landcover</a></li>
<li class="chapter" data-level="4.6.2" data-path="preparing-environmental-predictors.html"><a href="preparing-environmental-predictors.html#reproject-environmental-data-using-landcover-as-a-template"><i class="fa fa-check"></i><b>4.6.2</b> Reproject environmental data using landcover as a template</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="preparing-environmental-predictors.html"><a href="preparing-environmental-predictors.html#climate-variables-in-relation-to-elevation"><i class="fa fa-check"></i><b>4.7</b> Climate variables in relation to elevation</a><ul>
<li class="chapter" data-level="4.7.1" data-path="preparing-environmental-predictors.html"><a href="preparing-environmental-predictors.html#load-resampled-environmental-rasters"><i class="fa fa-check"></i><b>4.7.1</b> Load resampled environmental rasters</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="preparing-environmental-predictors.html"><a href="preparing-environmental-predictors.html#climate-across-land-cover-types"><i class="fa fa-check"></i><b>4.8</b> Climate across land cover types</a></li>
<li class="chapter" data-level="4.9" data-path="preparing-environmental-predictors.html"><a href="preparing-environmental-predictors.html#land-cover-type-in-relation-to-elevation"><i class="fa fa-check"></i><b>4.9</b> Land cover type in relation to elevation</a></li>
<li class="chapter" data-level="4.10" data-path="preparing-environmental-predictors.html"><a href="preparing-environmental-predictors.html#main-text-figure-2"><i class="fa fa-check"></i><b>4.10</b> Main Text Figure 2</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="preparing-checklist-calibration-index.html"><a href="preparing-checklist-calibration-index.html"><i class="fa fa-check"></i><b>5</b> Preparing Checklist Calibration Index</a><ul>
<li class="chapter" data-level="5.1" data-path="preparing-checklist-calibration-index.html"><a href="preparing-checklist-calibration-index.html#prepare-libraries-2"><i class="fa fa-check"></i><b>5.1</b> Prepare libraries</a></li>
<li class="chapter" data-level="5.2" data-path="preparing-checklist-calibration-index.html"><a href="preparing-checklist-calibration-index.html#prepare-data"><i class="fa fa-check"></i><b>5.2</b> Prepare data</a></li>
<li class="chapter" data-level="5.3" data-path="preparing-checklist-calibration-index.html"><a href="preparing-checklist-calibration-index.html#spatially-explicit-filter-on-checklists"><i class="fa fa-check"></i><b>5.3</b> Spatially explicit filter on checklists</a></li>
<li class="chapter" data-level="5.4" data-path="preparing-checklist-calibration-index.html"><a href="preparing-checklist-calibration-index.html#prepare-species-of-interest"><i class="fa fa-check"></i><b>5.4</b> Prepare species of interest</a></li>
<li class="chapter" data-level="5.5" data-path="preparing-checklist-calibration-index.html"><a href="preparing-checklist-calibration-index.html#prepare-checklists-for-observer-score"><i class="fa fa-check"></i><b>5.5</b> Prepare checklists for observer score</a></li>
<li class="chapter" data-level="5.6" data-path="preparing-checklist-calibration-index.html"><a href="preparing-checklist-calibration-index.html#get-landcover"><i class="fa fa-check"></i><b>5.6</b> Get landcover</a></li>
<li class="chapter" data-level="5.7" data-path="preparing-checklist-calibration-index.html"><a href="preparing-checklist-calibration-index.html#filter-checklist-data"><i class="fa fa-check"></i><b>5.7</b> Filter checklist data</a></li>
<li class="chapter" data-level="5.8" data-path="preparing-checklist-calibration-index.html"><a href="preparing-checklist-calibration-index.html#model-observer-expertise"><i class="fa fa-check"></i><b>5.8</b> Model observer expertise</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="examining-spatial-sampling-bias.html"><a href="examining-spatial-sampling-bias.html"><i class="fa fa-check"></i><b>6</b> Examining Spatial Sampling Bias</a><ul>
<li class="chapter" data-level="6.1" data-path="examining-spatial-sampling-bias.html"><a href="examining-spatial-sampling-bias.html#prepare-libraries-3"><i class="fa fa-check"></i><b>6.1</b> Prepare libraries</a></li>
<li class="chapter" data-level="6.2" data-path="examining-spatial-sampling-bias.html"><a href="examining-spatial-sampling-bias.html#read-checklist-data"><i class="fa fa-check"></i><b>6.2</b> Read checklist data</a><ul>
<li class="chapter" data-level="6.2.1" data-path="examining-spatial-sampling-bias.html"><a href="examining-spatial-sampling-bias.html#spatially-explicit-filter-on-checklists-1"><i class="fa fa-check"></i><b>6.2.1</b> Spatially explicit filter on checklists</a></li>
<li class="chapter" data-level="6.2.2" data-path="examining-spatial-sampling-bias.html"><a href="examining-spatial-sampling-bias.html#get-background-land-for-plotting"><i class="fa fa-check"></i><b>6.2.2</b> Get background land for plotting</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="examining-spatial-sampling-bias.html"><a href="examining-spatial-sampling-bias.html#prepare-main-text-figure-3"><i class="fa fa-check"></i><b>6.3</b> Prepare Main Text Figure 3</a><ul>
<li class="chapter" data-level="6.3.1" data-path="examining-spatial-sampling-bias.html"><a href="examining-spatial-sampling-bias.html#prepare-histogram-of-distance-to-roads"><i class="fa fa-check"></i><b>6.3.1</b> Prepare histogram of distance to roads</a></li>
<li class="chapter" data-level="6.3.2" data-path="examining-spatial-sampling-bias.html"><a href="examining-spatial-sampling-bias.html#table-distance-to-roads"><i class="fa fa-check"></i><b>6.3.2</b> Table: Distance to roads</a></li>
<li class="chapter" data-level="6.3.3" data-path="examining-spatial-sampling-bias.html"><a href="examining-spatial-sampling-bias.html#distance-to-nearest-neighbouring-site"><i class="fa fa-check"></i><b>6.3.3</b> Distance to nearest neighbouring site</a></li>
<li class="chapter" data-level="6.3.4" data-path="examining-spatial-sampling-bias.html"><a href="examining-spatial-sampling-bias.html#spatial-distribution-of-distances-to-neighbours"><i class="fa fa-check"></i><b>6.3.4</b> Spatial distribution of distances to neighbours</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="examining-spatial-sampling-bias.html"><a href="examining-spatial-sampling-bias.html#figure-spatial-sampling-bias"><i class="fa fa-check"></i><b>6.4</b> Figure: Spatial sampling bias</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="checking-temporal-sampling-frequency.html"><a href="checking-temporal-sampling-frequency.html"><i class="fa fa-check"></i><b>7</b> Checking Temporal Sampling Frequency</a><ul>
<li class="chapter" data-level="7.1" data-path="checking-temporal-sampling-frequency.html"><a href="checking-temporal-sampling-frequency.html#load-libraries"><i class="fa fa-check"></i><b>7.1</b> Load libraries</a></li>
<li class="chapter" data-level="7.2" data-path="checking-temporal-sampling-frequency.html"><a href="checking-temporal-sampling-frequency.html#load-checklist-data"><i class="fa fa-check"></i><b>7.2</b> Load checklist data</a></li>
<li class="chapter" data-level="7.3" data-path="checking-temporal-sampling-frequency.html"><a href="checking-temporal-sampling-frequency.html#get-time-differences-per-grid-cell"><i class="fa fa-check"></i><b>7.3</b> Get time differences per grid cell</a></li>
<li class="chapter" data-level="7.4" data-path="checking-temporal-sampling-frequency.html"><a href="checking-temporal-sampling-frequency.html#time-since-previous-checklist"><i class="fa fa-check"></i><b>7.4</b> Time Since Previous Checklist</a><ul>
<li class="chapter" data-level="7.4.1" data-path="checking-temporal-sampling-frequency.html"><a href="checking-temporal-sampling-frequency.html#get-aux-data"><i class="fa fa-check"></i><b>7.4.1</b> Get aux data</a></li>
<li class="chapter" data-level="7.4.2" data-path="checking-temporal-sampling-frequency.html"><a href="checking-temporal-sampling-frequency.html#histogram-of-lags"><i class="fa fa-check"></i><b>7.4.2</b> Histogram of lags</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="checking-temporal-sampling-frequency.html"><a href="checking-temporal-sampling-frequency.html#main-text-figure-3"><i class="fa fa-check"></i><b>7.5</b> Main Text Figure 3</a></li>
<li class="chapter" data-level="7.6" data-path="checking-temporal-sampling-frequency.html"><a href="checking-temporal-sampling-frequency.html#checklists-per-month"><i class="fa fa-check"></i><b>7.6</b> Checklists per Month</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="adding-covariates-to-checklist-data.html"><a href="adding-covariates-to-checklist-data.html"><i class="fa fa-check"></i><b>8</b> Adding Covariates to Checklist Data</a><ul>
<li class="chapter" data-level="8.1" data-path="adding-covariates-to-checklist-data.html"><a href="adding-covariates-to-checklist-data.html#prepare-libraries-and-data"><i class="fa fa-check"></i><b>8.1</b> Prepare libraries and data</a></li>
<li class="chapter" data-level="8.2" data-path="adding-covariates-to-checklist-data.html"><a href="adding-covariates-to-checklist-data.html#spatial-subsampling"><i class="fa fa-check"></i><b>8.2</b> Spatial subsampling</a><ul>
<li class="chapter" data-level="8.2.1" data-path="adding-covariates-to-checklist-data.html"><a href="adding-covariates-to-checklist-data.html#counting-presence-observation-proportion"><i class="fa fa-check"></i><b>8.2.1</b> Counting presence observation proportion</a></li>
<li class="chapter" data-level="8.2.2" data-path="adding-covariates-to-checklist-data.html"><a href="adding-covariates-to-checklist-data.html#count-absences-after-spatial-thinning"><i class="fa fa-check"></i><b>8.2.2</b> Count absences after spatial thinning</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="adding-covariates-to-checklist-data.html"><a href="adding-covariates-to-checklist-data.html#temporal-subsampling"><i class="fa fa-check"></i><b>8.3</b> Temporal subsampling</a><ul>
<li class="chapter" data-level="8.3.1" data-path="adding-covariates-to-checklist-data.html"><a href="adding-covariates-to-checklist-data.html#count-absences-after-temporal-thinning"><i class="fa fa-check"></i><b>8.3.1</b> Count absences after temporal thinning</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="adding-covariates-to-checklist-data.html"><a href="adding-covariates-to-checklist-data.html#add-checklist-calibration-index"><i class="fa fa-check"></i><b>8.4</b> Add checklist calibration index</a></li>
<li class="chapter" data-level="8.5" data-path="adding-covariates-to-checklist-data.html"><a href="adding-covariates-to-checklist-data.html#add-climatic-and-landscape-covariates"><i class="fa fa-check"></i><b>8.5</b> Add climatic and landscape covariates</a></li>
<li class="chapter" data-level="8.6" data-path="adding-covariates-to-checklist-data.html"><a href="adding-covariates-to-checklist-data.html#spatial-buffers-around-selected-checklists"><i class="fa fa-check"></i><b>8.6</b> Spatial buffers around selected checklists</a></li>
<li class="chapter" data-level="8.7" data-path="adding-covariates-to-checklist-data.html"><a href="adding-covariates-to-checklist-data.html#spatial-buffer-wide-covariates"><i class="fa fa-check"></i><b>8.7</b> Spatial buffer-wide covariates</a><ul>
<li class="chapter" data-level="8.7.1" data-path="adding-covariates-to-checklist-data.html"><a href="adding-covariates-to-checklist-data.html#mean-climatic-covariates"><i class="fa fa-check"></i><b>8.7.1</b> Mean climatic covariates</a></li>
<li class="chapter" data-level="8.7.2" data-path="adding-covariates-to-checklist-data.html"><a href="adding-covariates-to-checklist-data.html#proportions-of-land-cover-type"><i class="fa fa-check"></i><b>8.7.2</b> Proportions of land cover type</a></li>
<li class="chapter" data-level="8.7.3" data-path="adding-covariates-to-checklist-data.html"><a href="adding-covariates-to-checklist-data.html#link-environmental-covariates-to-checklists"><i class="fa fa-check"></i><b>8.7.3</b> Link environmental covariates to checklists</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="modelling-species-occupancy.html"><a href="modelling-species-occupancy.html"><i class="fa fa-check"></i><b>9</b> Modelling Species Occupancy</a><ul>
<li class="chapter" data-level="9.0.1" data-path="modelling-species-occupancy.html"><a href="modelling-species-occupancy.html#load-necessary-libraries"><i class="fa fa-check"></i><b>9.0.1</b> Load necessary libraries</a></li>
<li class="chapter" data-level="9.1" data-path="modelling-species-occupancy.html"><a href="modelling-species-occupancy.html#load-dataframe-and-prepare-covariates"><i class="fa fa-check"></i><b>9.1</b> Load dataframe and prepare covariates</a><ul>
<li class="chapter" data-level="9.1.1" data-path="modelling-species-occupancy.html"><a href="modelling-species-occupancy.html#handle-the-sampling-protocol"><i class="fa fa-check"></i><b>9.1.1</b> Handle the sampling protocol</a></li>
<li class="chapter" data-level="9.1.2" data-path="modelling-species-occupancy.html"><a href="modelling-species-occupancy.html#handle-time-and-date"><i class="fa fa-check"></i><b>9.1.2</b> Handle time and date</a></li>
<li class="chapter" data-level="9.1.3" data-path="modelling-species-occupancy.html"><a href="modelling-species-occupancy.html#scaling-covariates"><i class="fa fa-check"></i><b>9.1.3</b> Scaling covariates</a></li>
<li class="chapter" data-level="9.1.4" data-path="modelling-species-occupancy.html"><a href="modelling-species-occupancy.html#correct-date-format"><i class="fa fa-check"></i><b>9.1.4</b> Correct date format</a></li>
<li class="chapter" data-level="9.1.5" data-path="modelling-species-occupancy.html"><a href="modelling-species-occupancy.html#check-for-correlated-covariates"><i class="fa fa-check"></i><b>9.1.5</b> Check for correlated covariates</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="modelling-species-occupancy.html"><a href="modelling-species-occupancy.html#running-a-null-model"><i class="fa fa-check"></i><b>9.2</b> Running a null model</a></li>
<li class="chapter" data-level="9.3" data-path="modelling-species-occupancy.html"><a href="modelling-species-occupancy.html#identifying-covariates-necessary-to-model-the-detection-process"><i class="fa fa-check"></i><b>9.3</b> Identifying covariates necessary to model the detection process</a></li>
<li class="chapter" data-level="9.4" data-path="modelling-species-occupancy.html"><a href="modelling-species-occupancy.html#land-cover-and-climate"><i class="fa fa-check"></i><b>9.4</b> Land Cover and Climate</a></li>
<li class="chapter" data-level="9.5" data-path="modelling-species-occupancy.html"><a href="modelling-species-occupancy.html#goodness-of-fit-tests"><i class="fa fa-check"></i><b>9.5</b> Goodness-of-fit tests</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="visualizing-occupancy-predictor-effects.html"><a href="visualizing-occupancy-predictor-effects.html"><i class="fa fa-check"></i><b>10</b> Visualizing Occupancy Predictor Effects</a><ul>
<li class="chapter" data-level="10.1" data-path="visualizing-occupancy-predictor-effects.html"><a href="visualizing-occupancy-predictor-effects.html#prepare-libraries-4"><i class="fa fa-check"></i><b>10.1</b> Prepare libraries</a></li>
<li class="chapter" data-level="10.2" data-path="visualizing-occupancy-predictor-effects.html"><a href="visualizing-occupancy-predictor-effects.html#load-species-list"><i class="fa fa-check"></i><b>10.2</b> Load species list</a></li>
<li class="chapter" data-level="10.3" data-path="visualizing-occupancy-predictor-effects.html"><a href="visualizing-occupancy-predictor-effects.html#show-aic-weight-importance"><i class="fa fa-check"></i><b>10.3</b> Show AIC weight importance</a><ul>
<li class="chapter" data-level="10.3.1" data-path="visualizing-occupancy-predictor-effects.html"><a href="visualizing-occupancy-predictor-effects.html#read-in-aic-weight-data"><i class="fa fa-check"></i><b>10.3.1</b> Read in AIC weight data</a></li>
<li class="chapter" data-level="10.3.2" data-path="visualizing-occupancy-predictor-effects.html"><a href="visualizing-occupancy-predictor-effects.html#prepare-cumulative-aic-weight-data"><i class="fa fa-check"></i><b>10.3.2</b> Prepare cumulative AIC weight data</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="visualizing-occupancy-predictor-effects.html"><a href="visualizing-occupancy-predictor-effects.html#prepare-model-coefficient-data"><i class="fa fa-check"></i><b>10.4</b> Prepare model coefficient data</a></li>
<li class="chapter" data-level="10.5" data-path="visualizing-occupancy-predictor-effects.html"><a href="visualizing-occupancy-predictor-effects.html#get-predictor-effects"><i class="fa fa-check"></i><b>10.5</b> Get predictor effects</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html"><i class="fa fa-check"></i><b>11</b> Predicting species-specific occupancy as a function of significant predictors</a><ul>
<li class="chapter" data-level="11.1" data-path="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#prepare-libraries-5"><i class="fa fa-check"></i><b>11.1</b> Prepare libraries</a></li>
<li class="chapter" data-level="11.2" data-path="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#read-data"><i class="fa fa-check"></i><b>11.2</b> Read data</a></li>
<li class="chapter" data-level="11.3" data-path="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#prepare-predictor-data"><i class="fa fa-check"></i><b>11.3</b> Prepare predictor data</a></li>
<li class="chapter" data-level="11.4" data-path="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#get-predictor-responses"><i class="fa fa-check"></i><b>11.4</b> Get predictor responses</a></li>
<li class="chapter" data-level="11.5" data-path="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#get-probability-of-occupancy"><i class="fa fa-check"></i><b>11.5</b> Get probability of occupancy</a></li>
<li class="chapter" data-level="11.6" data-path="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#add-scaling-for-predictors"><i class="fa fa-check"></i><b>11.6</b> Add scaling for predictors</a><ul>
<li class="chapter" data-level="11.6.1" data-path="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#figure-occupancy-predictors"><i class="fa fa-check"></i><b>11.6.1</b> Figure: Occupancy ~ predictors</a></li>
<li class="chapter" data-level="11.6.2" data-path="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#figures-occupancy-predictors-for-all-species"><i class="fa fa-check"></i><b>11.6.2</b> Figures: Occupancy ~ predictors for all species</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#mapping-species-occupancy"><i class="fa fa-check"></i><b>11.7</b> Mapping species occupancy</a><ul>
<li class="chapter" data-level="11.7.1" data-path="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#read-in-raster-layers"><i class="fa fa-check"></i><b>11.7.1</b> Read in raster layers</a></li>
<li class="chapter" data-level="11.7.2" data-path="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#split-landcover-into-proportions-per-1km"><i class="fa fa-check"></i><b>11.7.2</b> Split landcover into proportions per 1km</a></li>
<li class="chapter" data-level="11.7.3" data-path="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#prepare-climatic-layers"><i class="fa fa-check"></i><b>11.7.3</b> Prepare climatic layers</a></li>
<li class="chapter" data-level="11.7.4" data-path="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#mask-by-study-area"><i class="fa fa-check"></i><b>11.7.4</b> Mask by study area</a></li>
<li class="chapter" data-level="11.7.5" data-path="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#plot-full-bounds-of-landscape-variables"><i class="fa fa-check"></i><b>11.7.5</b> Plot full bounds of landscape variables</a></li>
<li class="chapter" data-level="11.7.6" data-path="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#prepare-soi-predictors"><i class="fa fa-check"></i><b>11.7.6</b> Prepare soi predictors</a></li>
<li class="chapter" data-level="11.7.7" data-path="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#prepare-species-occupancy-for-soi"><i class="fa fa-check"></i><b>11.7.7</b> Prepare species occupancy for SOI</a></li>
<li class="chapter" data-level="11.7.8" data-path="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#prepare-species-occupancy-for-all-species"><i class="fa fa-check"></i><b>11.7.8</b> Prepare species occupancy for all species</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>12</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Source code and supplementary material for <em>Using citizen science to parse climatic and landcover influences on bird occupancy within a tropical biodiversity hotspot</em></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="predicting-species-specific-occupancy-as-a-function-of-significant-predictors" class="section level1">
<h1><span class="header-section-number">Section 11</span> Predicting species-specific occupancy as a function of significant predictors</h1>
<p>This script plots species-specific probabilities of occupancy as a function of significant environmental predictors and maps occupancy across the study area for a given list of species and significant predictors.</p>
<div id="prepare-libraries-5" class="section level2">
<h2><span class="header-section-number">11.1</span> Prepare libraries</h2>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb108-1"></a><span class="co"># to handle data</span></span>
<span id="cb108-2"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb108-2"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb108-3"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb108-3"></a><span class="kw">library</span>(readr)</span>
<span id="cb108-4"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb108-4"></a><span class="kw">library</span>(tidyr)</span>
<span id="cb108-5"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb108-5"></a><span class="kw">library</span>(purrr)</span>
<span id="cb108-6"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb108-6"></a><span class="kw">library</span>(stringr)</span>
<span id="cb108-7"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb108-7"></a><span class="kw">library</span>(glue)</span>
<span id="cb108-8"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb108-8"></a><span class="co"># library(data.table)</span></span>
<span id="cb108-9"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb108-9"></a></span>
<span id="cb108-10"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb108-10"></a><span class="co"># plotting</span></span>
<span id="cb108-11"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb108-11"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb108-12"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb108-12"></a><span class="kw">library</span>(patchwork)</span></code></pre></div>
</div>
<div id="read-data" class="section level2">
<h2><span class="header-section-number">11.2</span> Read data</h2>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb109-1"></a><span class="co"># read coefficient effect data</span></span>
<span id="cb109-2"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb109-2"></a>data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;results/10_data-predictor-effect.csv&quot;</span>)</span>
<span id="cb109-3"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb109-3"></a></span>
<span id="cb109-4"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb109-4"></a><span class="co"># check for a predictor column</span></span>
<span id="cb109-5"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb109-5"></a>assertthat<span class="op">::</span><span class="kw">assert_that</span>(</span>
<span id="cb109-6"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb109-6"></a>  <span class="kw">all</span>(<span class="kw">c</span>(<span class="st">&quot;predictor&quot;</span>, <span class="st">&quot;coefficient&quot;</span>, <span class="st">&quot;se&quot;</span>) <span class="op">%in%</span><span class="st"> </span><span class="kw">colnames</span>(data)),</span>
<span id="cb109-7"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb109-7"></a>  <span class="dt">msg =</span> <span class="st">&quot;make_response_data: data must have columns called &#39;predictor&#39;,</span></span>
<span id="cb109-8"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb109-8"></a><span class="st">    &#39;coefficient&#39;, and &#39;se&#39;&quot;</span></span>
<span id="cb109-9"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb109-9"></a>)</span></code></pre></div>
</div>
<div id="prepare-predictor-data" class="section level2">
<h2><span class="header-section-number">11.3</span> Prepare predictor data</h2>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb110-1"></a><span class="co"># preparep predictors - now look only for any digits</span></span>
<span id="cb110-2"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb110-2"></a>predictors &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;bio</span><span class="ch">\\</span><span class="st">d+&quot;</span>, <span class="kw">glue</span>(<span class="st">&quot;lc_0{seq(9)}&quot;</span>))</span>
<span id="cb110-3"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb110-3"></a></span>
<span id="cb110-4"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb110-4"></a><span class="co"># prepare predictor search strings and scaling power</span></span>
<span id="cb110-5"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb110-5"></a>preds &lt;-<span class="st"> </span><span class="kw">glue</span>(<span class="st">&quot;({predictors})&quot;</span>)</span>
<span id="cb110-6"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb110-6"></a>preds &lt;-<span class="st"> </span><span class="kw">str_flatten</span>(preds, <span class="dt">collapse =</span> <span class="st">&quot;|&quot;</span>)</span>
<span id="cb110-7"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb110-7"></a></span>
<span id="cb110-8"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb110-8"></a><span class="co"># some way of identifying square terms</span></span>
<span id="cb110-9"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb110-9"></a>power &lt;-<span class="st"> </span>(<span class="kw">str_extract</span>(data<span class="op">$</span>predictor, <span class="st">&quot;Ibio&quot;</span>))</span>
<span id="cb110-10"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb110-10"></a>power[<span class="op">!</span><span class="kw">is.na</span>(power)] =<span class="st"> </span><span class="dv">2</span></span>
<span id="cb110-11"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb110-11"></a>power[<span class="kw">is.na</span>(power)] &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb110-12"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb110-12"></a>power =<span class="st"> </span><span class="kw">as.numeric</span>(power)</span>
<span id="cb110-13"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb110-13"></a></span>
<span id="cb110-14"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb110-14"></a><span class="co"># assign predictor name and power</span></span>
<span id="cb110-15"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb110-15"></a>data &lt;-</span>
<span id="cb110-16"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb110-16"></a><span class="st">  </span><span class="kw">mutate</span>(</span>
<span id="cb110-17"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb110-17"></a>  data,</span>
<span id="cb110-18"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb110-18"></a>  <span class="dt">predictor =</span> <span class="kw">str_extract</span>(predictor, preds),</span>
<span id="cb110-19"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb110-19"></a>  <span class="dt">power =</span> power</span>
<span id="cb110-20"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb110-20"></a>)</span></code></pre></div>
</div>
<div id="get-predictor-responses" class="section level2">
<h2><span class="header-section-number">11.4</span> Get predictor responses</h2>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb111-1"></a><span class="co"># make predictor sequences</span></span>
<span id="cb111-2"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb111-2"></a>data &lt;-<span class="st"> </span><span class="kw">mutate</span>(</span>
<span id="cb111-3"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb111-3"></a>  data,</span>
<span id="cb111-4"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb111-4"></a>  <span class="dt">pred_val =</span> <span class="kw">map</span>(</span>
<span id="cb111-5"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb111-5"></a>    predictor,</span>
<span id="cb111-6"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb111-6"></a>    <span class="cf">function</span>(x) {</span>
<span id="cb111-7"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb111-7"></a>      <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.05</span>)</span>
<span id="cb111-8"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb111-8"></a>    }</span>
<span id="cb111-9"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb111-9"></a>  ),</span>
<span id="cb111-10"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb111-10"></a>  <span class="co">#handle squared terms</span></span>
<span id="cb111-11"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb111-11"></a>  <span class="dt">pred_val_pow =</span> purrr<span class="op">::</span><span class="kw">map2</span>(</span>
<span id="cb111-12"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb111-12"></a>    pred_val, power,</span>
<span id="cb111-13"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb111-13"></a>    <span class="cf">function</span>(x, y) {</span>
<span id="cb111-14"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb111-14"></a>      x<span class="op">^</span>y</span>
<span id="cb111-15"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb111-15"></a>    }</span>
<span id="cb111-16"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb111-16"></a>))</span>
<span id="cb111-17"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb111-17"></a></span>
<span id="cb111-18"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb111-18"></a></span>
<span id="cb111-19"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb111-19"></a><span class="co"># get coefficient and error times terms</span></span>
<span id="cb111-20"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb111-20"></a>data_resp &lt;-<span class="st"> </span><span class="kw">mutate</span>(</span>
<span id="cb111-21"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb111-21"></a>  data,</span>
<span id="cb111-22"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb111-22"></a>  <span class="dt">response =</span> <span class="kw">map2</span>(</span>
<span id="cb111-23"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb111-23"></a>    pred_val_pow, coefficient,</span>
<span id="cb111-24"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb111-24"></a>    <span class="cf">function</span>(x, y) {</span>
<span id="cb111-25"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb111-25"></a>      x <span class="op">*</span><span class="st"> </span>y</span>
<span id="cb111-26"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb111-26"></a>    }</span>
<span id="cb111-27"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb111-27"></a>  ),</span>
<span id="cb111-28"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb111-28"></a>  <span class="dt">resp_var =</span> <span class="kw">map2</span>(</span>
<span id="cb111-29"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb111-29"></a>    pred_val_pow, se,</span>
<span id="cb111-30"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb111-30"></a>    <span class="cf">function</span>(x, y) {</span>
<span id="cb111-31"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb111-31"></a>      x <span class="op">*</span><span class="st"> </span>y</span>
<span id="cb111-32"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb111-32"></a>    }</span>
<span id="cb111-33"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb111-33"></a>  )</span>
<span id="cb111-34"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb111-34"></a>)</span></code></pre></div>
</div>
<div id="get-probability-of-occupancy" class="section level2">
<h2><span class="header-section-number">11.5</span> Get probability of occupancy</h2>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb112-1"></a><span class="co"># unnest and get responses</span></span>
<span id="cb112-2"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb112-2"></a>data_resp &lt;-<span class="st"> </span><span class="kw">unnest</span>(</span>
<span id="cb112-3"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb112-3"></a>  data_resp,</span>
<span id="cb112-4"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb112-4"></a>  <span class="dt">cols =</span> <span class="kw">c</span>(<span class="st">&quot;response&quot;</span>, <span class="st">&quot;resp_var&quot;</span>, <span class="st">&quot;pred_val&quot;</span>)</span>
<span id="cb112-5"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb112-5"></a>)</span>
<span id="cb112-6"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb112-6"></a></span>
<span id="cb112-7"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb112-7"></a><span class="co"># get responses for quadratic terms</span></span>
<span id="cb112-8"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb112-8"></a>data_resp &lt;-</span>
<span id="cb112-9"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb112-9"></a><span class="st">  </span><span class="kw">group_by</span>(</span>
<span id="cb112-10"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb112-10"></a>    data_resp,</span>
<span id="cb112-11"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb112-11"></a>    scientific_name, predictor, pred_val</span>
<span id="cb112-12"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb112-12"></a>  ) <span class="op">%&gt;%</span></span>
<span id="cb112-13"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb112-13"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>power, <span class="op">-</span>coefficient, <span class="op">-</span>se) <span class="op">%&gt;%</span></span>
<span id="cb112-14"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb112-14"></a><span class="st">  </span><span class="kw">summarise</span>(</span>
<span id="cb112-15"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb112-15"></a>    <span class="kw">across</span>(</span>
<span id="cb112-16"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb112-16"></a>      <span class="dt">.cols =</span> <span class="kw">c</span>(<span class="st">&quot;response&quot;</span>, <span class="st">&quot;resp_var&quot;</span>),</span>
<span id="cb112-17"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb112-17"></a>      <span class="dt">.fns =</span> sum</span>
<span id="cb112-18"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb112-18"></a>    ),</span>
<span id="cb112-19"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb112-19"></a>    <span class="dt">.groups =</span> <span class="st">&quot;keep&quot;</span></span>
<span id="cb112-20"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb112-20"></a>  )</span>
<span id="cb112-21"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb112-21"></a></span>
<span id="cb112-22"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb112-22"></a><span class="co"># get probability of occupancy</span></span>
<span id="cb112-23"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb112-23"></a>data_resp &lt;-<span class="st"> </span><span class="kw">ungroup</span>(</span>
<span id="cb112-24"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb112-24"></a>  data_resp</span>
<span id="cb112-25"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb112-25"></a>) <span class="op">%&gt;%</span></span>
<span id="cb112-26"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb112-26"></a><span class="st">  </span><span class="kw">mutate</span>(</span>
<span id="cb112-27"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb112-27"></a>    <span class="dt">p_occu =</span> <span class="dv">1</span> <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>response)),</span>
<span id="cb112-28"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb112-28"></a>    <span class="dt">p_occu_low =</span> <span class="dv">1</span> <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>(response <span class="op">-</span><span class="st"> </span>resp_var))),</span>
<span id="cb112-29"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb112-29"></a>    <span class="dt">p_occu_high =</span> <span class="dv">1</span> <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>(response <span class="op">+</span><span class="st"> </span>resp_var)))</span>
<span id="cb112-30"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb112-30"></a>  )</span></code></pre></div>
</div>
<div id="add-scaling-for-predictors" class="section level2">
<h2><span class="header-section-number">11.6</span> Add scaling for predictors</h2>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb113-1"></a><span class="co"># scale predictors</span></span>
<span id="cb113-2"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb113-2"></a>scale15 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">30</span>, <span class="dv">50</span>) <span class="co"># range of precipitation</span></span>
<span id="cb113-3"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb113-3"></a>scale4 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="co"># range of temperatures</span></span>
<span id="cb113-4"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb113-4"></a></span>
<span id="cb113-5"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb113-5"></a><span class="co"># scale bio4a and bio15a by actual values</span></span>
<span id="cb113-6"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb113-6"></a>data_resp &lt;-<span class="st"> </span><span class="kw">mutate</span>(</span>
<span id="cb113-7"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb113-7"></a>  data_resp,</span>
<span id="cb113-8"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb113-8"></a>  <span class="dt">pred_val =</span> <span class="kw">case_when</span>(</span>
<span id="cb113-9"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb113-9"></a>    predictor <span class="op">==</span><span class="st"> &quot;bio4&quot;</span> <span class="op">~</span><span class="st"> </span>scales<span class="op">::</span><span class="kw">rescale</span>(pred_val, <span class="dt">to =</span> scale4),</span>
<span id="cb113-10"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb113-10"></a>    predictor <span class="op">==</span><span class="st"> &quot;bio15&quot;</span> <span class="op">~</span><span class="st"> </span>scales<span class="op">::</span><span class="kw">rescale</span>(pred_val, <span class="dt">to =</span> scale15),</span>
<span id="cb113-11"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb113-11"></a>    T <span class="op">~</span><span class="st"> </span>pred_val</span>
<span id="cb113-12"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb113-12"></a>  )</span>
<span id="cb113-13"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb113-13"></a>)</span>
<span id="cb113-14"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb113-14"></a></span>
<span id="cb113-15"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb113-15"></a><span class="co"># make long</span></span>
<span id="cb113-16"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb113-16"></a>data_poccu &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(</span>
<span id="cb113-17"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb113-17"></a>  data_resp,</span>
<span id="cb113-18"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb113-18"></a>  <span class="op">-</span>response, <span class="op">-</span>resp_var</span>
<span id="cb113-19"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb113-19"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb114-1"></a><span class="co"># select species</span></span>
<span id="cb114-2"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb114-2"></a>soi &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Irena puella&quot;</span>,<span class="st">&quot;Leptocoma minima&quot;</span>, <span class="st">&quot;Merops leschenaulti&quot;</span>,<span class="st">&quot;Myophonus horsfieldii&quot;</span>)</span>
<span id="cb114-3"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb114-3"></a></span>
<span id="cb114-4"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb114-4"></a>which_predictors &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;bio4&quot;</span>)</span></code></pre></div>
<div id="figure-occupancy-predictors" class="section level3">
<h3><span class="header-section-number">11.6.1</span> Figure: Occupancy ~ predictors</h3>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb115-1"></a>data_fig &lt;-<span class="st"> </span>data_poccu <span class="op">%&gt;%</span></span>
<span id="cb115-2"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb115-2"></a><span class="st">  </span><span class="kw">filter</span>(</span>
<span id="cb115-3"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb115-3"></a>    scientific_name <span class="op">%in%</span><span class="st"> </span>soi,</span>
<span id="cb115-4"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb115-4"></a>    predictor <span class="op">%in%</span><span class="st"> </span>which_predictors</span>
<span id="cb115-5"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb115-5"></a>  ) <span class="op">%&gt;%</span></span>
<span id="cb115-6"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb115-6"></a><span class="st">  </span><span class="kw">mutate</span>(</span>
<span id="cb115-7"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb115-7"></a>    <span class="dt">cat =</span> <span class="kw">case_when</span>(</span>
<span id="cb115-8"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb115-8"></a>      scientific_name <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Irena puella&quot;</span>,<span class="st">&quot;Leptocoma minima&quot;</span>) <span class="op">~</span><span class="st"> &quot;forest&quot;</span>,</span>
<span id="cb115-9"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb115-9"></a>      T <span class="op">~</span><span class="st"> &quot;general&quot;</span></span>
<span id="cb115-10"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb115-10"></a>    )</span>
<span id="cb115-11"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb115-11"></a>  )</span>
<span id="cb115-12"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb115-12"></a></span>
<span id="cb115-13"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb115-13"></a><span class="co"># split data</span></span>
<span id="cb115-14"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb115-14"></a>data_fig &lt;-<span class="st"> </span><span class="kw">nest</span>(</span>
<span id="cb115-15"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb115-15"></a>  data_fig,</span>
<span id="cb115-16"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb115-16"></a>  <span class="op">-</span>cat</span>
<span id="cb115-17"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb115-17"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-1"></a><span class="co"># make plots</span></span>
<span id="cb116-2"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-2"></a>make_occu_fig &lt;-<span class="st"> </span><span class="cf">function</span>(df, this_fill) {</span>
<span id="cb116-3"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-3"></a>  <span class="kw">ggplot</span>(</span>
<span id="cb116-4"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-4"></a>    df</span>
<span id="cb116-5"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-5"></a>  ) <span class="op">+</span></span>
<span id="cb116-6"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-6"></a><span class="st">    </span><span class="kw">geom_ribbon</span>(</span>
<span id="cb116-7"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-7"></a>      <span class="kw">aes</span>(</span>
<span id="cb116-8"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-8"></a>        pred_val,</span>
<span id="cb116-9"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-9"></a>        <span class="dt">ymin =</span> p_occu_low,</span>
<span id="cb116-10"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-10"></a>        <span class="dt">ymax =</span> p_occu_high</span>
<span id="cb116-11"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-11"></a>      ),</span>
<span id="cb116-12"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-12"></a>      <span class="dt">fill =</span> this_fill,</span>
<span id="cb116-13"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-13"></a>      <span class="dt">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb116-14"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-14"></a>    ) <span class="op">+</span></span>
<span id="cb116-15"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-15"></a><span class="st">    </span><span class="kw">geom_line</span>(</span>
<span id="cb116-16"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-16"></a>      <span class="kw">aes</span>(</span>
<span id="cb116-17"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-17"></a>        pred_val, p_occu</span>
<span id="cb116-18"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-18"></a>      ),</span>
<span id="cb116-19"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-19"></a>      <span class="dt">size =</span> <span class="dv">1</span></span>
<span id="cb116-20"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-20"></a>    ) <span class="op">+</span></span>
<span id="cb116-21"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-21"></a><span class="st">    </span><span class="kw">facet_grid</span>(</span>
<span id="cb116-22"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-22"></a>      <span class="op">~</span>scientific_name</span>
<span id="cb116-23"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-23"></a>    ) <span class="op">+</span></span>
<span id="cb116-24"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-24"></a><span class="st">    </span><span class="kw">theme_test</span>(</span>
<span id="cb116-25"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-25"></a>      <span class="dt">base_family =</span> <span class="st">&quot;Arial&quot;</span></span>
<span id="cb116-26"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-26"></a>    ) <span class="op">+</span></span>
<span id="cb116-27"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-27"></a><span class="st">    </span><span class="kw">theme</span>(</span>
<span id="cb116-28"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-28"></a>      <span class="dt">strip.text =</span> <span class="kw">element_text</span>(</span>
<span id="cb116-29"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-29"></a>        <span class="dt">face =</span> <span class="st">&quot;italic&quot;</span></span>
<span id="cb116-30"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-30"></a>      )</span>
<span id="cb116-31"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-31"></a>    ) <span class="op">+</span></span>
<span id="cb116-32"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-32"></a><span class="st">    </span><span class="kw">labs</span>(</span>
<span id="cb116-33"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-33"></a>      <span class="dt">x =</span> <span class="st">&quot;Temperature seasonality&quot;</span>,</span>
<span id="cb116-34"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-34"></a>      <span class="dt">y =</span> <span class="st">&quot;Probability of occupancy&quot;</span></span>
<span id="cb116-35"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-35"></a>    )</span>
<span id="cb116-36"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-36"></a>}</span>
<span id="cb116-37"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-37"></a></span>
<span id="cb116-38"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-38"></a></span>
<span id="cb116-39"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-39"></a>fig_occu &lt;-<span class="st"> </span><span class="kw">map2</span>(data_fig<span class="op">$</span>data, <span class="st">&quot;grey&quot;</span>, make_occu_fig)</span>
<span id="cb116-40"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-40"></a></span>
<span id="cb116-41"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-41"></a>fig_occu &lt;-</span>
<span id="cb116-42"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-42"></a><span class="st">  </span><span class="kw">wrap_plots</span>(</span>
<span id="cb116-43"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-43"></a>    fig_occu[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)],</span>
<span id="cb116-44"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-44"></a>    <span class="dt">ncol =</span> <span class="dv">1</span>, <span class="dt">nrow =</span> <span class="dv">2</span></span>
<span id="cb116-45"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-45"></a>  ) <span class="op">&amp;</span></span>
<span id="cb116-46"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-46"></a><span class="st">    </span><span class="kw">theme</span>(</span>
<span id="cb116-47"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-47"></a>      <span class="dt">plot.tag =</span> <span class="kw">element_text</span>(</span>
<span id="cb116-48"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-48"></a>        <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span></span>
<span id="cb116-49"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-49"></a>      )</span>
<span id="cb116-50"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-50"></a>    )</span>
<span id="cb116-51"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-51"></a></span>
<span id="cb116-52"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-52"></a><span class="co"># save figure</span></span>
<span id="cb116-53"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-53"></a><span class="kw">ggsave</span>(</span>
<span id="cb116-54"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-54"></a>  fig_occu,</span>
<span id="cb116-55"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-55"></a>  <span class="dt">filename =</span> <span class="st">&quot;figs/fig_05.png&quot;</span>,</span>
<span id="cb116-56"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-56"></a>  <span class="dt">width =</span> <span class="dv">5</span>, <span class="dt">height =</span> <span class="fl">5.5</span></span>
<span id="cb116-57"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb116-57"></a>)</span></code></pre></div>
<div class="figure">
<img src="figs/fig_05.png" alt="" />
<p class="caption"><strong>Probability of occupancy as a function of temperature seasonality.</strong>
Predicted probability of occupancy curves as a function of temperature seasonality for four forest species are shown here. Temperature seasonality is negatively associated with the probability of occupancy of several forest species including the asian fairy-bluebird <em>Irena puella</em>, the crimson-backed sunbird <em>Leptocoma minima</em>, the chestnut-headed bee-eater <em>Merops leschenaulti</em> and the Malabar whistling-thrush <em>Myophonus horsfieldii</em>.</p>
</div>
</div>
<div id="figures-occupancy-predictors-for-all-species" class="section level3">
<h3><span class="header-section-number">11.6.2</span> Figures: Occupancy ~ predictors for all species</h3>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-1"></a>data_fig &lt;-<span class="st"> </span><span class="kw">nest</span>(</span>
<span id="cb117-2"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-2"></a>  data_poccu,</span>
<span id="cb117-3"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-3"></a>  <span class="op">-</span>scientific_name, <span class="op">-</span>predictor</span>
<span id="cb117-4"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-4"></a>)</span>
<span id="cb117-5"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-5"></a></span>
<span id="cb117-6"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-6"></a>pred_names &lt;-<span class="st"> </span><span class="kw">c</span>(</span>
<span id="cb117-7"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-7"></a>  <span class="st">&quot;bio4&quot;</span> =<span class="st"> &quot;Temp. seasonality&quot;</span>,</span>
<span id="cb117-8"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-8"></a>  <span class="st">&quot;bio15&quot;</span> =<span class="st"> &quot;Precip. seasonality&quot;</span>,</span>
<span id="cb117-9"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-9"></a>  <span class="st">&quot;lc_01&quot;</span> =<span class="st"> &quot;Evergreen&quot;</span>,</span>
<span id="cb117-10"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-10"></a>  <span class="st">&quot;lc_02&quot;</span> =<span class="st"> &quot;Deciduous&quot;</span>,</span>
<span id="cb117-11"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-11"></a>  <span class="st">&quot;lc_03&quot;</span> =<span class="st"> &quot;Mixed/degraded&quot;</span>,</span>
<span id="cb117-12"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-12"></a>  <span class="st">&quot;lc_04&quot;</span> =<span class="st"> &quot;Agri./Settl.&quot;</span>,</span>
<span id="cb117-13"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-13"></a>  <span class="st">&quot;lc_05&quot;</span> =<span class="st"> &quot;Grassland&quot;</span>,</span>
<span id="cb117-14"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-14"></a>  <span class="st">&quot;lc_07&quot;</span> =<span class="st"> &quot;Plantation&quot;</span>,</span>
<span id="cb117-15"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-15"></a>  <span class="st">&quot;lc_09&quot;</span> =<span class="st"> &quot;Water&quot;</span></span>
<span id="cb117-16"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-16"></a>)</span>
<span id="cb117-17"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-17"></a></span>
<span id="cb117-18"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-18"></a>pred_names &lt;-<span class="st"> </span><span class="kw">tibble</span>(</span>
<span id="cb117-19"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-19"></a>  <span class="dt">name =</span> pred_names,</span>
<span id="cb117-20"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-20"></a>  <span class="dt">predictor =</span> <span class="kw">names</span>(pred_names)</span>
<span id="cb117-21"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-21"></a>)</span>
<span id="cb117-22"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-22"></a></span>
<span id="cb117-23"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-23"></a>data_fig &lt;-<span class="st"> </span><span class="kw">left_join</span>(</span>
<span id="cb117-24"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-24"></a>  data_fig,</span>
<span id="cb117-25"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-25"></a>  pred_names</span>
<span id="cb117-26"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-26"></a>)</span>
<span id="cb117-27"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-27"></a></span>
<span id="cb117-28"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-28"></a>data_fig &lt;-<span class="st"> </span><span class="kw">mutate</span>(</span>
<span id="cb117-29"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-29"></a>  data_fig,</span>
<span id="cb117-30"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-30"></a>  <span class="dt">plots =</span> <span class="kw">map</span>(</span>
<span id="cb117-31"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-31"></a>    data, <span class="cf">function</span>(df) {</span>
<span id="cb117-32"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-32"></a>      <span class="kw">ggplot</span>(df) <span class="op">+</span></span>
<span id="cb117-33"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-33"></a><span class="st">        </span><span class="kw">geom_ribbon</span>(</span>
<span id="cb117-34"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-34"></a>          <span class="kw">aes</span>(</span>
<span id="cb117-35"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-35"></a>            pred_val,</span>
<span id="cb117-36"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-36"></a>            <span class="dt">ymin =</span> p_occu_low,</span>
<span id="cb117-37"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-37"></a>            <span class="dt">ymax =</span> p_occu_high</span>
<span id="cb117-38"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-38"></a>          ),</span>
<span id="cb117-39"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-39"></a>          <span class="dt">fill =</span> <span class="st">&quot;grey&quot;</span>,</span>
<span id="cb117-40"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-40"></a>          <span class="dt">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb117-41"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-41"></a>        ) <span class="op">+</span></span>
<span id="cb117-42"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-42"></a><span class="st">        </span><span class="kw">geom_line</span>(</span>
<span id="cb117-43"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-43"></a>          <span class="kw">aes</span>(</span>
<span id="cb117-44"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-44"></a>            pred_val, p_occu</span>
<span id="cb117-45"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-45"></a>          )</span>
<span id="cb117-46"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-46"></a>        ) <span class="op">+</span></span>
<span id="cb117-47"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-47"></a><span class="st">        </span><span class="kw">coord_cartesian</span>(</span>
<span id="cb117-48"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-48"></a>          <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb117-49"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-49"></a>        ) <span class="op">+</span></span>
<span id="cb117-50"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-50"></a><span class="st">        </span><span class="kw">theme_test</span>(</span>
<span id="cb117-51"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-51"></a>          <span class="dt">base_family =</span> <span class="st">&quot;Arial&quot;</span></span>
<span id="cb117-52"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-52"></a>        ) <span class="op">+</span></span>
<span id="cb117-53"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-53"></a><span class="st">        </span><span class="kw">labs</span>(</span>
<span id="cb117-54"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-54"></a>          <span class="dt">x =</span> <span class="st">&quot;Predictor&quot;</span>,</span>
<span id="cb117-55"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-55"></a>          <span class="dt">y =</span> <span class="st">&quot;p(Occupancy)&quot;</span></span>
<span id="cb117-56"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-56"></a>        )</span>
<span id="cb117-57"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-57"></a>    }</span>
<span id="cb117-58"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-58"></a>  )</span>
<span id="cb117-59"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-59"></a>)</span>
<span id="cb117-60"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-60"></a></span>
<span id="cb117-61"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-61"></a><span class="co"># add names</span></span>
<span id="cb117-62"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-62"></a>data_fig &lt;-<span class="st"> </span><span class="kw">mutate</span>(</span>
<span id="cb117-63"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-63"></a>  data_fig,</span>
<span id="cb117-64"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-64"></a>  <span class="dt">plots =</span> <span class="kw">map2</span>(</span>
<span id="cb117-65"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-65"></a>    plots, name,</span>
<span id="cb117-66"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-66"></a>    <span class="cf">function</span>(p, name) {</span>
<span id="cb117-67"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-67"></a>      p &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(</span>
<span id="cb117-68"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-68"></a>        <span class="dt">x =</span> name</span>
<span id="cb117-69"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-69"></a>      )</span>
<span id="cb117-70"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-70"></a>    }</span>
<span id="cb117-71"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-71"></a>  )</span>
<span id="cb117-72"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-72"></a>)</span>
<span id="cb117-73"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-73"></a></span>
<span id="cb117-74"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-74"></a><span class="co"># summarise as patchwork</span></span>
<span id="cb117-75"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-75"></a>data_fig &lt;-<span class="st"> </span><span class="kw">group_by</span>(</span>
<span id="cb117-76"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-76"></a>  data_fig,</span>
<span id="cb117-77"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-77"></a>  scientific_name</span>
<span id="cb117-78"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-78"></a>) <span class="op">%&gt;%</span></span>
<span id="cb117-79"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-79"></a><span class="st">  </span><span class="kw">summarise</span>(</span>
<span id="cb117-80"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-80"></a>    <span class="dt">plots =</span> <span class="kw">list</span>(</span>
<span id="cb117-81"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-81"></a>      <span class="kw">wrap_plots</span>(</span>
<span id="cb117-82"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-82"></a>        plots,</span>
<span id="cb117-83"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-83"></a>        <span class="dt">ncol =</span> <span class="dv">5</span></span>
<span id="cb117-84"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-84"></a>      )</span>
<span id="cb117-85"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-85"></a>    )</span>
<span id="cb117-86"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-86"></a>  )</span>
<span id="cb117-87"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-87"></a></span>
<span id="cb117-88"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-88"></a><span class="co"># add title as sp</span></span>
<span id="cb117-89"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-89"></a>data_fig &lt;-<span class="st"> </span><span class="kw">mutate</span>(</span>
<span id="cb117-90"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-90"></a>  data_fig,</span>
<span id="cb117-91"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-91"></a>  <span class="dt">plots =</span> <span class="kw">map2</span>(</span>
<span id="cb117-92"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-92"></a>    plots, scientific_name,</span>
<span id="cb117-93"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-93"></a>    <span class="cf">function</span>(p, name) {</span>
<span id="cb117-94"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-94"></a>      p &lt;-<span class="st"> </span>p <span class="op">&amp;</span><span class="st"> </span><span class="kw">plot_annotation</span>(</span>
<span id="cb117-95"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-95"></a>        <span class="dt">title =</span> name</span>
<span id="cb117-96"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-96"></a>      )</span>
<span id="cb117-97"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-97"></a>    }</span>
<span id="cb117-98"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-98"></a>  )</span>
<span id="cb117-99"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb117-99"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb118-1"></a><span class="co"># save images</span></span>
<span id="cb118-2"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb118-2"></a><span class="kw">cairo_pdf</span>(</span>
<span id="cb118-3"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb118-3"></a>  <span class="dt">filename =</span> <span class="st">&quot;figs/fig_occupancy_predictors.pdf&quot;</span>,</span>
<span id="cb118-4"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb118-4"></a>  <span class="dt">onefile =</span> <span class="ot">TRUE</span>, <span class="dt">width =</span> <span class="dv">10</span>, <span class="dt">height =</span> <span class="dv">2</span></span>
<span id="cb118-5"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb118-5"></a>)</span>
<span id="cb118-6"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb118-6"></a>data_fig<span class="op">$</span>plots</span>
<span id="cb118-7"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb118-7"></a><span class="kw">dev.off</span>()</span></code></pre></div>
</div>
</div>
<div id="mapping-species-occupancy" class="section level2">
<h2><span class="header-section-number">11.7</span> Mapping species occupancy</h2>
<div id="read-in-raster-layers" class="section level3">
<h3><span class="header-section-number">11.7.1</span> Read in raster layers</h3>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb119-1"></a><span class="kw">library</span>(terra)</span>
<span id="cb119-2"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb119-2"></a><span class="kw">library</span>(sf)</span></code></pre></div>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb120-1"></a><span class="co"># read saved rasters</span></span>
<span id="cb120-2"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb120-2"></a>lscape =<span class="st"> </span><span class="kw">rast</span>(<span class="st">&quot;data/spatial/landscape_resamp01_km.tif&quot;</span>)</span>
<span id="cb120-3"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb120-3"></a></span>
<span id="cb120-4"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb120-4"></a><span class="co"># isolate temperature and rainfall</span></span>
<span id="cb120-5"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb120-5"></a>bio4 =<span class="st"> </span>lscape[[<span class="dv">4</span>]] </span>
<span id="cb120-6"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb120-6"></a>bio15 =<span class="st"> </span>lscape[[<span class="dv">5</span>]] <span class="co"># rain</span></span>
<span id="cb120-7"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb120-7"></a></span>
<span id="cb120-8"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb120-8"></a><span class="co"># careful while loading this raster, large size</span></span>
<span id="cb120-9"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb120-9"></a>landcover &lt;-<span class="st"> </span><span class="kw">rast</span>(<span class="st">&quot;data/landUseClassification/landcover_roy_2015_reclassified.tif&quot;</span>)</span>
<span id="cb120-10"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb120-10"></a></span>
<span id="cb120-11"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb120-11"></a>lc_1km &lt;-<span class="st"> </span><span class="kw">rast</span>(<span class="st">&quot;data/landUseClassification/lc_01000m.tif&quot;</span>)</span></code></pre></div>
</div>
<div id="split-landcover-into-proportions-per-1km" class="section level3">
<h3><span class="header-section-number">11.7.2</span> Split landcover into proportions per 1km</h3>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb121-1"></a><span class="co"># separate the fine-scale landcover raster into presence-absence of each class</span></span>
<span id="cb121-2"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb121-2"></a>lc_split &lt;-<span class="st"> </span><span class="kw">segregate</span>(landcover)</span>
<span id="cb121-3"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb121-3"></a></span>
<span id="cb121-4"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb121-4"></a><span class="co"># resample to 1km</span></span>
<span id="cb121-5"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb121-5"></a><span class="co"># bilinear resampling uses the mean function.</span></span>
<span id="cb121-6"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb121-6"></a><span class="co"># mean of N 0s and 1s is the proportion of 1s, ie, proportion of each landcover</span></span>
<span id="cb121-7"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb121-7"></a>lc_split &lt;-<span class="st"> </span>terra<span class="op">::</span><span class="kw">resample</span>(</span>
<span id="cb121-8"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb121-8"></a>  lc_split,</span>
<span id="cb121-9"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb121-9"></a>  lc_1km,</span>
<span id="cb121-10"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb121-10"></a>  <span class="dt">method =</span> <span class="st">&quot;bilinear&quot;</span></span>
<span id="cb121-11"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb121-11"></a>)</span>
<span id="cb121-12"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb121-12"></a></span>
<span id="cb121-13"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb121-13"></a><span class="co"># rename rasters</span></span>
<span id="cb121-14"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb121-14"></a><span class="kw">names</span>(lc_split) &lt;-<span class="st"> </span>pred_names<span class="op">$</span>name[<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)]</span>
<span id="cb121-15"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb121-15"></a></span>
<span id="cb121-16"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb121-16"></a><span class="co"># save raster of landcover proportion</span></span>
<span id="cb121-17"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb121-17"></a>terra<span class="op">::</span><span class="kw">writeRaster</span>(</span>
<span id="cb121-18"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb121-18"></a>  lc_split,</span>
<span id="cb121-19"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb121-19"></a>  <span class="dt">filename =</span> <span class="st">&quot;data/spatial/raster_landcover_proportion_1km.tif&quot;</span>,</span>
<span id="cb121-20"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb121-20"></a>  <span class="dt">overwrite=</span><span class="ot">TRUE</span></span>
<span id="cb121-21"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb121-21"></a>)</span>
<span id="cb121-22"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb121-22"></a></span>
<span id="cb121-23"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb121-23"></a><span class="kw">rm</span>(landcover)</span>
<span id="cb121-24"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb121-24"></a><span class="kw">gc</span>()</span></code></pre></div>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb122-1"></a><span class="co"># plot proportion of landcover classes</span></span>
<span id="cb122-2"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb122-2"></a><span class="kw">png</span>(<span class="dt">width =</span> <span class="dv">1200</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span>, <span class="dt">height =</span> <span class="dv">1200</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span>, <span class="dt">filename =</span> <span class="st">&quot;figs/fig_landcover_proportion_1km.png&quot;</span>, <span class="dt">res =</span> <span class="dv">300</span>)</span>
<span id="cb122-3"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb122-3"></a><span class="kw">plot</span>(</span>
<span id="cb122-4"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb122-4"></a>  lc_split,</span>
<span id="cb122-5"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb122-5"></a>  <span class="dt">col =</span> colorspace<span class="op">::</span><span class="kw">sequential_hcl</span>(<span class="dv">20</span>, <span class="dt">palette =</span> <span class="st">&quot;Viridis&quot;</span>),</span>
<span id="cb122-6"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb122-6"></a>  <span class="dt">range =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb122-7"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb122-7"></a>)</span>
<span id="cb122-8"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb122-8"></a><span class="kw">dev.off</span>()</span></code></pre></div>
</div>
<div id="prepare-climatic-layers" class="section level3">
<h3><span class="header-section-number">11.7.3</span> Prepare climatic layers</h3>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb123-1"></a><span class="co"># load landcover split</span></span>
<span id="cb123-2"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb123-2"></a>lc_split =<span class="st"> </span>terra<span class="op">::</span><span class="kw">rast</span>(<span class="st">&quot;data/spatial/raster_landcover_proportion_1km.tif&quot;</span>)</span></code></pre></div>
</div>
<div id="mask-by-study-area" class="section level3">
<h3><span class="header-section-number">11.7.4</span> Mask by study area</h3>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb124-1"></a><span class="co"># mask by hills</span></span>
<span id="cb124-2"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb124-2"></a><span class="co"># run only if required (makes more sense to map to a larger area)</span></span>
<span id="cb124-3"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb124-3"></a>hills =<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&quot;data/spatial/hillsShapefile/Nil_Ana_Pal.shp&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb124-4"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb124-4"></a><span class="st">  </span><span class="kw">st_transform</span>(<span class="dv">32643</span>)</span>
<span id="cb124-5"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb124-5"></a></span>
<span id="cb124-6"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb124-6"></a><span class="co">#bio_1 = terra::mask(</span></span>
<span id="cb124-7"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb124-7"></a><span class="co">#  bio_1,</span></span>
<span id="cb124-8"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb124-8"></a><span class="co">#  vect(hills)</span></span>
<span id="cb124-9"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb124-9"></a><span class="co">#)</span></span>
<span id="cb124-10"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb124-10"></a></span>
<span id="cb124-11"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb124-11"></a><span class="co">#bio_12 = terra::mask(</span></span>
<span id="cb124-12"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb124-12"></a><span class="co">#  bio_12,</span></span>
<span id="cb124-13"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb124-13"></a><span class="co">#  vect(hills)</span></span>
<span id="cb124-14"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb124-14"></a><span class="co">#)</span></span></code></pre></div>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb125-1"></a><span class="co"># get ranges</span></span>
<span id="cb125-2"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb125-2"></a>range4 &lt;-<span class="st"> </span>terra<span class="op">::</span><span class="kw">minmax</span>(bio4)[, <span class="dv">1</span>] </span>
<span id="cb125-3"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb125-3"></a>range15 &lt;-<span class="st"> </span>terra<span class="op">::</span><span class="kw">minmax</span>(bio15)[, <span class="dv">1</span>]</span>
<span id="cb125-4"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb125-4"></a></span>
<span id="cb125-5"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb125-5"></a><span class="co"># rescale</span></span>
<span id="cb125-6"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb125-6"></a>bio4 &lt;-<span class="st"> </span>(bio4 <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(range4)) <span class="op">/</span><span class="st"> </span>(<span class="kw">diff</span>(range4))</span>
<span id="cb125-7"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb125-7"></a>bio15 &lt;-<span class="st"> </span>(bio15 <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(range15)) <span class="op">/</span><span class="st"> </span>(<span class="kw">diff</span>(range15))</span>
<span id="cb125-8"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb125-8"></a></span>
<span id="cb125-9"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb125-9"></a><span class="co"># project to UTM</span></span>
<span id="cb125-10"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb125-10"></a>climate &lt;-<span class="st"> </span><span class="kw">c</span>(bio4, bio15)</span>
<span id="cb125-11"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb125-11"></a><span class="kw">names</span>(climate) =<span class="st"> </span><span class="kw">c</span>(</span>
<span id="cb125-12"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb125-12"></a>  <span class="st">&quot;Temp. seasonality&quot;</span>, </span>
<span id="cb125-13"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb125-13"></a>  <span class="st">&quot;Precip. seasonality&quot;</span></span>
<span id="cb125-14"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb125-14"></a>)</span>
<span id="cb125-15"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb125-15"></a></span>
<span id="cb125-16"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb125-16"></a>climate &lt;-<span class="st"> </span>terra<span class="op">::</span><span class="kw">project</span>(</span>
<span id="cb125-17"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb125-17"></a>  <span class="dt">x =</span> climate, <span class="dt">y =</span> lc_1km</span>
<span id="cb125-18"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb125-18"></a>)</span>
<span id="cb125-19"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb125-19"></a></span>
<span id="cb125-20"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb125-20"></a><span class="co"># make squared terms</span></span>
<span id="cb125-21"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb125-21"></a>climate2 &lt;-<span class="st"> </span>climate <span class="op">*</span><span class="st"> </span>climate</span>
<span id="cb125-22"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb125-22"></a></span>
<span id="cb125-23"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb125-23"></a><span class="co"># names</span></span>
<span id="cb125-24"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb125-24"></a><span class="kw">names</span>(climate2) =<span class="st"> </span><span class="kw">glue</span>(<span class="st">&quot;{names(climate)} 2&quot;</span>)</span>
<span id="cb125-25"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb125-25"></a></span>
<span id="cb125-26"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb125-26"></a><span class="co"># add to landcover proportions and plot</span></span>
<span id="cb125-27"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb125-27"></a>landscape &lt;-<span class="st"> </span><span class="kw">c</span>(climate, lc_split)</span></code></pre></div>
</div>
<div id="plot-full-bounds-of-landscape-variables" class="section level3">
<h3><span class="header-section-number">11.7.5</span> Plot full bounds of landscape variables</h3>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb126-1"></a><span class="co"># plot proportion of landcover classes</span></span>
<span id="cb126-2"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb126-2"></a><span class="kw">png</span>(</span>
<span id="cb126-3"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb126-3"></a>  <span class="dt">width =</span> <span class="dv">1200</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span>, <span class="dt">height =</span> <span class="dv">1200</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span>, <span class="dt">filename =</span> <span class="st">&quot;figs/fig_landscape_1km.png&quot;</span>,</span>
<span id="cb126-4"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb126-4"></a>  <span class="dt">res =</span> <span class="dv">300</span></span>
<span id="cb126-5"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb126-5"></a>)</span>
<span id="cb126-6"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb126-6"></a><span class="kw">plot</span>(</span>
<span id="cb126-7"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb126-7"></a>  landscape,</span>
<span id="cb126-8"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb126-8"></a>  <span class="dt">col =</span> colorspace<span class="op">::</span><span class="kw">sequential_hcl</span>(<span class="dv">20</span>, <span class="dt">palette =</span> <span class="st">&quot;agSunset&quot;</span>, <span class="dt">rev =</span> T),</span>
<span id="cb126-9"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb126-9"></a>  <span class="dt">range =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb126-10"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb126-10"></a>)</span>
<span id="cb126-11"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb126-11"></a><span class="kw">dev.off</span>()</span></code></pre></div>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb127-1"></a><span class="co"># add squared terms</span></span>
<span id="cb127-2"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb127-2"></a>landscape &lt;-<span class="st"> </span><span class="kw">c</span>(</span>
<span id="cb127-3"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb127-3"></a>  climate, climate2, lc_split</span>
<span id="cb127-4"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb127-4"></a>)</span>
<span id="cb127-5"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb127-5"></a></span>
<span id="cb127-6"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb127-6"></a><span class="co">#landscape = terra::mask(</span></span>
<span id="cb127-7"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb127-7"></a><span class="co">#  landscape,</span></span>
<span id="cb127-8"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb127-8"></a><span class="co">#  vect(hills)</span></span>
<span id="cb127-9"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb127-9"></a><span class="co">#)</span></span></code></pre></div>
</div>
<div id="prepare-soi-predictors" class="section level3">
<h3><span class="header-section-number">11.7.6</span> Prepare soi predictors</h3>
<p>Prepare the soi predictor coefficients as a vector of the same length as the number of raster layers.
These will be multiplied with each layer to give the effect of each layer.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-1"></a><span class="co"># get soi coefs</span></span>
<span id="cb128-2"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-2"></a>sp_coefs &lt;-<span class="st"> </span><span class="kw">filter</span>(</span>
<span id="cb128-3"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-3"></a>  data</span>
<span id="cb128-4"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-4"></a>) <span class="op">%&gt;%</span></span>
<span id="cb128-5"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-5"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(</span>
<span id="cb128-6"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-6"></a>    <span class="op">-</span>pred_val, <span class="op">-</span>pred_val_pow</span>
<span id="cb128-7"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-7"></a>  )</span>
<span id="cb128-8"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-8"></a></span>
<span id="cb128-9"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-9"></a><span class="co"># add missing landcover classes</span></span>
<span id="cb128-10"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-10"></a>sp_preds &lt;-<span class="st"> </span><span class="kw">crossing</span>(</span>
<span id="cb128-11"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-11"></a>  <span class="dt">scientific_name =</span> soi,</span>
<span id="cb128-12"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-12"></a>  <span class="dt">predictor =</span> pred_names<span class="op">$</span>predictor,</span>
<span id="cb128-13"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-13"></a>  <span class="dt">power =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb128-14"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-14"></a>)</span>
<span id="cb128-15"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-15"></a></span>
<span id="cb128-16"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-16"></a><span class="co"># remove squared terms for landcover</span></span>
<span id="cb128-17"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-17"></a>sp_preds &lt;-<span class="st"> </span><span class="kw">filter</span>(</span>
<span id="cb128-18"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-18"></a>  sp_preds,</span>
<span id="cb128-19"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-19"></a>  <span class="op">!</span>(<span class="kw">str_detect</span>(predictor, <span class="st">&quot;lc&quot;</span>) <span class="op">&amp;</span><span class="st"> </span>power <span class="op">==</span><span class="st"> </span><span class="dv">2</span>)</span>
<span id="cb128-20"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-20"></a>)</span>
<span id="cb128-21"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-21"></a></span>
<span id="cb128-22"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-22"></a><span class="co"># correct square LC terms</span></span>
<span id="cb128-23"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-23"></a>sp_coefs =<span class="st"> </span><span class="kw">mutate</span>(</span>
<span id="cb128-24"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-24"></a>  sp_coefs,</span>
<span id="cb128-25"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-25"></a>  <span class="dt">power =</span> <span class="kw">if_else</span>(</span>
<span id="cb128-26"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-26"></a>    <span class="kw">str_detect</span>(predictor, <span class="st">&quot;lc&quot;</span>),</span>
<span id="cb128-27"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-27"></a>    <span class="dv">1</span>,</span>
<span id="cb128-28"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-28"></a>    power</span>
<span id="cb128-29"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-29"></a>  )</span>
<span id="cb128-30"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-30"></a>)</span>
<span id="cb128-31"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-31"></a></span>
<span id="cb128-32"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-32"></a>sp_coefs &lt;-<span class="st"> </span><span class="kw">full_join</span>(</span>
<span id="cb128-33"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-33"></a>  sp_coefs,</span>
<span id="cb128-34"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-34"></a>  sp_preds</span>
<span id="cb128-35"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-35"></a>)</span>
<span id="cb128-36"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-36"></a></span>
<span id="cb128-37"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-37"></a><span class="co"># make wide --- this should give no warnings</span></span>
<span id="cb128-38"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-38"></a>sp_coefs &lt;-</span>
<span id="cb128-39"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-39"></a><span class="st">  </span><span class="kw">pivot_wider</span>(</span>
<span id="cb128-40"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-40"></a>    sp_coefs,</span>
<span id="cb128-41"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-41"></a>    <span class="dt">id_cols =</span> <span class="kw">c</span>(<span class="st">&quot;scientific_name&quot;</span>),</span>
<span id="cb128-42"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-42"></a>    <span class="dt">names_from =</span> <span class="kw">c</span>(<span class="st">&quot;predictor&quot;</span>, <span class="st">&quot;power&quot;</span>),</span>
<span id="cb128-43"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-43"></a>    <span class="dt">values_from =</span> <span class="st">&quot;coefficient&quot;</span></span>
<span id="cb128-44"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-44"></a>  )</span>
<span id="cb128-45"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-45"></a></span>
<span id="cb128-46"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-46"></a><span class="co"># get into order</span></span>
<span id="cb128-47"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-47"></a>sp_coefs &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(</span>
<span id="cb128-48"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-48"></a>  sp_coefs,</span>
<span id="cb128-49"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-49"></a>  scientific_name,</span>
<span id="cb128-50"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-50"></a>  <span class="kw">c</span>(</span>
<span id="cb128-51"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-51"></a>    <span class="st">&quot;bio4_1&quot;</span>, <span class="st">&quot;bio15_1&quot;</span>,</span>
<span id="cb128-52"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-52"></a>    <span class="st">&quot;bio4_2&quot;</span>, <span class="st">&quot;bio15_2&quot;</span></span>
<span id="cb128-53"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-53"></a>  ),</span>
<span id="cb128-54"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-54"></a>  <span class="kw">matches</span>(<span class="st">&quot;lc&quot;</span>)</span>
<span id="cb128-55"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-55"></a>)</span>
<span id="cb128-56"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-56"></a></span>
<span id="cb128-57"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-57"></a><span class="co"># get vectors of coefficients</span></span>
<span id="cb128-58"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-58"></a>sp_coefs &lt;-<span class="st"> </span><span class="kw">nest</span>(</span>
<span id="cb128-59"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-59"></a>  sp_coefs,</span>
<span id="cb128-60"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-60"></a>  <span class="op">-</span>scientific_name</span>
<span id="cb128-61"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb128-61"></a>)</span></code></pre></div>
</div>
<div id="prepare-species-occupancy-for-soi" class="section level3">
<h3><span class="header-section-number">11.7.7</span> Prepare species occupancy for SOI</h3>
<p>Here, we shall simply multiply each landscape layer with the corresponding predictor coefficient. Where these are not available, we shall simply multiply the corresponding layer with NA. The resulting layers will be summed together to get a single response layer, which will then be inverse logit transformed to get the probability of occupancy.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb129-1"></a><span class="co"># multiply coefficients with layers</span></span>
<span id="cb129-2"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb129-2"></a>soi_occu &lt;-<span class="st"> </span><span class="kw">map</span>(</span>
<span id="cb129-3"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb129-3"></a>  sp_coefs[sp_coefs<span class="op">$</span>scientific_name <span class="op">%in%</span><span class="st"> </span>soi, ]<span class="op">$</span>data,</span>
<span id="cb129-4"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb129-4"></a>  <span class="dt">.f =</span> <span class="cf">function</span>(df) {</span>
<span id="cb129-5"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb129-5"></a>    response &lt;-<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">slice</span>(df, <span class="dv">1</span>), <span class="dt">use.names =</span> F) <span class="op">*</span><span class="st"> </span>landscape</span>
<span id="cb129-6"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb129-6"></a>    response &lt;-<span class="st"> </span><span class="kw">sum</span>(response, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="co"># remove NA layers, i.e., non-sig preds</span></span>
<span id="cb129-7"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb129-7"></a></span>
<span id="cb129-8"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb129-8"></a>    <span class="co"># now transform for probability occupancy</span></span>
<span id="cb129-9"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb129-9"></a>    response &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>response))</span>
<span id="cb129-10"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb129-10"></a>  }</span>
<span id="cb129-11"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb129-11"></a>)</span>
<span id="cb129-12"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb129-12"></a></span>
<span id="cb129-13"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb129-13"></a><span class="co"># assign names</span></span>
<span id="cb129-14"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb129-14"></a><span class="kw">names</span>(soi_occu) &lt;-<span class="st"> </span>soi</span>
<span id="cb129-15"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb129-15"></a></span>
<span id="cb129-16"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb129-16"></a><span class="co"># make single stack</span></span>
<span id="cb129-17"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb129-17"></a>soi_occu &lt;-<span class="st"> </span><span class="kw">reduce</span>(soi_occu, c)</span>
<span id="cb129-18"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb129-18"></a><span class="kw">names</span>(soi_occu) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Irena puella&quot;</span>,<span class="st">&quot;Leptocoma minima&quot;</span>,<span class="st">&quot;Merops leschenaulti&quot;</span>,<span class="st">&quot;Myophonus horsfieldii&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb130-1"></a><span class="co"># use stars for plotting with ggplot</span></span>
<span id="cb130-2"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb130-2"></a><span class="kw">library</span>(stars)</span>
<span id="cb130-3"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb130-3"></a><span class="kw">library</span>(colorspace)</span>
<span id="cb130-4"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb130-4"></a></span>
<span id="cb130-5"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb130-5"></a>soi_occu &lt;-<span class="st"> </span><span class="kw">st_as_stars</span>(soi_occu)</span>
<span id="cb130-6"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb130-6"></a></span>
<span id="cb130-7"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb130-7"></a>fig_occu_map &lt;-<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb130-8"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb130-8"></a><span class="st">  </span><span class="kw">geom_stars</span>(</span>
<span id="cb130-9"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb130-9"></a>    <span class="dt">data =</span> soi_occu</span>
<span id="cb130-10"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb130-10"></a>  ) <span class="op">+</span></span>
<span id="cb130-11"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb130-11"></a><span class="st">  </span><span class="kw">scale_fill_binned_sequential</span>(</span>
<span id="cb130-12"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb130-12"></a>    <span class="dt">palette =</span> <span class="st">&quot;Purple-Yellow&quot;</span>,</span>
<span id="cb130-13"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb130-13"></a>    <span class="dt">name =</span> <span class="st">&quot;Probability of Occupancy&quot;</span>,</span>
<span id="cb130-14"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb130-14"></a>    <span class="dt">rev =</span> T,</span>
<span id="cb130-15"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb130-15"></a>    <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb130-16"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb130-16"></a>    <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>), </span>
<span id="cb130-17"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb130-17"></a>    <span class="dt">na.value =</span> <span class="st">&quot;grey99&quot;</span>,</span>
<span id="cb130-18"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb130-18"></a>    <span class="dt">show.limits =</span> T</span>
<span id="cb130-19"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb130-19"></a>  ) <span class="op">+</span></span>
<span id="cb130-20"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb130-20"></a><span class="st">  </span><span class="kw">facet_wrap</span>(</span>
<span id="cb130-21"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb130-21"></a>    <span class="op">~</span>band,</span>
<span id="cb130-22"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb130-22"></a>    <span class="dt">labeller =</span> <span class="kw">labeller</span>(</span>
<span id="cb130-23"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb130-23"></a>      <span class="dt">band =</span> <span class="cf">function</span>(x) <span class="kw">str_replace</span>(x, <span class="st">&quot;</span><span class="ch">\\</span><span class="st">.&quot;</span>, <span class="st">&quot; &quot;</span>)</span>
<span id="cb130-24"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb130-24"></a>    )</span>
<span id="cb130-25"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb130-25"></a>  ) <span class="op">+</span></span>
<span id="cb130-26"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb130-26"></a><span class="st">  </span><span class="kw">coord_sf</span>(</span>
<span id="cb130-27"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb130-27"></a>    <span class="dt">crs =</span> <span class="dv">32643</span>,</span>
<span id="cb130-28"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb130-28"></a>    <span class="dt">expand =</span> <span class="ot">FALSE</span></span>
<span id="cb130-29"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb130-29"></a>  ) <span class="op">+</span></span>
<span id="cb130-30"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb130-30"></a><span class="st">  </span><span class="kw">theme_test</span>() <span class="op">+</span></span>
<span id="cb130-31"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb130-31"></a><span class="st">  </span><span class="kw">theme</span>(</span>
<span id="cb130-32"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb130-32"></a>    <span class="co"># legend.position = &quot;rg&quot;,</span></span>
<span id="cb130-33"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb130-33"></a>    <span class="dt">axis.title =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb130-34"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb130-34"></a>    <span class="dt">axis.text =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb130-35"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb130-35"></a>    <span class="dt">legend.key.height =</span> <span class="kw">unit</span>(<span class="dv">10</span>, <span class="st">&quot;mm&quot;</span>),</span>
<span id="cb130-36"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb130-36"></a>    <span class="dt">legend.key.width =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;mm&quot;</span>),</span>
<span id="cb130-37"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb130-37"></a>    <span class="dt">strip.text =</span> <span class="kw">element_text</span>(</span>
<span id="cb130-38"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb130-38"></a>      <span class="dt">face =</span> <span class="st">&quot;italic&quot;</span></span>
<span id="cb130-39"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb130-39"></a>    ),</span>
<span id="cb130-40"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb130-40"></a>    <span class="dt">legend.title =</span> <span class="kw">element_text</span>(</span>
<span id="cb130-41"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb130-41"></a>      <span class="dt">vjust =</span> <span class="dv">1</span></span>
<span id="cb130-42"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb130-42"></a>    )</span>
<span id="cb130-43"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb130-43"></a>  )</span>
<span id="cb130-44"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb130-44"></a></span>
<span id="cb130-45"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb130-45"></a><span class="co"># save figure</span></span>
<span id="cb130-46"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb130-46"></a><span class="kw">ggsave</span>(</span>
<span id="cb130-47"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb130-47"></a>  fig_occu_map,</span>
<span id="cb130-48"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb130-48"></a>  <span class="dt">filename =</span> <span class="st">&quot;figs/fig_06.png&quot;</span>,</span>
<span id="cb130-49"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb130-49"></a>  <span class="dt">width =</span> <span class="dv">6</span>, <span class="dt">height =</span> <span class="dv">6</span></span>
<span id="cb130-50"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb130-50"></a>)</span></code></pre></div>
<div class="figure">
<img src="figs/fig_06.png" alt="" />
<p class="caption"><strong>Predicted area of occurrence</strong>
Predicted area of occurrence for four forest species are shown here. The probability of occupancy of the asian fairy-bluebird <em>Irena puella</em>, the crimson-backed sunbird <em>Leptocoma minima</em> and the chestnut-headed bee-eater <em>Merops leschenaulti</em> is higher across the western slopes and at mid-elevations across our study area. The Malabar whistling-thrush <em>Myophonus horsfieldii</em> has a higher probability of occupancy across mid-elevations throughout the study area examined.</p>
</div>
</div>
<div id="prepare-species-occupancy-for-all-species" class="section level3">
<h3><span class="header-section-number">11.7.8</span> Prepare species occupancy for all species</h3>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb131-1"></a><span class="co"># multiply coefficients with layers</span></span>
<span id="cb131-2"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb131-2"></a>sp_occu &lt;-<span class="st"> </span><span class="kw">map</span>(</span>
<span id="cb131-3"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb131-3"></a>  sp_coefs<span class="op">$</span>data,</span>
<span id="cb131-4"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb131-4"></a>  <span class="dt">.f =</span> <span class="cf">function</span>(df) {</span>
<span id="cb131-5"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb131-5"></a>    response &lt;-<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">slice</span>(df, <span class="dv">1</span>), <span class="dt">use.names =</span> F) <span class="op">*</span><span class="st"> </span>landscape</span>
<span id="cb131-6"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb131-6"></a>    response &lt;-<span class="st"> </span><span class="kw">sum</span>(response, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="co"># remove NA layers, i.e., non-sig preds</span></span>
<span id="cb131-7"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb131-7"></a></span>
<span id="cb131-8"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb131-8"></a>    <span class="co"># now transform for probability occupancy</span></span>
<span id="cb131-9"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb131-9"></a>    response &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>response))</span>
<span id="cb131-10"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb131-10"></a>  }</span>
<span id="cb131-11"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb131-11"></a>)</span>
<span id="cb131-12"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb131-12"></a></span>
<span id="cb131-13"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb131-13"></a><span class="co"># make single stack</span></span>
<span id="cb131-14"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb131-14"></a>sp_occu &lt;-<span class="st"> </span><span class="kw">reduce</span>(sp_occu, c)</span>
<span id="cb131-15"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb131-15"></a><span class="co"># assign names</span></span>
<span id="cb131-16"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb131-16"></a><span class="kw">names</span>(sp_occu) &lt;-<span class="st"> </span>sp_coefs<span class="op">$</span>scientific_name</span></code></pre></div>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-1"></a><span class="co"># use stars for plotting with ggplot</span></span>
<span id="cb132-2"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-2"></a><span class="kw">library</span>(stars)</span>
<span id="cb132-3"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-3"></a><span class="kw">library</span>(colorspace)</span>
<span id="cb132-4"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-4"></a></span>
<span id="cb132-5"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-5"></a>sp_occu &lt;-<span class="st"> </span><span class="kw">st_as_stars</span>(sp_occu)</span>
<span id="cb132-6"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-6"></a></span>
<span id="cb132-7"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-7"></a>fig_occu_map_all &lt;-</span>
<span id="cb132-8"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-8"></a><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb132-9"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-9"></a><span class="st">  </span><span class="kw">geom_stars</span>(</span>
<span id="cb132-10"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-10"></a>    <span class="dt">data =</span> sp_occu</span>
<span id="cb132-11"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-11"></a>  ) <span class="op">+</span></span>
<span id="cb132-12"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-12"></a><span class="st">  </span><span class="kw">scale_fill_binned_sequential</span>(</span>
<span id="cb132-13"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-13"></a>    <span class="dt">palette =</span> <span class="st">&quot;Purple-Yellow&quot;</span>,</span>
<span id="cb132-14"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-14"></a>    <span class="dt">name =</span> <span class="st">&quot;p(Occu.)&quot;</span>,</span>
<span id="cb132-15"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-15"></a>    <span class="dt">rev =</span> T,</span>
<span id="cb132-16"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-16"></a>    <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb132-17"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-17"></a>    <span class="dt">na.value =</span> <span class="st">&quot;grey99&quot;</span>,</span>
<span id="cb132-18"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-18"></a>    <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>), <span class="dt">show.limits =</span> T</span>
<span id="cb132-19"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-19"></a>  ) <span class="op">+</span></span>
<span id="cb132-20"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-20"></a><span class="st">  </span><span class="kw">facet_wrap</span>(</span>
<span id="cb132-21"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-21"></a>    <span class="op">~</span>band,</span>
<span id="cb132-22"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-22"></a>    <span class="dt">labeller =</span> <span class="kw">labeller</span>(</span>
<span id="cb132-23"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-23"></a>      <span class="dt">band =</span> <span class="cf">function</span>(x) <span class="kw">str_replace</span>(x, <span class="st">&quot;</span><span class="ch">\\</span><span class="st">.&quot;</span>, <span class="st">&quot; &quot;</span>)</span>
<span id="cb132-24"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-24"></a>    )</span>
<span id="cb132-25"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-25"></a>  ) <span class="op">+</span></span>
<span id="cb132-26"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-26"></a><span class="st">  </span><span class="kw">coord_sf</span>(</span>
<span id="cb132-27"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-27"></a>    <span class="dt">crs =</span> <span class="dv">32643</span>,</span>
<span id="cb132-28"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-28"></a>    <span class="dt">expand =</span> <span class="ot">FALSE</span></span>
<span id="cb132-29"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-29"></a>  ) <span class="op">+</span></span>
<span id="cb132-30"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-30"></a><span class="st">  </span><span class="kw">theme_test</span>(</span>
<span id="cb132-31"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-31"></a>    <span class="dt">base_size =</span> <span class="dv">8</span></span>
<span id="cb132-32"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-32"></a>  ) <span class="op">+</span></span>
<span id="cb132-33"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-33"></a><span class="st">  </span><span class="kw">theme</span>(</span>
<span id="cb132-34"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-34"></a>    <span class="co"># legend.position = &quot;rg&quot;,</span></span>
<span id="cb132-35"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-35"></a>    <span class="dt">axis.title =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb132-36"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-36"></a>    <span class="dt">axis.text =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb132-37"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-37"></a>    <span class="dt">legend.key.height =</span> <span class="kw">unit</span>(<span class="dv">10</span>, <span class="st">&quot;mm&quot;</span>),</span>
<span id="cb132-38"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-38"></a>    <span class="dt">legend.key.width =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;mm&quot;</span>),</span>
<span id="cb132-39"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-39"></a>    <span class="dt">strip.text =</span> <span class="kw">element_text</span>(</span>
<span id="cb132-40"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-40"></a>      <span class="dt">face =</span> <span class="st">&quot;italic&quot;</span></span>
<span id="cb132-41"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-41"></a>    ),</span>
<span id="cb132-42"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-42"></a>    <span class="dt">strip.background =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb132-43"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-43"></a>    <span class="dt">legend.title =</span> <span class="kw">element_text</span>(</span>
<span id="cb132-44"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-44"></a>      <span class="dt">vjust =</span> <span class="dv">1</span></span>
<span id="cb132-45"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-45"></a>    )</span>
<span id="cb132-46"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-46"></a>  )</span>
<span id="cb132-47"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-47"></a></span>
<span id="cb132-48"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-48"></a><span class="co"># save figure</span></span>
<span id="cb132-49"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-49"></a><span class="kw">ggsave</span>(</span>
<span id="cb132-50"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-50"></a>  fig_occu_map_all,</span>
<span id="cb132-51"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-51"></a>  <span class="dt">filename =</span> <span class="st">&quot;figs/fig_occupancy_maps.png&quot;</span>,</span>
<span id="cb132-52"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-52"></a>  <span class="dt">width =</span> <span class="dv">16</span>, <span class="dt">height =</span> <span class="dv">16</span></span>
<span id="cb132-53"><a href="predicting-species-specific-occupancy-as-a-function-of-significant-predictors.html#cb132-53"></a>)</span></code></pre></div>


</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="visualizing-occupancy-predictor-effects.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/pratikunterwegs/eBirdOccupancy/edit/master/11_predict-probOfOccupancy.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
